import { Component, ChangeDetectionStrategy, Input, KeyValueDiffers, Output, EventEmitter, } from '@angular/core';
import { FormBuilder, Validators, } from '@angular/forms';
import { TranslateService } from '@ngx-translate/core';
import { PepDialogService, PepDialogData, } from '@pepperi-addons/ngx-lib/dialog';
import { FIELD_TYPE, PepCustomizationService, PepLayoutService, PepTextboxField, PepSelectField, PepInternalMenuField, PepQuantitySelectorField, PepAddressField, PepIndicatorsField, PepInternalPageField, PepInternalButtonField, PepAttachmentField, PepSignatureField, PepImageField, PepImagesField, PepTextareaField, PepRichHtmlTextareaField, PepDateField, PepCheckboxField, PepSeparatorField, PepPlaceholderField, X_ALIGNMENT_TYPE, Y_ALIGNMENT_TYPE, DEFAULT_VERTICAL_ALIGNMENT, DEFAULT_HORIZONTAL_ALIGNMENT, } from '@pepperi-addons/ngx-lib';
export class PepFormComponent {
    // eventServiceSub: Subscription;
    // public jsonLib = JSON;
    constructor(dialogService, customizationService, layoutService, fb, differs, translate) {
        this.dialogService = dialogService;
        this.customizationService = customizationService;
        this.layoutService = layoutService;
        this.fb = fb;
        this.translate = translate;
        this.isReport = false;
        this.lockEvents = false;
        this.canEditObject = true;
        this._data = null;
        this.isActive = false;
        this.layoutType = 'card';
        // @Input() listType = '';
        this.objectId = '0';
        this.parentId = '0';
        this.searchCode = '0';
        this.showTitle = true;
        this.firstFieldAsLink = false;
        this.checkForChanges = null;
        this.valueChange = new EventEmitter();
        this.formValidationChange = new EventEmitter();
        this.childClick = new EventEmitter();
        this.childChange = new EventEmitter();
        this.fieldClick = new EventEmitter();
        this.isLocked = false;
        // payLoad = '';
        this.rows = [];
        this.fields = [];
        this.columns = 1;
        this.hasMenuFloatingOnOtherField = false;
        this.indicatorsDataField = null;
        this._shouldReloadForm = false;
        // store the initial value to compare with
        this.differ = differs.find({}).create();
    }
    set data(value) {
        const shouldReload = this.shouldReloadForm || !this._data;
        this._data = value;
        if (shouldReload) {
            this._shouldReloadForm = false;
            this.initForm();
        }
        else {
            this.updateForm();
        }
    }
    get data() {
        return this._data;
    }
    get shouldReloadForm() {
        return this._shouldReloadForm;
    }
    convertXAlignToHorizontalAlign(xAlign) {
        let res = DEFAULT_HORIZONTAL_ALIGNMENT;
        if (xAlign === X_ALIGNMENT_TYPE.None ||
            xAlign === X_ALIGNMENT_TYPE.Left) {
            res = 'left';
        }
        else if (xAlign === X_ALIGNMENT_TYPE.Right) {
            res = 'right';
        }
        else {
            res = 'center';
        }
        return res;
    }
    convertYAlignToVerticalAlign(yAlign) {
        let res = DEFAULT_VERTICAL_ALIGNMENT;
        if (yAlign === Y_ALIGNMENT_TYPE.None ||
            yAlign === Y_ALIGNMENT_TYPE.Top) {
            res = 'top';
        }
        else if (yAlign === Y_ALIGNMENT_TYPE.Bottom) {
            res = 'bottom';
        }
        else {
            res = 'middle';
        }
        return res;
    }
    convertOptionalValues(optionalValues) {
        if (optionalValues && optionalValues.length > 0) {
            return optionalValues.map((ov) => {
                return { key: ov.Key, value: ov.Value };
            });
        }
        else {
            return [];
        }
    }
    convertAddressFields(controlField, addressFields, canEditObject) {
        const fields = [];
        addressFields.forEach((field) => {
            let customField;
            const placeholder = field.ApiName;
            if (field.ApiName.toLowerCase().indexOf('street') >= 0) {
                customField = new PepTextboxField({
                    key: field.ApiName,
                    label: field.ApiName,
                    type: 'text',
                    placeholder,
                    readonly: !canEditObject,
                    disabled: !field.Enabled || !canEditObject,
                    hidden: false,
                    mandatory: false,
                    value: field.Value,
                    formattedValue: field.FormattedValue,
                    row: 0,
                    rowSpan: 1,
                    col: 0,
                    colSpan: 2,
                    xAlignment: this.convertXAlignToHorizontalAlign(controlField.Layout.XAlignment),
                    yAlignment: this.convertYAlignToVerticalAlign(controlField.Layout.YAlignment),
                    order: 0,
                });
            }
            else if (field.ApiName.toLowerCase().indexOf('city') >= 0) {
                customField = new PepTextboxField({
                    key: field.ApiName,
                    label: field.ApiName,
                    type: 'text',
                    placeholder,
                    readonly: !canEditObject,
                    disabled: !field.Enabled || !canEditObject,
                    hidden: false,
                    mandatory: false,
                    value: field.Value,
                    formattedValue: field.FormattedValue,
                    row: 0,
                    rowSpan: 1,
                    col: 2,
                    colSpan: 1,
                    xAlignment: this.convertXAlignToHorizontalAlign(controlField.Layout.XAlignment),
                    yAlignment: this.convertYAlignToVerticalAlign(controlField.Layout.YAlignment),
                    order: 1,
                });
            }
            else if (field.ApiName.toLowerCase().indexOf('state') >= 0) {
                customField = new PepSelectField({
                    key: field.ApiName,
                    label: field.ApiName,
                    placeholder,
                    options: this.convertOptionalValues(field.OptionalValues),
                    readonly: !canEditObject,
                    disabled: !field.Enabled || !canEditObject,
                    hidden: false,
                    mandatory: false,
                    value: field.Value,
                    formattedValue: field.FormattedValue,
                    row: 1,
                    rowSpan: 1,
                    col: 0,
                    colSpan: 1,
                    xAlignment: this.convertXAlignToHorizontalAlign(controlField.Layout.XAlignment),
                    yAlignment: this.convertYAlignToVerticalAlign(controlField.Layout.YAlignment),
                    order: 2,
                });
            }
            else if (field.ApiName.toLowerCase().indexOf('zipcode') >= 0) {
                customField = new PepTextboxField({
                    key: field.ApiName,
                    label: field.ApiName,
                    type: 'text',
                    placeholder,
                    readonly: !canEditObject,
                    disabled: !field.Enabled || !canEditObject,
                    hidden: false,
                    mandatory: false,
                    value: field.Value,
                    formattedValue: field.FormattedValue,
                    row: 1,
                    rowSpan: 1,
                    col: 1,
                    colSpan: 1,
                    xAlignment: this.convertXAlignToHorizontalAlign(controlField.Layout.XAlignment),
                    yAlignment: this.convertYAlignToVerticalAlign(controlField.Layout.YAlignment),
                    order: 3,
                });
            }
            else if (field.ApiName.toLowerCase().indexOf('country') >= 0) {
                customField = new PepSelectField({
                    key: field.ApiName,
                    label: field.ApiName,
                    placeholder,
                    options: this.convertOptionalValues(field.OptionalValues),
                    readonly: !canEditObject,
                    disabled: !field.Enabled || !canEditObject,
                    hidden: false,
                    mandatory: false,
                    value: field.Value,
                    formattedValue: field.FormattedValue,
                    row: 2,
                    rowSpan: 1,
                    col: 2,
                    colSpan: 1,
                    xAlignment: this.convertXAlignToHorizontalAlign(controlField.Layout.XAlignment),
                    yAlignment: this.convertYAlignToVerticalAlign(controlField.Layout.YAlignment),
                    order: 4,
                });
            }
            fields.push(customField);
        });
        return fields.sort((n1, n2) => n1.order > n2.order ? 1 : n1.order < n2.order ? -1 : 0);
    }
    isMatrixField(apiNameToCheck) {
        return apiNameToCheck.indexOf('Matrix') >= 0;
    }
    doesFieldHavaFloatingField(controlField, floatingField) {
        let hasFloatingField = false;
        if (floatingField.Layout.Y >= controlField.Layout.Y &&
            floatingField.Layout.Y <
                controlField.Layout.Y + controlField.Layout.Height &&
            floatingField.Layout.X >= controlField.Layout.X &&
            floatingField.Layout.X <
                controlField.Layout.X + controlField.Layout.Width) {
            hasFloatingField = true;
        }
        return hasFloatingField;
    }
    getOptionsForCustomField(controlField, dataField, canEditObject) {
        if (!controlField || !dataField) {
            return;
        }
        const placeholder = controlField.ReadOnly || !canEditObject ? '' : controlField.Title;
        return {
            key: controlField.ApiName,
            label: controlField.Title,
            accessory: dataField.Accessory,
            placeholder,
            readonly: controlField.ReadOnly || !canEditObject,
            disabled: !dataField.Enabled || !canEditObject,
            hidden: controlField.Hidden,
            mandatory: controlField.Mandatory,
            value: dataField.Value,
            formattedValue: dataField.FormattedValue,
            additionalValue: dataField.AdditionalValue,
            row: controlField.Layout.Y,
            rowSpan: controlField.Layout.Height,
            col: controlField.Layout.X,
            colSpan: controlField.Layout.Width,
            xAlignment: this.convertXAlignToHorizontalAlign(controlField.Layout.XAlignment),
            yAlignment: this.convertYAlignToVerticalAlign(controlField.Layout.YAlignment),
            options: this.convertOptionalValues(dataField.OptionalValues),
            groupFields: undefined,
            maxFieldCharacters: controlField.MaxFieldCharacters,
            minValue: controlField.MinValue,
            maxValue: controlField.MaxValue,
            // hasMenu: hasMenu,
            // hasCampaign: hasCampaign,
            // hasIndicators: hasIndicators,
            textColor: dataField.TextColor,
            visible: dataField.Visible,
        };
    }
    convertToCustomField(controlField, dataField, canEditObject, menuField, hasCampaignField, indicatorsField, objectId, parentId, searchCode) {
        let customField;
        const options = this.getOptionsForCustomField(controlField, dataField, canEditObject);
        if (controlField.ApiName === 'ObjectMenu') {
            options.type = 'menu';
            customField = new PepInternalMenuField(options);
        }
        else if (controlField.FieldType === FIELD_TYPE.NumberRealQuantitySelector ||
            controlField.FieldType ===
                FIELD_TYPE.NumberIntegerQuantitySelector ||
            controlField.ApiName === 'QuantitySelector' ||
            controlField.ApiName === 'UnitsQuantity' ||
            controlField.ApiName.indexOf('size_') === 0) {
            if (dataField.FieldType === FIELD_TYPE.InternalLink) {
                options.type = 'button';
            }
            else if (dataField.FieldType === FIELD_TYPE.Package) {
                options.type = 'packageButton';
            }
            else if (dataField.FieldType === FIELD_TYPE.NumberRealQuantitySelector ||
                dataField.FieldType === FIELD_TYPE.NumberReal) {
                options.type = 'qs';
                options.allowDecimal = true;
            }
            else if (dataField.FieldType ===
                FIELD_TYPE.NumberIntegerQuantitySelector ||
                dataField.FieldType === FIELD_TYPE.NumberInteger) {
                options.type = 'qs';
                options.allowDecimal = false;
            }
            else if (dataField.FieldType === FIELD_TYPE.NumberIntegerForMatrix) {
                options.type = 'qsForMatrix';
                options.allowDecimal = false;
            }
            else if (dataField.FieldType === FIELD_TYPE.NumberRealForMatrix) {
                options.type = 'qsForMatrix';
                options.allowDecimal = true;
            }
            options.notificationInfo = dataField.NotificationInfo;
            customField = new PepQuantitySelectorField(options);
        }
        else {
            // HACK: need to remove this..
            if (dataField.FieldType === FIELD_TYPE.Indicators &&
                this.isMatrixField(dataField.ApiName)) {
                dataField.FieldType = FIELD_TYPE.InternalPage;
            }
            switch (dataField.FieldType) {
                case FIELD_TYPE.Address: {
                    const canEditGroupObject = controlField.ReadOnly
                        ? false
                        : canEditObject;
                    options.groupFields = this.convertAddressFields(controlField, dataField.GroupFields, canEditGroupObject);
                    customField = new PepAddressField(options);
                    break;
                }
                case FIELD_TYPE.Indicators: {
                    // options['type'] = 'indicators'; // Not needed this is PepIndicatorsField.
                    customField = new PepIndicatorsField(options);
                    break;
                }
                case FIELD_TYPE.InternalPage: {
                    if (this.isMatrixField(controlField.ApiName)) {
                        options.rowSpan = controlField.Layout.Height;
                        options.objectId = objectId;
                        options.parentId = parentId;
                        options.searchCode = searchCode;
                        customField = new PepInternalPageField(options);
                    }
                    else {
                        // Not supported
                    }
                    break;
                }
                case FIELD_TYPE.Link: {
                    options.type = 'link';
                    customField = new PepTextboxField(options);
                    break;
                }
                case FIELD_TYPE.InternalLink:
                case FIELD_TYPE.Button: {
                    options.type = 'button';
                    customField = new PepInternalButtonField(options);
                    break;
                }
                case FIELD_TYPE.Attachment: {
                    // options.type = 'attachment';
                    customField = new PepAttachmentField(options);
                    break;
                }
                case FIELD_TYPE.Signature: {
                    // options.type = 'signature';
                    customField = new PepSignatureField(options);
                    break;
                }
                case FIELD_TYPE.Image:
                case FIELD_TYPE.ImageURL: {
                    // options.type = 'image';
                    options.menuField =
                        menuField &&
                            this.doesFieldHavaFloatingField(controlField, menuField)
                            ? menuField
                            : null;
                    options.hasCampaignField =
                        hasCampaignField &&
                            this.doesFieldHavaFloatingField(controlField, hasCampaignField)
                            ? hasCampaignField
                            : null;
                    options.indicatorsField =
                        indicatorsField &&
                            this.doesFieldHavaFloatingField(controlField, indicatorsField)
                            ? indicatorsField
                            : null;
                    customField = new PepImageField(options);
                    break;
                }
                case FIELD_TYPE.Images: {
                    // options.type = 'images';
                    customField = new PepImagesField(options);
                    break;
                }
                case FIELD_TYPE.Email: {
                    options.type = 'email';
                    customField = new PepTextboxField(options);
                    break;
                }
                case FIELD_TYPE.Phone: {
                    options.type = 'phone';
                    customField = new PepTextboxField(options);
                    break;
                }
                case FIELD_TYPE.Duration: {
                    options.type = 'duration';
                    customField = new PepTextboxField(options);
                    break;
                }
                case FIELD_TYPE.Default:
                case FIELD_TYPE.TextBox:
                case FIELD_TYPE.LimitedLengthTextBox:
                case FIELD_TYPE.TextHeader:
                case FIELD_TYPE.CalculatedString:
                case FIELD_TYPE.MapDataString: {
                    customField = new PepTextboxField(options);
                    break;
                }
                case FIELD_TYPE.TextArea: {
                    customField = new PepTextareaField(options);
                    break;
                }
                case FIELD_TYPE.RichTextHTML: {
                    customField = new PepRichHtmlTextareaField(options);
                    break;
                }
                case FIELD_TYPE.Date:
                case FIELD_TYPE.LimitedDate:
                case FIELD_TYPE.CalculatedDate:
                case FIELD_TYPE.DateAndTime: {
                    options.type =
                        dataField.FieldType === FIELD_TYPE.DateAndTime
                            ? 'datetime'
                            : 'date';
                    customField = new PepDateField(options);
                    break;
                }
                case FIELD_TYPE.NumberInteger:
                case FIELD_TYPE.CalculatedInt:
                case FIELD_TYPE.MapDataInt: {
                    options.type = 'int';
                    customField = new PepTextboxField(options);
                    break;
                }
                case FIELD_TYPE.Percentage: {
                    options.type = 'percentage';
                    customField = new PepTextboxField(options);
                    break;
                }
                case FIELD_TYPE.Currency: {
                    options.type = 'currency';
                    customField = new PepTextboxField(options);
                    break;
                }
                case FIELD_TYPE.NumberReal:
                case FIELD_TYPE.CalculatedReal:
                case FIELD_TYPE.MapDataReal:
                case FIELD_TYPE.Sum:
                case FIELD_TYPE.Totals: {
                    options.type = 'real';
                    customField = new PepTextboxField(options);
                    break;
                }
                case FIELD_TYPE.Boolean:
                case FIELD_TYPE.CalculatedBool: {
                    customField = new PepCheckboxField(options);
                    break;
                }
                case FIELD_TYPE.BooleanText: {
                    options.type = 'booleanText';
                    customField = new PepCheckboxField(options);
                    break;
                }
                case FIELD_TYPE.ComboBox:
                case FIELD_TYPE.EmptyComboBox:
                case FIELD_TYPE.MapDataDropDown: {
                    // options.type = 'select';
                    customField = new PepSelectField(options);
                    break;
                }
                case FIELD_TYPE.MultiTickBox:
                case FIELD_TYPE.MultiTickBoxToComboBox:
                case FIELD_TYPE.EmptyMultiTickBox: {
                    options.type = 'multi';
                    customField = new PepSelectField(options);
                    break;
                }
                case FIELD_TYPE.GuidReferenceType: {
                    options.type = 'reference';
                    options.referenceObjectType = dataField.ReferenceObjectType;
                    options.referenceObjectSubType =
                        dataField.ReferenceObjectSubType;
                    options.referenceObjectInternalType =
                        dataField.ReferenceObjectInternalType;
                    customField = new PepInternalButtonField(options);
                    break;
                }
                case FIELD_TYPE.ListOfObjects: {
                    options.type = 'listofobjects';
                    customField = new PepInternalButtonField(options);
                    break;
                }
                case FIELD_TYPE.Separator: {
                    customField = new PepSeparatorField(options);
                    break;
                }
                /*
                    case FIELD_TYPE.Images: return that.field(value);
                */
                case FIELD_TYPE.NumberRealQuantitySelector:
                case FIELD_TYPE.NumberIntegerQuantitySelector: {
                    options.type = 'qs';
                    options.allowDecimal =
                        dataField.FieldType ===
                            FIELD_TYPE.NumberRealQuantitySelector;
                    options.notificationInfo = dataField.NotificationInfo;
                    customField = new PepQuantitySelectorField(options);
                    break;
                }
                case FIELD_TYPE.Package: {
                    options.type = 'packageButton';
                    options.notificationInfo = dataField.NotificationInfo;
                    customField = new PepQuantitySelectorField(options);
                    break;
                }
            }
        }
        if (!customField) {
            options.label = controlField.ApiName + ' is not supported!!!';
            customField = new PepSeparatorField(options);
        }
        return customField;
    }
    getFieldFormattedValue(field) {
        let fieldFormattedValue = field.formattedValue;
        // Fix for the custom check box component.
        if (field.controlType === 'checkbox') {
            fieldFormattedValue = fieldFormattedValue === 'true';
        }
        // Fix for the custom button component.
        if (field.controlType === 'button') {
            fieldFormattedValue =
                fieldFormattedValue === '0' ? '' : fieldFormattedValue;
        }
        return fieldFormattedValue;
    }
    toControlGroup(fields) {
        const group = {};
        if (fields && fields.length > 0) {
            fields.forEach((field) => {
                if (field.groupFields && field.groupFields.length > 0) {
                    const subGroup = {};
                    field.groupFields.forEach((groupField) => {
                        if (groupField.mandatory &&
                            !field.readonly &&
                            !field.disabled) {
                            subGroup[groupField.key] = [
                                {
                                    value: groupField.formattedValue || '',
                                    disabled: field.readonly ||
                                        field.disabled ||
                                        groupField.disabled,
                                },
                                [Validators.required],
                            ];
                        }
                        else {
                            subGroup[groupField.key] = [
                                {
                                    value: groupField.formattedValue || '',
                                    disabled: field.readonly ||
                                        field.disabled ||
                                        groupField.disabled,
                                },
                                [Validators.nullValidator],
                            ];
                        }
                    });
                    group[field.key] = this.fb.group(subGroup);
                }
                else {
                    const validators = field.getValidators();
                    const fieldFormattedValue = this.getFieldFormattedValue(field);
                    group[field.key] = [
                        {
                            value: fieldFormattedValue || '',
                            disabled: field.disabled,
                        },
                        validators,
                    ];
                }
            });
        }
        return this.fb.group(group);
    }
    showFormValidationMessage() {
        const fields = this.fields;
        let emptyMandatoryFieldsMsg = '';
        let notValidFieldsMsg = '';
        // for (let i: number = 0; i < fields.length; i++) {
        //     let field = fields[i];
        for (const field of fields) {
            const formControl = this.form && this.form.get(field.key);
            if (formControl) {
                // Mandatory is empty.
                if (field.mandatory &&
                    formControl.value.toString().trim().length === 0) {
                    emptyMandatoryFieldsMsg +=
                        '<li><small>' + field.label + '</small></li>';
                }
                else if (!field.disabled && !formControl.valid) {
                    notValidFieldsMsg +=
                        '<li><small>' + field.label + '</small></li>';
                }
            }
        }
        // Add the header message of the empty mandatory fields
        if (emptyMandatoryFieldsMsg.length > 0) {
            emptyMandatoryFieldsMsg =
                '<div>' +
                    this.translate.instant('MESSAGES.ERROR_MANDATORY_FIELDS') +
                    "</div><ul style='padding: 0 20px;'>" +
                    emptyMandatoryFieldsMsg +
                    '</ul><br/>';
        }
        // Add the header message of the empty mandatory fields
        if (notValidFieldsMsg.length > 0) {
            notValidFieldsMsg =
                '<div>' +
                    this.translate.instant('MESSAGES.ERROR_INVALID_FIELDS') +
                    "</div><ul style='padding: 0 20px;'>" +
                    notValidFieldsMsg +
                    '</ul>';
        }
        const title = this.translate.instant('MESSAGES.TITLE_NOTICE');
        const data = new PepDialogData({
            title,
            content: emptyMandatoryFieldsMsg + notValidFieldsMsg,
        });
        this.dialogService.openDefaultDialog(data);
    }
    ngOnInit() {
        const themeVars = this.customizationService.getThemeVariables();
        // convert rem to pixel
        const RemToPixel = 16;
        this.formGutterSize =
            this.customizationService.getNumberThemeVariable(themeVars, PepCustomizationService.FORM_SPACEING_KEY) * RemToPixel;
        this.cardGutterSize =
            this.customizationService.getNumberThemeVariable(themeVars, PepCustomizationService.CARD_SPACEING_KEY) * RemToPixel;
    }
    ngDoCheck() {
        const changes = this.differ.diff(this.data); // check for changes
        if (changes) {
            this.updateForm();
            this.checkForChanges = new Date();
        }
    }
    ngOnChanges(changes) {
        // if (changes.data && changes.data.currentValue) {
        //     // Load changes
        //     if (!this.shouldReloadForm && changes.data.previousValue) {
        //         this.data = changes.data.currentValue;
        //         this.updateForm();
        //     } else {
        //         this._shouldReloadForm = false;
        //         this.initForm();
        //     }
        // }
        // if (this.shouldReloadForm || !changes?.data?.previousValue) {
        //     this._shouldReloadForm = false;
        //     this.initForm();
        //     this.checkForChanges = new Date();
        // }
    }
    ngOnDestroy() {
        // if (this.valueChange) {
        //     this.valueChange.unsubscribe();
        // }
        // if (this.formValidationChange) {
        //     this.formValidationChange.unsubscribe();
        // }
        // if (this.childClick) {
        //     this.childClick.unsubscribe();
        // }
        // if (this.childChange) {
        //     this.childChange.unsubscribe();
        // }
        // if (this.fieldClick) {
        //     this.fieldClick.unsubscribe();
        // }
    }
    getUiControlFields() {
        return this.layout ? this.layout.ControlFields : [];
    }
    initFieldsStructure(fields, maxRow) {
        const themeVars = this.customizationService.getThemeVariables();
        // Set form row height.
        if (this.layoutType === 'card') {
            const cardFieldHeight = this.customizationService.getNumberThemeVariable(themeVars, PepCustomizationService.CARD_FIELD_HEIGHT_KEY);
            this.rowHeight = cardFieldHeight;
        }
        else {
            const rowFieldHeight = this.customizationService.getNumberThemeVariable(themeVars, PepCustomizationService.FORM_FIELD_HEIGHT_KEY);
            const rowFieldTitleHeight = this.customizationService.getNumberThemeVariable(themeVars, PepCustomizationService.FORM_FIELD_TITLE_HEIGHT_KEY);
            this.rowHeight = rowFieldHeight + rowFieldTitleHeight;
        }
        // Create the fields structure (the fields must be sorted!!!).
        if (fields.length > 0) {
            // Init the layout.
            if (
            // this.layoutType === 'form' ||
            this.layoutType === 'table') {
                this.fields = fields;
                this.rows = [];
                for (let i = 0; i <= maxRow; i++) {
                    this.rows[i] = [];
                }
                // for (let i = 0; i < fields.length; i++) {
                // const field = fields[i]
                for (const field of fields) {
                    this.rows[field.row].push(field);
                }
            }
            else {
                const doesfieldExistIn = new Array(maxRow);
                for (let i = 0; i < doesfieldExistIn.length; i++) {
                    doesfieldExistIn[i] = new Array(this.columns);
                    for (let j = 0; j < doesfieldExistIn[i].length; j++) {
                        doesfieldExistIn[i][j] = false;
                    }
                }
                // Run in squere (row - colspan, col - rowspan) and put true where it should.
                // for (let index = 0; index < fields.length; index++) {
                //     const currentField = fields[index];
                for (const currentField of fields) {
                    if (currentField.rowSpan > 1) {
                        for (let row = currentField.row; row < currentField.row + currentField.rowSpan; row++) {
                            if (currentField.colSpan > 1) {
                                for (let col = currentField.col; col <
                                    currentField.col + currentField.colSpan; col++) {
                                    if (doesfieldExistIn.length > row &&
                                        doesfieldExistIn[0].length > col) {
                                        doesfieldExistIn[row][col] = true;
                                    }
                                }
                            }
                            else {
                                if (doesfieldExistIn.length > row &&
                                    doesfieldExistIn[0].length >
                                        currentField.col) {
                                    doesfieldExistIn[row][currentField.col] = true;
                                }
                            }
                        }
                    }
                    else if (currentField.colSpan > 1) {
                        for (let col = currentField.col; col < currentField.col + currentField.colSpan; col++) {
                            if (doesfieldExistIn.length > currentField.row &&
                                doesfieldExistIn[0].length > col) {
                                doesfieldExistIn[currentField.row][col] = true;
                            }
                        }
                    }
                    else {
                        if (doesfieldExistIn.length > currentField.row &&
                            doesfieldExistIn[0].length > currentField.col) {
                            doesfieldExistIn[currentField.row][currentField.col] = true;
                        }
                    }
                }
                // Create empty fields where doesfieldExistIn is false (For the md-grid-list UI Component).
                for (let i = 0; i < doesfieldExistIn.length; i++) {
                    for (let j = 0; j < doesfieldExistIn[i].length; j++) {
                        if (!doesfieldExistIn[i][j]) {
                            // Create empty field and add it to the fields list.
                            fields.push(new PepPlaceholderField({
                                key: i + '_' + j,
                                label: '',
                                placeholder: '',
                                readonly: false,
                                disabled: false,
                                hidden: false,
                                mandatory: false,
                                value: '',
                                formattedValue: '',
                                row: i,
                                rowSpan: 1,
                                col: j,
                                colSpan: 1,
                                order: 1,
                            }));
                        }
                    }
                }
                // Sort the fields again.
                this.fields = fields.sort((f1, f2) => f1.row > f2.row
                    ? 1
                    : f1.row < f2.row
                        ? -1
                        : f1.col > f2.col
                            ? 1
                            : f1.col < f2.col
                                ? -1
                                : 0);
            }
        }
    }
    setForm(isForUpdate = false) {
        var _a;
        let allFieldsAreReadOnly = true;
        if (!isForUpdate) {
            const fields = [];
            for (const currentField of this.fields) {
                // Add all fields except 'internalPage' type (for children).
                if (currentField.controlType !== 'internalPage') {
                    fields.push(currentField);
                }
                if (!currentField.readonly) {
                    allFieldsAreReadOnly = false;
                }
            }
            this.form = this.toControlGroup(fields);
        }
        else {
            // Update form values if changed by calculated fields.
            for (const currentField of this.fields) {
                if (currentField.controlType !== 'internalPage') {
                    if (currentField.groupFields &&
                        currentField.groupFields.length > 0) {
                        // for (let j = 0; j < currentField.groupFields.length; j++) {
                        //     let currentGroupField = currentField.groupFields[j];
                        for (const currentGroupField of currentField.groupFields) {
                            const fieldFormattedValue = this.getFieldFormattedValue(currentGroupField);
                            this.customizationService.updateFormField(this.form, currentGroupField, fieldFormattedValue, currentField);
                        }
                    }
                    else {
                        const fieldFormattedValue = this.getFieldFormattedValue(currentField);
                        // this.form.controls[currentField.key].setValue(fieldFormattedValue);
                        this.customizationService.updateFormField(this.form, currentField, fieldFormattedValue);
                    }
                }
                if (!currentField.readonly) {
                    allFieldsAreReadOnly = false;
                }
            }
        }
        let isFormValid = (_a = this.form) === null || _a === void 0 ? void 0 : _a.valid;
        // Change validation to true if all fields are read only.
        if (!isFormValid && allFieldsAreReadOnly) {
            isFormValid = true;
        }
        this.onFormValidationChanged(isFormValid);
        // Set it to false to enable all fields.
        this.isLocked = false;
    }
    initForm() {
        if (this.data && this.data.Fields) {
            const fields = this.convertCustomFields(this.getUiControlFields(), this.data.Fields);
            const maxRow = Math.max(...fields.map((f) => {
                return f.row + f.rowSpan;
            }));
            this.columns = Math.max(...fields.map((f) => {
                return f.col + f.colSpan;
            }));
            this.initFieldsStructure(fields, maxRow);
            this.setForm();
        }
    }
    updateField(customField, updatedField) {
        const options = {
            disabled: !updatedField.Enabled || !this.canEditObject,
            readonly: !updatedField.Enabled || !this.canEditObject,
            visible: updatedField.Visible,
            value: updatedField.Value,
            additionalValue: updatedField.AdditionalValue,
            formattedValue: updatedField.FormattedValue,
            textColor: updatedField.TextColor,
        };
        if (customField instanceof PepQuantitySelectorField) {
            const notificationInfo = updatedField.NotificationInfo;
            options.notificationInfo = notificationInfo;
        }
        else if (customField instanceof PepSelectField) {
            options.options = this.convertOptionalValues(updatedField.OptionalValues);
            if (!options.options || options.options.length === 0) {
                options.options.push({
                    key: options.value,
                    value: options.formattedValue,
                });
            }
        }
        customField.update(options);
    }
    updateForm() {
        if (this.data && this.data.Fields) {
            for (const currentField of this.data.Fields) {
                const customField = this.fields.filter((f) => f.key === currentField.ApiName)[0];
                // Update all fields except 'internalPage' type (for children).
                if (customField && customField.controlType !== 'internalPage') {
                    this.updateField(customField, currentField);
                    // Update the group fields.
                    if (customField.controlType === 'address' &&
                        currentField.GroupFields) {
                        // for (let j = 0; j < currentField.GroupFields.length; j++) {
                        // let currentGroupField = currentField.GroupFields[j];
                        for (const currentGroupField of currentField.GroupFields) {
                            currentGroupField.Enabled = !currentField.Enabled
                                ? false
                                : currentGroupField.Enabled;
                            const customGroupField = customField.groupFields.filter((f) => f.key === currentGroupField.ApiName)[0];
                            this.updateField(customGroupField, currentGroupField);
                        }
                    }
                }
            }
            this.setForm(true);
        }
    }
    ReloadForm() {
        this._shouldReloadForm = true;
    }
    // onSubmit() {
    //     if (this.form.valid) {
    //         this.payLoad = JSON.stringify(this.form.value);
    //         //this.submitted.emit(this.form.value);
    //     }
    // }
    getFormControlById(key) {
        let formControl = null;
        this.fields.forEach((field) => {
            if (field.key === key) {
                formControl = this.form.get(field.key);
                return;
            }
            else if (field.groupFields && field.groupFields.length > 0) {
                field.groupFields.forEach((groupField) => {
                    if (groupField.key === key) {
                        formControl = this.form.get(field.key + '.' + groupField.key);
                        return;
                    }
                });
            }
        });
        return formControl;
    }
    setSpecialFields(controlFields, dataFields) {
        // let cf;
        // for (let index = 0; index < controlFields.length; index++) {
        //     cf = controlFields[index];
        for (const cf of controlFields) {
            if (cf.ApiName === 'ObjectMenu') {
                this.menuField = cf;
            }
            else if (cf.ApiName === 'ItemHasActiveCampaign') {
                this.hasCampaignField = cf;
            }
            else if (cf.ApiName === 'ItemIndicatorsWithoutCampaign') {
                this.indicatorsField = cf;
            }
        }
        // let df;
        // for (let index = 0; index < dataFields.length; index++) {
        //     df = dataFields[index];
        for (const df of dataFields) {
            if (df.ApiName === 'ObjectMenu') {
                this.menuDataField = df;
            }
            else if (df.ApiName === 'ItemHasActiveCampaign') {
                this.hasCampaignDataField = df;
            }
            else if (df.ApiName === 'ItemIndicatorsWithoutCampaign') {
                this.indicatorsDataField = df;
            }
        }
        if (this.menuField && this.menuDataField) {
            this.menuDataField.Layout = this.menuField.Layout;
        }
        if (this.hasCampaignField && this.hasCampaignDataField) {
            this.hasCampaignDataField.Layout = this.hasCampaignField.Layout;
        }
        if (this.indicatorsField && this.indicatorsDataField) {
            this.indicatorsDataField.Layout = this.indicatorsField.Layout;
        }
        // Check if menu is floating on other field.
        // for (let index = 0; index < controlFields.length; index++) {
        //     cf = controlFields[index];
        for (const cf of controlFields) {
            if (this.menuField && cf.ApiName !== 'ObjectMenu') {
                this.hasMenuFloatingOnOtherField = this.doesFieldHavaFloatingField(cf, this.menuField);
                if (this.hasMenuFloatingOnOtherField) {
                    break;
                }
            }
        }
    }
    convertCustomFields(controlFields, dataFields) {
        if (this.layoutType !== 'table') {
            this.setSpecialFields(controlFields, dataFields);
        }
        else {
            // HACK: convert to center alignment if table view & special fields)
            controlFields.forEach((field, index) => {
                if (field.ApiName === 'UnitsQuantity' ||
                    field.ApiName === 'QuantitySelector' ||
                    field.ApiName === 'ObjectMenu' ||
                    field.FieldType === FIELD_TYPE.Image ||
                    field.FieldType === FIELD_TYPE.ImageURL ||
                    field.FieldType === FIELD_TYPE.Indicators ||
                    field.FieldType === FIELD_TYPE.Boolean ||
                    field.FieldType === FIELD_TYPE.CalculatedBool ||
                    field.FieldType === FIELD_TYPE.Signature ||
                    field.FieldType ===
                        FIELD_TYPE.NumberIntegerQuantitySelector ||
                    field.FieldType === FIELD_TYPE.NumberRealQuantitySelector ||
                    field.FieldType === FIELD_TYPE.Package ||
                    field.FieldType === FIELD_TYPE.NumberIntegerForMatrix ||
                    field.FieldType === FIELD_TYPE.NumberRealForMatrix) {
                    field.Layout.XAlignment = X_ALIGNMENT_TYPE.Center;
                }
                else {
                    // HACK: align the rest of the fields by the culture.
                    // field.Layout.XAlignment = this.layoutService.isRtl() ? X_ALIGNMENT_TYPE.Right : X_ALIGNMENT_TYPE.Left;
                }
            });
        }
        const fields = [];
        // const matrixFields = controlFields.filter((cf) =>
        //     this.isMatrixField(cf.ApiName)
        // ).length;
        // let matrixAlreadyPlaced = false;
        controlFields.forEach((field, index) => {
            const dataField = dataFields.filter((df) => df.ApiName === field.ApiName)[0];
            if (!dataField) {
                return;
            }
            // If current view is not table view and those fields are special.
            if (this.layoutType !== 'table' &&
                ((this.hasMenuFloatingOnOtherField &&
                    this.menuField &&
                    this.menuField.ApiName === field.ApiName) ||
                    (this.indicatorsField &&
                        this.indicatorsField.ApiName === field.ApiName) ||
                    (this.hasCampaignField &&
                        this.hasCampaignField.ApiName === field.ApiName))) {
                return;
            }
            // Set type to link
            if (index === 0 && this.firstFieldAsLink) {
                dataField.FieldType = FIELD_TYPE.InternalLink;
                // dataField.Value = this.getInternalLinkHref();
            }
            else if (dataField.Value.length > 0 &&
                (field.FieldType === FIELD_TYPE.ReferenceType ||
                    field.FieldType === FIELD_TYPE.GuidReferenceType)) {
                // const transactionUrl =
                //     this.data.MainAction === '2'
                //         ? 'transactions/scope_items/'
                //         : 'transactions/cart/';
                // dataField.Value = transactionUrl + dataField.Value;
            }
            if (field.ApiName === 'ObjectMenu') {
                dataField.Enabled = true;
                // HACK : Until "Enabled" returns from the server, we set PepMenu to be
                //        Disabled in cart on regular items and not campign items.
            }
            const customField = this.convertToCustomField(field, dataField, this.canEditObject, this.menuDataField, this.hasCampaignDataField, this.indicatorsDataField, this.objectId, this.parentId, this.searchCode);
            fields.push(customField);
        });
        return fields.sort((f1, f2) => f1.row > f2.row
            ? 1
            : f1.row < f2.row
                ? -1
                : f1.col > f2.col
                    ? 1
                    : f1.col < f2.col
                        ? -1
                        : 0);
    }
    onValueChanged(event) {
        this.onFormValidationChanged(this.form.valid);
        const formControl = this.getFormControlById(event.key);
        const isValid = formControl ? formControl.valid : true;
        // const isValid = true;
        if (isValid) {
            // Set it to false to disable all fields.
            if (this.layoutType === 'form') {
                this.isLocked = true;
            }
            // Update the current field value.
            const currentField = this.fields.find((f) => f.key === event.key);
            if (currentField) {
                currentField.formattedValue = currentField.value = event.value;
            }
            this.valueChange.emit({
                id: this.data.UID.toString(),
                key: event.key,
                value: event.value,
                controlType: event.controlType,
            });
        }
    }
    onChildClicked(childClick) {
        this.childClick.emit(childClick);
    }
    onChildChanged(childChange) {
        this.childChange.emit(childChange);
    }
    onFormValidationChanged(formValidationChange) {
        this.formValidationChange.emit(formValidationChange);
    }
    onClick(fieldClickEvent) {
        const clickedUiControlField = this.data.Fields.filter((f) => f.ApiName === fieldClickEvent.key)[0];
        const idType = this.data.Type ? this.data.Type.toString() : '';
        if (clickedUiControlField) {
            if (clickedUiControlField.FieldType === FIELD_TYPE.GuidReferenceType) {
                this.fieldClick.emit({
                    id: this.data.UID.toString(),
                    key: fieldClickEvent.key,
                    idType,
                    which: fieldClickEvent.eventWhich,
                    value: fieldClickEvent.value,
                    controlType: fieldClickEvent.controlType,
                    fieldType: clickedUiControlField.FieldType,
                    otherData: fieldClickEvent.otherData,
                });
            }
            else if (clickedUiControlField.FieldType === FIELD_TYPE.ListOfObjects) {
                this.fieldClick.emit({
                    id: this.data.UID.toString(),
                    key: fieldClickEvent.key,
                    idType,
                    which: fieldClickEvent.eventWhich,
                    value: fieldClickEvent.value,
                    controlType: fieldClickEvent.controlType,
                    fieldType: clickedUiControlField.FieldType,
                    otherData: fieldClickEvent.otherData,
                });
            }
            else {
                this.fieldClick.emit({
                    id: this.data.UID.toString(),
                    key: fieldClickEvent.key,
                    idType,
                    which: fieldClickEvent.eventWhich,
                    value: fieldClickEvent.value,
                    controlType: fieldClickEvent.controlType,
                    fieldType: clickedUiControlField.FieldType,
                    otherData: fieldClickEvent.otherData,
                });
            }
        }
        else {
            // For other api names (like enter children etc).
            this.fieldClick.emit({
                id: this.data.UID.toString(),
                key: fieldClickEvent.key,
                idType,
                which: fieldClickEvent.eventWhich,
                value: fieldClickEvent.value,
                controlType: fieldClickEvent.controlType,
                otherData: fieldClickEvent.otherData,
            });
        }
    }
}
PepFormComponent.decorators = [
    { type: Component, args: [{
                selector: 'pep-form',
                template: "<fieldset *ngIf=\"form\" [formGroup]=\"form\" [disabled]=\"isLocked\" class=\"pep-form\"\n    [ngStyle]=\"{ 'background-color': layoutType == 'card' && data?.BackgroundColor }\">\n    <!-- New Form -->\n    <mat-grid-list *ngIf=\"layoutType == 'form'\" [cols]=\"columns\" [rowHeight]=\"rowHeight + 'rem'\"\n        [gutterSize]=\"formGutterSize\">\n        <mat-grid-tile *ngFor=\"let field of fields\" [rowspan]=\"field.rowSpan\" [colspan]=\"field.colSpan\">\n            <pep-field-generator *ngIf=\"field.controlType != 'placeholder'\" [form]=\"form\" [layoutType]=\"layoutType\"\n                [checkForChanges]=\"checkForChanges\" [uid]=\"data?.UID\" [field]=\"field\" [showTitle]=\"showTitle\"\n                (valueChange)=\"onValueChanged($event)\" (childClick)=\"onChildClicked($event)\"\n                (childChange)=\"onChildChanged($event)\" (elementClick)=\"onClick($event)\"\n                (formValidationChange)=\"onFormValidationChanged($event)\">\n            </pep-field-generator>\n        </mat-grid-tile>\n    </mat-grid-list>\n\n    <!-- Thumbnails -->\n    <mat-grid-list *ngIf=\"layoutType == 'card'\" [cols]=\"columns\" [rowHeight]=\"rowHeight + 'rem'\"\n        [gutterSize]=\"cardGutterSize\" class=\"card-spacing\">\n        <mat-grid-tile *ngFor=\"let field of fields\" [rowspan]=\"field.rowSpan\" [colspan]=\"field.colSpan\"\n            [ngStyle]=\"{ overflow: field.type == 'qs' ? 'unset' : 'hidden' }\">\n            <pep-field-generator *ngIf=\"field.controlType != 'placeholder'\" [form]=\"form\" [layoutType]=\"layoutType\"\n                [ngClass]=\"{ 'lock-events': lockEvents }\" [isActive]=\"isActive\" [checkForChanges]=\"checkForChanges\"\n                [uid]=\"data?.UID\" [field]=\"field\" [showTitle]=\"showTitle\" (valueChange)=\"onValueChanged($event)\"\n                (childClick)=\"onChildClicked($event)\" (childChange)=\"onChildChanged($event)\"\n                (elementClick)=\"onClick($event)\">\n            </pep-field-generator>\n        </mat-grid-tile>\n    </mat-grid-list>\n\n    <ng-container *ngIf=\"layoutType == 'table'\">\n        <ng-container *ngIf=\"isReport; then reportBlock; else notReportBlock\"></ng-container>\n        <ng-template #reportBlock>\n            <ng-container *ngTemplateOutlet=\"report\"></ng-container>\n        </ng-template>\n        <ng-template #notReportBlock>\n            <div *ngFor=\"let field of fields; let j = index\" class=\"pull-left flip table-cell \"\n                [ngClass]=\"['text-align-' + field.xAlignment]\" style=\"height: 100%\"\n                [ngStyle]=\"{ width: (layout?.ControlFields)[j]?.calcColumnWidthString}\">\n                <pep-field-generator *ngIf=\"field.controlType != 'placeholder'\" [checkForChanges]=\"checkForChanges\"\n                    [uid]=\"data?.UID\" [field]=\"field\" (valueChange)=\"onValueChanged($event)\"\n                    (elementClick)=\"onClick($event)\" [form]=\"form\" [layoutType]=\"layoutType\" [showTitle]=\"false\"\n                    [isActive]=\"isActive\">\n                </pep-field-generator>\n            </div>\n        </ng-template>\n    </ng-container>\n\n    <!------- For testing ------------\n    {{ form.value | json }}\n    {{ form.valid }}\n    ---------------------------------->\n</fieldset>\n\n<ng-template #report>\n    <div *ngFor=\"let field of fields; let j = index\" class=\"pull-left flip pep-report-fields\"\n        [ngStyle]=\"{ width: (layout?.ControlFields)[j]?.calcColumnWidthString }\"\n        [ngClass]=\"['text-align-' + field.xAlignment]\">\n        <ng-container [ngSwitch]=\"field.controlType\">\n            <pep-image *ngSwitchCase=\"'image'\" [uid]=\"data?.UID\" [form]=\"form\" [key]=\"field.key\"\n                [src]=\"field.formattedValue\" [srcLarge]=\"field.value\" [options]=\"field.options\" [label]=\"field.label\"\n                [mandatory]=\"field.mandatory\" [disabled]=\"field.disabled\" [readonly]=\"field.readonly\"\n                [xAlignment]=\"field.xAlignment\" [rowSpan]=\"field.rowSpan\" [layoutType]=\"layoutType\"\n                (elementClick)=\"onClick($event)\">\n            </pep-image>\n\n            <pep-signature *ngSwitchCase=\"'signature'\" [form]=\"form\" [key]=\"field.key\" [src]=\"field.value\"\n                [label]=\"field.label\" [mandatory]=\"field.mandatory\" [disabled]=\"field.disabled\"\n                [readonly]=\"field.readonly\" [xAlignment]=\"field.xAlignment\" [rowSpan]=\"field.rowSpan\"\n                [layoutType]=\"layoutType\">\n            </pep-signature>\n\n            <pep-checkbox *ngSwitchCase=\"'checkbox'\" [form]=\"form\" [key]=\"field.key\"\n                [value]=\"(field.value | lowercase) == 'true' || field.value == '1' ? true : false\" [label]=\"field.label\"\n                [type]=\"field.type\" [mandatory]=\"field.mandatory\" [disabled]=\"field.disabled\"\n                [readonly]=\"field.readonly\" [xAlignment]=\"field.xAlignment\" [rowSpan]=\"field.rowSpan\"\n                [additionalValue]=\"field.additionalValue\" [layoutType]=\"layoutType\">\n            </pep-checkbox>\n\n            <pep-date *ngSwitchCase=\"'date'\" [form]=\"form\" [key]=\"field.key\" [value]=\"field.value\"\n                [formattedValue]=\"field.formattedValue\" [label]=\"field.label\" [type]=\"field.type\"\n                [mandatory]=\"field.mandatory\" [disabled]=\"field.disabled\" [readonly]=\"field.readonly\"\n                [textColor]=\"field.textColor\" [xAlignment]=\"field.xAlignment\" [rowSpan]=\"field.rowSpan\"\n                [minValue]=\"field.minValue\" [maxValue]=\"field.maxValue\" [layoutType]=\"layoutType\">\n            </pep-date>\n\n            <pep-internal-button *ngSwitchCase=\"'button'\" [form]=\"form\" [key]=\"field.key\" [value]=\"field.value\"\n                [formattedValue]=\"field.formattedValue\" [label]=\"field.label\" [type]=\"field.type\"\n                [disabled]=\"field.disabled\" [readonly]=\"field.readonly\" [xAlignment]=\"field.xAlignment\"\n                [layoutType]=\"layoutType\" (elementClick)=\"onClick($event)\">\n            </pep-internal-button>\n\n            <pep-textarea *ngSwitchCase=\"'textarea'\" [form]=\"form\" [key]=\"field.key\" [value]=\"field.value\"\n                [label]=\"field.label\" [mandatory]=\"field.mandatory\" [disabled]=\"field.disabled\"\n                [readonly]=\"field.readonly\" [maxFieldCharacters]=\"field.maxFieldCharacters\"\n                [textColor]=\"field.textColor\" [xAlignment]=\"field.xAlignment\" [rowSpan]=\"field.rowSpan\"\n                [layoutType]=\"layoutType\">\n            </pep-textarea>\n\n            <pep-quantity-selector *ngSwitchCase=\"'qs'\" [id]=\"field.key\" [form]=\"form\" [key]=\"field.key\"\n                [value]=\"field.value\" [formattedValue]=\"field.formattedValue\" [label]=\"field.label\" [type]=\"field.type\"\n                [mandatory]=\"field.mandatory\" [disabled]=\"field.disabled\" [readonly]=\"field.readonly\"\n                [textColor]=\"field.textColor\" [xAlignment]=\"field.xAlignment\" [rowSpan]=\"field.rowSpan\"\n                [layoutType]=\"layoutType\" (valueChange)=\"onValueChanged($event)\" (elementClick)=\"onClick($event)\">\n            </pep-quantity-selector>\n\n            <ng-container *ngSwitchDefault>\n                <ng-container *ngIf=\"field.formattedValue?.length > 0; then notEmptyBlock; else emptyBlock\">\n                </ng-container>\n                <ng-template #notEmptyBlock>\n                    <ng-container\n                        *ngIf=\"field.controlType === 'attachment' || field.type === 'link'; then linkBlock; else notLinkBlock\">\n                    </ng-container>\n                    <ng-template #linkBlock>\n                        <a [id]=\"field.key\" class=\"color-link body-sm pep-report-input readonly\"\n                            *ngIf=\"field.formattedValue != null\" title=\"{{ field.formattedValue }}\" target=\"_blank\"\n                            href=\"{{ field.value }}\">{{ field.formattedValue }}</a>\n                    </ng-template>\n                    <ng-template #notLinkBlock>\n                        <span [id]=\"field.key\" class=\"body-sm pep-report-input readonly\"\n                            title=\"{{ field.formattedValue }}\" [ngStyle]=\"{ color: field.textColor }\">{{\n                            field.formattedValue }}</span>\n                    </ng-template>\n                </ng-template>\n                <ng-template #emptyBlock>\n                    <span>&nbsp;</span>\n                </ng-template>\n            </ng-container>\n        </ng-container>\n    </div>\n</ng-template>",
                changeDetection: ChangeDetectionStrategy.OnPush,
                styles: [":host{display:grid}"]
            },] }
];
PepFormComponent.ctorParameters = () => [
    { type: PepDialogService },
    { type: PepCustomizationService },
    { type: PepLayoutService },
    { type: FormBuilder },
    { type: KeyValueDiffers },
    { type: TranslateService }
];
PepFormComponent.propDecorators = {
    isReport: [{ type: Input }],
    layout: [{ type: Input }],
    lockEvents: [{ type: Input }],
    canEditObject: [{ type: Input }],
    data: [{ type: Input }],
    isActive: [{ type: Input }],
    layoutType: [{ type: Input }],
    objectId: [{ type: Input }],
    parentId: [{ type: Input }],
    searchCode: [{ type: Input }],
    showTitle: [{ type: Input }],
    firstFieldAsLink: [{ type: Input }],
    checkForChanges: [{ type: Input }],
    valueChange: [{ type: Output }],
    formValidationChange: [{ type: Output }],
    childClick: [{ type: Output }],
    childChange: [{ type: Output }],
    fieldClick: [{ type: Output }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wcm9qZWN0cy9uZ3gtbGliL2Zvcm0vZm9ybS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUNILFNBQVMsRUFDVCx1QkFBdUIsRUFHdkIsS0FBSyxFQUNMLGVBQWUsRUFDZixNQUFNLEVBQ04sWUFBWSxHQUlmLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFFSCxXQUFXLEVBQ1gsVUFBVSxHQUViLE1BQU0sZ0JBQWdCLENBQUM7QUFDeEIsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdkQsT0FBTyxFQUNILGdCQUFnQixFQUNoQixhQUFhLEdBQ2hCLE1BQU0sZ0NBQWdDLENBQUM7QUFDeEMsT0FBTyxFQUlILFVBQVUsRUFDVix1QkFBdUIsRUFDdkIsZ0JBQWdCLEVBTWhCLGVBQWUsRUFDZixjQUFjLEVBQ2Qsb0JBQW9CLEVBQ3BCLHdCQUF3QixFQUN4QixlQUFlLEVBQ2Ysa0JBQWtCLEVBQ2xCLG9CQUFvQixFQUNwQixzQkFBc0IsRUFDdEIsa0JBQWtCLEVBQ2xCLGlCQUFpQixFQUNqQixhQUFhLEVBQ2IsY0FBYyxFQUNkLGdCQUFnQixFQUNoQix3QkFBd0IsRUFDeEIsWUFBWSxFQUNaLGdCQUFnQixFQUNoQixpQkFBaUIsRUFDakIsbUJBQW1CLEVBR25CLGdCQUFnQixFQUNoQixnQkFBZ0IsRUFDaEIsMEJBQTBCLEVBQzFCLDRCQUE0QixHQUcvQixNQUFNLHlCQUF5QixDQUFDO0FBMEJqQyxNQUFNLE9BQU8sZ0JBQWdCO0lBc0V6QixpQ0FBaUM7SUFDakMseUJBQXlCO0lBRXpCLFlBQ1ksYUFBK0IsRUFDL0Isb0JBQTZDLEVBQzdDLGFBQStCLEVBQy9CLEVBQWUsRUFDdkIsT0FBd0IsRUFDaEIsU0FBMkI7UUFMM0Isa0JBQWEsR0FBYixhQUFhLENBQWtCO1FBQy9CLHlCQUFvQixH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LEVBQUUsZUFBZSxDQUFDLEtBQUs7Z0JBQzVCLFdBQVcsRUFBRSxlQUFlLENBQUMsV0FBVztnQkFDeEMsU0FBUyxFQUFFLGVBQWUsQ0FBQyxTQUFTO2FBQ3ZDLENBQUMsQ0FBQztTQUNOO0lBQ0wsQ0FBQzs7O1lBeDdDSixTQUFTLFNBQUM7Z0JBQ1AsUUFBUSxFQUFFLFVBQVU7Z0JBQ3BCLGsrUUFBb0M7Z0JBRXBDLGVBQWUsRUFBRSx1QkFBdUIsQ0FBQyxNQUFNOzthQUNsRDs7O1lBbEVHLGdCQUFnQjtZQVFoQix1QkFBdUI7WUFDdkIsZ0JBQWdCO1lBZmhCLFdBQVc7WUFUWCxlQUFlO1lBYVYsZ0JBQWdCOzs7dUJBc0VwQixLQUFLO3FCQUNMLEtBQUs7eUJBQ0wsS0FBSzs0QkFDTCxLQUFLO21CQUdMLEtBQUs7dUJBaUJMLEtBQUs7eUJBQ0wsS0FBSzt1QkFFTCxLQUFLO3VCQUNMLEtBQUs7eUJBQ0wsS0FBSzt3QkFDTCxLQUFLOytCQUNMLEtBQUs7OEJBQ0wsS0FBSzswQkFFTCxNQUFNO21DQUVOLE1BQU07eUJBRU4sTUFBTTswQkFDTixNQUFNO3lCQUNOLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICAgIENvbXBvbmVudCxcbiAgICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcbiAgICBPbkluaXQsXG4gICAgT25EZXN0cm95LFxuICAgIElucHV0LFxuICAgIEtleVZhbHVlRGlmZmVycyxcbiAgICBPdXRwdXQsXG4gICAgRXZlbnRFbWl0dGVyLFxuICAgIE9uQ2hhbmdlcyxcbiAgICBEb0NoZWNrLFxuICAgIE9wdGlvbmFsLFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7XG4gICAgRm9ybUdyb3VwLFxuICAgIEZvcm1CdWlsZGVyLFxuICAgIFZhbGlkYXRvcnMsXG4gICAgQWJzdHJhY3RDb250cm9sLFxufSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQgeyBUcmFuc2xhdGVTZXJ2aWNlIH0gZnJvbSAnQG5neC10cmFuc2xhdGUvY29yZSc7XG5pbXBvcnQge1xuICAgIFBlcERpYWxvZ1NlcnZpY2UsXG4gICAgUGVwRGlhbG9nRGF0YSxcbn0gZnJvbSAnQHBlcHBlcmktYWRkb25zL25neC1saWIvZGlhbG9nJztcbmltcG9ydCB7XG4gICAgSVBlcEZpZWxkVmFsdWVDaGFuZ2VFdmVudCxcbiAgICBJUGVwRmllbGRDbGlja0V2ZW50LFxuICAgIFBlcExheW91dFR5cGUsXG4gICAgRklFTERfVFlQRSxcbiAgICBQZXBDdXN0b21pemF0aW9uU2VydmljZSxcbiAgICBQZXBMYXlvdXRTZXJ2aWNlLFxuICAgIFVJQ29udHJvbCxcbiAgICBVSUNvbnRyb2xGaWVsZCxcbiAgICBPYmplY3RzRGF0YVJvdyxcbiAgICBPYmplY3RzRGF0YVJvd0NlbGwsXG4gICAgUGVwRmllbGRCYXNlLFxuICAgIFBlcFRleHRib3hGaWVsZCxcbiAgICBQZXBTZWxlY3RGaWVsZCxcbiAgICBQZXBJbnRlcm5hbE1lbnVGaWVsZCxcbiAgICBQZXBRdWFudGl0eVNlbGVjdG9yRmllbGQsXG4gICAgUGVwQWRkcmVzc0ZpZWxkLFxuICAgIFBlcEluZGljYXRvcnNGaWVsZCxcbiAgICBQZXBJbnRlcm5hbFBhZ2VGaWVsZCxcbiAgICBQZXBJbnRlcm5hbEJ1dHRvbkZpZWxkLFxuICAgIFBlcEF0dGFjaG1lbnRGaWVsZCxcbiAgICBQZXBTaWduYXR1cmVGaWVsZCxcbiAgICBQZXBJbWFnZUZpZWxkLFxuICAgIFBlcEltYWdlc0ZpZWxkLFxuICAgIFBlcFRleHRhcmVhRmllbGQsXG4gICAgUGVwUmljaEh0bWxUZXh0YXJlYUZpZWxkLFxuICAgIFBlcERhdGVGaWVsZCxcbiAgICBQZXBDaGVja2JveEZpZWxkLFxuICAgIFBlcFNlcGFyYXRvckZpZWxkLFxuICAgIFBlcFBsYWNlaG9sZGVyRmllbGQsXG4gICAgUGVwSG9yaXpvbnRhbEFsaWdubWVudCxcbiAgICBQZXBWZXJ0aWNhbEFsaWdubWVudCxcbiAgICBYX0FMSUdOTUVOVF9UWVBFLFxuICAgIFlfQUxJR05NRU5UX1RZUEUsXG4gICAgREVGQVVMVF9WRVJUSUNBTF9BTElHTk1FTlQsXG4gICAgREVGQVVMVF9IT1JJWk9OVEFMX0FMSUdOTUVOVCxcbiAgICBLZXlWYWx1ZVBhaXIsXG4gICAgSVBlcE9wdGlvbixcbn0gZnJvbSAnQHBlcHBlcmktYWRkb25zL25neC1saWInO1xuXG5leHBvcnQgaW50ZXJmYWNlIElQZXBGb3JtRmllbGRWYWx1ZUNoYW5nZUV2ZW50IHtcbiAgICBpZDogc3RyaW5nO1xuICAgIGtleTogc3RyaW5nO1xuICAgIHZhbHVlOiBzdHJpbmc7XG4gICAgY29udHJvbFR5cGU/OiBzdHJpbmc7XG59XG5leHBvcnQgaW50ZXJmYWNlIElQZXBGb3JtRmllbGRDbGlja0V2ZW50IHtcbiAgICBpZDogc3RyaW5nO1xuICAgIGtleTogc3RyaW5nO1xuICAgIHZhbHVlOiBhbnk7XG4gICAgY29udHJvbFR5cGU6IHN0cmluZztcbiAgICBmaWVsZFR5cGU/OiBGSUVMRF9UWVBFO1xuICAgIGlkVHlwZT86IHN0cmluZztcbiAgICB3aGljaD86IGFueTtcbiAgICBlZGl0YWJsZT86IGJvb2xlYW47XG4gICAgb3RoZXJEYXRhPzogYW55O1xufVxuXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogJ3BlcC1mb3JtJyxcbiAgICB0ZW1wbGF0ZVVybDogJy4vZm9ybS5jb21wb25lbnQuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJy4vZm9ybS5jb21wb25lbnQuc2NzcyddLFxuICAgIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxufSlcbmV4cG9ydCBjbGFzcyBQZXBGb3JtQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBEb0NoZWNrLCBPbkNoYW5nZXMsIE9uRGVzdHJveSB7XG4gICAgQElucHV0KCkgaXNSZXBvcnQgPSBmYWxzZTtcbiAgICBASW5wdXQoKSBsYXlvdXQ6IFVJQ29udHJvbDtcbiAgICBASW5wdXQoKSBsb2NrRXZlbnRzID0gZmFsc2U7XG4gICAgQElucHV0KCkgY2FuRWRpdE9iamVjdCA9IHRydWU7XG5cbiAgICBwcml2YXRlIF9kYXRhOiBPYmplY3RzRGF0YVJvdyA9IG51bGw7XG4gICAgQElucHV0KClcbiAgICBzZXQgZGF0YSh2YWx1ZTogT2JqZWN0c0RhdGFSb3cpIHtcbiAgICAgICAgY29uc3Qgc2hvdWxkUmVsb2FkID0gdGhpcy5zaG91bGRSZWxvYWRGb3JtIHx8ICF0aGlzLl9kYXRhO1xuICAgICAgICB0aGlzLl9kYXRhID0gdmFsdWU7XG5cbiAgICAgICAgaWYgKHNob3VsZFJlbG9hZCkge1xuICAgICAgICAgICAgdGhpcy5fc2hvdWxkUmVsb2FkRm9ybSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5pbml0Rm9ybSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVGb3JtKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgZGF0YSgpOiBPYmplY3RzRGF0YVJvdyB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kYXRhO1xuICAgIH1cblxuICAgIEBJbnB1dCgpIGlzQWN0aXZlID0gZmFsc2U7XG4gICAgQElucHV0KCkgbGF5b3V0VHlwZTogUGVwTGF5b3V0VHlwZSA9ICdjYXJkJztcbiAgICAvLyBASW5wdXQoKSBsaXN0VHlwZSA9ICcnO1xuICAgIEBJbnB1dCgpIG9iamVjdElkID0gJzAnO1xuICAgIEBJbnB1dCgpIHBhcmVudElkID0gJzAnO1xuICAgIEBJbnB1dCgpIHNlYXJjaENvZGUgPSAnMCc7XG4gICAgQElucHV0KCkgc2hvd1RpdGxlID0gdHJ1ZTtcbiAgICBASW5wdXQoKSBmaXJzdEZpZWxkQXNMaW5rID0gZmFsc2U7XG4gICAgQElucHV0KCkgY2hlY2tGb3JDaGFuZ2VzOiBhbnkgPSBudWxsO1xuXG4gICAgQE91dHB1dCgpXG4gICAgdmFsdWVDaGFuZ2U6IEV2ZW50RW1pdHRlcjxJUGVwRm9ybUZpZWxkVmFsdWVDaGFuZ2VFdmVudD4gPSBuZXcgRXZlbnRFbWl0dGVyPElQZXBGb3JtRmllbGRWYWx1ZUNoYW5nZUV2ZW50PigpO1xuICAgIEBPdXRwdXQoKVxuICAgIGZvcm1WYWxpZGF0aW9uQ2hhbmdlOiBFdmVudEVtaXR0ZXI8Ym9vbGVhbj4gPSBuZXcgRXZlbnRFbWl0dGVyPGJvb2xlYW4+KCk7XG4gICAgQE91dHB1dCgpIGNoaWxkQ2xpY2s6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG4gICAgQE91dHB1dCgpIGNoaWxkQ2hhbmdlOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuICAgIEBPdXRwdXQoKVxuICAgIGZpZWxkQ2xpY2s6IEV2ZW50RW1pdHRlcjxJUGVwRm9ybUZpZWxkQ2xpY2tFdmVudD4gPSBuZXcgRXZlbnRFbWl0dGVyPElQZXBGb3JtRmllbGRDbGlja0V2ZW50PigpO1xuXG4gICAgaXNMb2NrZWQgPSBmYWxzZTtcbiAgICBmb3JtR3V0dGVyU2l6ZTtcbiAgICBjYXJkR3V0dGVyU2l6ZTtcbiAgICByb3dIZWlnaHQ7XG4gICAgLy8gcHJpdmF0ZSBtYXRyaXhJc0xhc3QgPSBmYWxzZTtcbiAgICAvLyBsYXN0VXBkYXRlZEZpZWxkQXBpTmFtZTogc3RyaW5nID0gJyc7XG4gICAgZm9ybTogRm9ybUdyb3VwO1xuICAgIGRpZmZlcjogYW55O1xuXG4gICAgLy8gcGF5TG9hZCA9ICcnO1xuICAgIHByaXZhdGUgcm93czogQXJyYXk8UGVwRmllbGRCYXNlW10+ID0gW107XG4gICAgZmllbGRzOiBQZXBGaWVsZEJhc2VbXSA9IFtdO1xuICAgIGNvbHVtbnMgPSAxO1xuXG4gICAgcHJpdmF0ZSBoYXNNZW51RmxvYXRpbmdPbk90aGVyRmllbGQgPSBmYWxzZTtcbiAgICBwcml2YXRlIG1lbnVGaWVsZDogYW55O1xuICAgIHByaXZhdGUgbWVudURhdGFGaWVsZDogYW55O1xuICAgIHByaXZhdGUgaGFzQ2FtcGFpZ25GaWVsZDogYW55O1xuICAgIHByaXZhdGUgaGFzQ2FtcGFpZ25EYXRhRmllbGQ6IGFueTtcbiAgICBwcml2YXRlIGluZGljYXRvcnNGaWVsZDogYW55O1xuICAgIHByaXZhdGUgaW5kaWNhdG9yc0RhdGFGaWVsZDogYW55ID0gbnVsbDtcblxuICAgIHByaXZhdGUgX3Nob3VsZFJlbG9hZEZvcm0gPSBmYWxzZTtcbiAgICBnZXQgc2hvdWxkUmVsb2FkRm9ybSgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Nob3VsZFJlbG9hZEZvcm07XG4gICAgfVxuXG4gICAgLy8gZXZlbnRTZXJ2aWNlU3ViOiBTdWJzY3JpcHRpb247XG4gICAgLy8gcHVibGljIGpzb25MaWIgPSBKU09OO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgZGlhbG9nU2VydmljZTogUGVwRGlhbG9nU2VydmljZSxcbiAgICAgICAgcHJpdmF0ZSBjdXN0b21pemF0aW9uU2VydmljZTogUGVwQ3VzdG9taXphdGlvblNlcnZpY2UsXG4gICAgICAgIHByaXZhdGUgbGF5b3V0U2VydmljZTogUGVwTGF5b3V0U2VydmljZSxcbiAgICAgICAgcHJpdmF0ZSBmYjogRm9ybUJ1aWxkZXIsXG4gICAgICAgIGRpZmZlcnM6IEtleVZhbHVlRGlmZmVycyxcbiAgICAgICAgcHJpdmF0ZSB0cmFuc2xhdGU6IFRyYW5zbGF0ZVNlcnZpY2VcbiAgICApIHtcbiAgICAgICAgLy8gc3RvcmUgdGhlIGluaXRpYWwgdmFsdWUgdG8gY29tcGFyZSB3aXRoXG4gICAgICAgIHRoaXMuZGlmZmVyID0gZGlmZmVycy5maW5kKHt9KS5jcmVhdGUoKTtcbiAgICB9XG5cbiAgICBjb252ZXJ0WEFsaWduVG9Ib3Jpem9udGFsQWxpZ24oXG4gICAgICAgIHhBbGlnbjogWF9BTElHTk1FTlRfVFlQRVxuICAgICk6IFBlcEhvcml6b250YWxBbGlnbm1lbnQge1xuICAgICAgICBsZXQgcmVzID0gREVGQVVMVF9IT1JJWk9OVEFMX0FMSUdOTUVOVDtcblxuICAgICAgICBpZiAoXG4gICAgICAgICAgICB4QWxpZ24gPT09IFhfQUxJR05NRU5UX1RZUEUuTm9uZSB8fFxuICAgICAgICAgICAgeEFsaWduID09PSBYX0FMSUdOTUVOVF9UWVBFLkxlZnRcbiAgICAgICAgKSB7XG4gICAgICAgICAgICByZXMgPSAnbGVmdCc7XG4gICAgICAgIH0gZWxzZSBpZiAoeEFsaWduID09PSBYX0FMSUdOTUVOVF9UWVBFLlJpZ2h0KSB7XG4gICAgICAgICAgICByZXMgPSAncmlnaHQnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzID0gJ2NlbnRlcic7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cblxuICAgIGNvbnZlcnRZQWxpZ25Ub1ZlcnRpY2FsQWxpZ24oXG4gICAgICAgIHlBbGlnbjogWV9BTElHTk1FTlRfVFlQRVxuICAgICk6IFBlcFZlcnRpY2FsQWxpZ25tZW50IHtcbiAgICAgICAgbGV0IHJlcyA9IERFRkFVTFRfVkVSVElDQUxfQUxJR05NRU5UO1xuXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIHlBbGlnbiA9PT0gWV9BTElHTk1FTlRfVFlQRS5Ob25lIHx8XG4gICAgICAgICAgICB5QWxpZ24gPT09IFlfQUxJR05NRU5UX1RZUEUuVG9wXG4gICAgICAgICkge1xuICAgICAgICAgICAgcmVzID0gJ3RvcCc7XG4gICAgICAgIH0gZWxzZSBpZiAoeUFsaWduID09PSBZX0FMSUdOTUVOVF9UWVBFLkJvdHRvbSkge1xuICAgICAgICAgICAgcmVzID0gJ2JvdHRvbSc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXMgPSAnbWlkZGxlJztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxuXG4gICAgY29udmVydE9wdGlvbmFsVmFsdWVzKFxuICAgICAgICBvcHRpb25hbFZhbHVlczogQXJyYXk8S2V5VmFsdWVQYWlyPHN0cmluZz4+XG4gICAgKTogSVBlcE9wdGlvbltdIHtcbiAgICAgICAgaWYgKG9wdGlvbmFsVmFsdWVzICYmIG9wdGlvbmFsVmFsdWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHJldHVybiBvcHRpb25hbFZhbHVlcy5tYXAoKG92KSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsga2V5OiBvdi5LZXksIHZhbHVlOiBvdi5WYWx1ZSB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb252ZXJ0QWRkcmVzc0ZpZWxkcyhcbiAgICAgICAgY29udHJvbEZpZWxkOiBVSUNvbnRyb2xGaWVsZCxcbiAgICAgICAgYWRkcmVzc0ZpZWxkczogQXJyYXk8T2JqZWN0c0RhdGFSb3dDZWxsPixcbiAgICAgICAgY2FuRWRpdE9iamVjdDogYm9vbGVhblxuICAgICk6IFBlcEZpZWxkQmFzZVtdIHtcbiAgICAgICAgY29uc3QgZmllbGRzOiBQZXBGaWVsZEJhc2VbXSA9IFtdO1xuXG4gICAgICAgIGFkZHJlc3NGaWVsZHMuZm9yRWFjaCgoZmllbGQpID0+IHtcbiAgICAgICAgICAgIGxldCBjdXN0b21GaWVsZDogUGVwRmllbGRCYXNlO1xuICAgICAgICAgICAgY29uc3QgcGxhY2Vob2xkZXIgPSBmaWVsZC5BcGlOYW1lO1xuXG4gICAgICAgICAgICBpZiAoZmllbGQuQXBpTmFtZS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJ3N0cmVldCcpID49IDApIHtcbiAgICAgICAgICAgICAgICBjdXN0b21GaWVsZCA9IG5ldyBQZXBUZXh0Ym94RmllbGQoe1xuICAgICAgICAgICAgICAgICAgICBrZXk6IGZpZWxkLkFwaU5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiBmaWVsZC5BcGlOYW1lLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCcsXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyLFxuICAgICAgICAgICAgICAgICAgICByZWFkb25seTogIWNhbkVkaXRPYmplY3QsXG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkOiAhZmllbGQuRW5hYmxlZCB8fCAhY2FuRWRpdE9iamVjdCxcbiAgICAgICAgICAgICAgICAgICAgaGlkZGVuOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgbWFuZGF0b3J5OiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGZpZWxkLlZhbHVlLFxuICAgICAgICAgICAgICAgICAgICBmb3JtYXR0ZWRWYWx1ZTogZmllbGQuRm9ybWF0dGVkVmFsdWUsXG4gICAgICAgICAgICAgICAgICAgIHJvdzogMCxcbiAgICAgICAgICAgICAgICAgICAgcm93U3BhbjogMSxcbiAgICAgICAgICAgICAgICAgICAgY29sOiAwLFxuICAgICAgICAgICAgICAgICAgICBjb2xTcGFuOiAyLFxuICAgICAgICAgICAgICAgICAgICB4QWxpZ25tZW50OiB0aGlzLmNvbnZlcnRYQWxpZ25Ub0hvcml6b250YWxBbGlnbihcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xGaWVsZC5MYXlvdXQuWEFsaWdubWVudFxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICB5QWxpZ25tZW50OiB0aGlzLmNvbnZlcnRZQWxpZ25Ub1ZlcnRpY2FsQWxpZ24oXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sRmllbGQuTGF5b3V0LllBbGlnbm1lbnRcbiAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgb3JkZXI6IDAsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGZpZWxkLkFwaU5hbWUudG9Mb3dlckNhc2UoKS5pbmRleE9mKCdjaXR5JykgPj0gMCkge1xuICAgICAgICAgICAgICAgIGN1c3RvbUZpZWxkID0gbmV3IFBlcFRleHRib3hGaWVsZCh7XG4gICAgICAgICAgICAgICAgICAgIGtleTogZmllbGQuQXBpTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6IGZpZWxkLkFwaU5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXIsXG4gICAgICAgICAgICAgICAgICAgIHJlYWRvbmx5OiAhY2FuRWRpdE9iamVjdCxcbiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6ICFmaWVsZC5FbmFibGVkIHx8ICFjYW5FZGl0T2JqZWN0LFxuICAgICAgICAgICAgICAgICAgICBoaWRkZW46IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBtYW5kYXRvcnk6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZmllbGQuVmFsdWUsXG4gICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlZFZhbHVlOiBmaWVsZC5Gb3JtYXR0ZWRWYWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgcm93OiAwLFxuICAgICAgICAgICAgICAgICAgICByb3dTcGFuOiAxLFxuICAgICAgICAgICAgICAgICAgICBjb2w6IDIsXG4gICAgICAgICAgICAgICAgICAgIGNvbFNwYW46IDEsXG4gICAgICAgICAgICAgICAgICAgIHhBbGlnbm1lbnQ6IHRoaXMuY29udmVydFhBbGlnblRvSG9yaXpvbnRhbEFsaWduKFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbEZpZWxkLkxheW91dC5YQWxpZ25tZW50XG4gICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgIHlBbGlnbm1lbnQ6IHRoaXMuY29udmVydFlBbGlnblRvVmVydGljYWxBbGlnbihcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xGaWVsZC5MYXlvdXQuWUFsaWdubWVudFxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICBvcmRlcjogMSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZmllbGQuQXBpTmFtZS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJ3N0YXRlJykgPj0gMCkge1xuICAgICAgICAgICAgICAgIGN1c3RvbUZpZWxkID0gbmV3IFBlcFNlbGVjdEZpZWxkKHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiBmaWVsZC5BcGlOYW1lLFxuICAgICAgICAgICAgICAgICAgICBsYWJlbDogZmllbGQuQXBpTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXIsXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IHRoaXMuY29udmVydE9wdGlvbmFsVmFsdWVzKGZpZWxkLk9wdGlvbmFsVmFsdWVzKSxcbiAgICAgICAgICAgICAgICAgICAgcmVhZG9ubHk6ICFjYW5FZGl0T2JqZWN0LFxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZDogIWZpZWxkLkVuYWJsZWQgfHwgIWNhbkVkaXRPYmplY3QsXG4gICAgICAgICAgICAgICAgICAgIGhpZGRlbjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIG1hbmRhdG9yeTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBmaWVsZC5WYWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgZm9ybWF0dGVkVmFsdWU6IGZpZWxkLkZvcm1hdHRlZFZhbHVlLFxuICAgICAgICAgICAgICAgICAgICByb3c6IDEsXG4gICAgICAgICAgICAgICAgICAgIHJvd1NwYW46IDEsXG4gICAgICAgICAgICAgICAgICAgIGNvbDogMCxcbiAgICAgICAgICAgICAgICAgICAgY29sU3BhbjogMSxcbiAgICAgICAgICAgICAgICAgICAgeEFsaWdubWVudDogdGhpcy5jb252ZXJ0WEFsaWduVG9Ib3Jpem9udGFsQWxpZ24oXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sRmllbGQuTGF5b3V0LlhBbGlnbm1lbnRcbiAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgeUFsaWdubWVudDogdGhpcy5jb252ZXJ0WUFsaWduVG9WZXJ0aWNhbEFsaWduKFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbEZpZWxkLkxheW91dC5ZQWxpZ25tZW50XG4gICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgIG9yZGVyOiAyLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChmaWVsZC5BcGlOYW1lLnRvTG93ZXJDYXNlKCkuaW5kZXhPZignemlwY29kZScpID49IDApIHtcbiAgICAgICAgICAgICAgICBjdXN0b21GaWVsZCA9IG5ldyBQZXBUZXh0Ym94RmllbGQoe1xuICAgICAgICAgICAgICAgICAgICBrZXk6IGZpZWxkLkFwaU5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiBmaWVsZC5BcGlOYW1lLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCcsXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyLFxuICAgICAgICAgICAgICAgICAgICByZWFkb25seTogIWNhbkVkaXRPYmplY3QsXG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkOiAhZmllbGQuRW5hYmxlZCB8fCAhY2FuRWRpdE9iamVjdCxcbiAgICAgICAgICAgICAgICAgICAgaGlkZGVuOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgbWFuZGF0b3J5OiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGZpZWxkLlZhbHVlLFxuICAgICAgICAgICAgICAgICAgICBmb3JtYXR0ZWRWYWx1ZTogZmllbGQuRm9ybWF0dGVkVmFsdWUsXG4gICAgICAgICAgICAgICAgICAgIHJvdzogMSxcbiAgICAgICAgICAgICAgICAgICAgcm93U3BhbjogMSxcbiAgICAgICAgICAgICAgICAgICAgY29sOiAxLFxuICAgICAgICAgICAgICAgICAgICBjb2xTcGFuOiAxLFxuICAgICAgICAgICAgICAgICAgICB4QWxpZ25tZW50OiB0aGlzLmNvbnZlcnRYQWxpZ25Ub0hvcml6b250YWxBbGlnbihcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xGaWVsZC5MYXlvdXQuWEFsaWdubWVudFxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICB5QWxpZ25tZW50OiB0aGlzLmNvbnZlcnRZQWxpZ25Ub1ZlcnRpY2FsQWxpZ24oXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sRmllbGQuTGF5b3V0LllBbGlnbm1lbnRcbiAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgb3JkZXI6IDMsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGZpZWxkLkFwaU5hbWUudG9Mb3dlckNhc2UoKS5pbmRleE9mKCdjb3VudHJ5JykgPj0gMCkge1xuICAgICAgICAgICAgICAgIGN1c3RvbUZpZWxkID0gbmV3IFBlcFNlbGVjdEZpZWxkKHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiBmaWVsZC5BcGlOYW1lLFxuICAgICAgICAgICAgICAgICAgICBsYWJlbDogZmllbGQuQXBpTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXIsXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IHRoaXMuY29udmVydE9wdGlvbmFsVmFsdWVzKGZpZWxkLk9wdGlvbmFsVmFsdWVzKSxcbiAgICAgICAgICAgICAgICAgICAgcmVhZG9ubHk6ICFjYW5FZGl0T2JqZWN0LFxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZDogIWZpZWxkLkVuYWJsZWQgfHwgIWNhbkVkaXRPYmplY3QsXG4gICAgICAgICAgICAgICAgICAgIGhpZGRlbjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIG1hbmRhdG9yeTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBmaWVsZC5WYWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgZm9ybWF0dGVkVmFsdWU6IGZpZWxkLkZvcm1hdHRlZFZhbHVlLFxuICAgICAgICAgICAgICAgICAgICByb3c6IDIsXG4gICAgICAgICAgICAgICAgICAgIHJvd1NwYW46IDEsXG4gICAgICAgICAgICAgICAgICAgIGNvbDogMixcbiAgICAgICAgICAgICAgICAgICAgY29sU3BhbjogMSxcbiAgICAgICAgICAgICAgICAgICAgeEFsaWdubWVudDogdGhpcy5jb252ZXJ0WEFsaWduVG9Ib3Jpem9udGFsQWxpZ24oXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sRmllbGQuTGF5b3V0LlhBbGlnbm1lbnRcbiAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgeUFsaWdubWVudDogdGhpcy5jb252ZXJ0WUFsaWduVG9WZXJ0aWNhbEFsaWduKFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbEZpZWxkLkxheW91dC5ZQWxpZ25tZW50XG4gICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgIG9yZGVyOiA0LFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmaWVsZHMucHVzaChjdXN0b21GaWVsZCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBmaWVsZHMuc29ydCgobjEsIG4yKSA9PlxuICAgICAgICAgICAgbjEub3JkZXIgPiBuMi5vcmRlciA/IDEgOiBuMS5vcmRlciA8IG4yLm9yZGVyID8gLTEgOiAwXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgaXNNYXRyaXhGaWVsZChhcGlOYW1lVG9DaGVjazogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBhcGlOYW1lVG9DaGVjay5pbmRleE9mKCdNYXRyaXgnKSA+PSAwO1xuICAgIH1cblxuICAgIGRvZXNGaWVsZEhhdmFGbG9hdGluZ0ZpZWxkKFxuICAgICAgICBjb250cm9sRmllbGQ6IFVJQ29udHJvbEZpZWxkLFxuICAgICAgICBmbG9hdGluZ0ZpZWxkOiBhbnlcbiAgICApOiBib29sZWFuIHtcbiAgICAgICAgbGV0IGhhc0Zsb2F0aW5nRmllbGQgPSBmYWxzZTtcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgZmxvYXRpbmdGaWVsZC5MYXlvdXQuWSA+PSBjb250cm9sRmllbGQuTGF5b3V0LlkgJiZcbiAgICAgICAgICAgIGZsb2F0aW5nRmllbGQuTGF5b3V0LlkgPFxuICAgICAgICAgICAgY29udHJvbEZpZWxkLkxheW91dC5ZICsgY29udHJvbEZpZWxkLkxheW91dC5IZWlnaHQgJiZcbiAgICAgICAgICAgIGZsb2F0aW5nRmllbGQuTGF5b3V0LlggPj0gY29udHJvbEZpZWxkLkxheW91dC5YICYmXG4gICAgICAgICAgICBmbG9hdGluZ0ZpZWxkLkxheW91dC5YIDxcbiAgICAgICAgICAgIGNvbnRyb2xGaWVsZC5MYXlvdXQuWCArIGNvbnRyb2xGaWVsZC5MYXlvdXQuV2lkdGhcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBoYXNGbG9hdGluZ0ZpZWxkID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBoYXNGbG9hdGluZ0ZpZWxkO1xuICAgIH1cblxuICAgIGdldE9wdGlvbnNGb3JDdXN0b21GaWVsZChcbiAgICAgICAgY29udHJvbEZpZWxkOiBVSUNvbnRyb2xGaWVsZCxcbiAgICAgICAgZGF0YUZpZWxkOiBhbnksXG4gICAgICAgIGNhbkVkaXRPYmplY3Q6IGJvb2xlYW5cbiAgICApOiBhbnkge1xuICAgICAgICBpZiAoIWNvbnRyb2xGaWVsZCB8fCAhZGF0YUZpZWxkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBwbGFjZWhvbGRlciA9XG4gICAgICAgICAgICBjb250cm9sRmllbGQuUmVhZE9ubHkgfHwgIWNhbkVkaXRPYmplY3QgPyAnJyA6IGNvbnRyb2xGaWVsZC5UaXRsZTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAga2V5OiBjb250cm9sRmllbGQuQXBpTmFtZSxcbiAgICAgICAgICAgIGxhYmVsOiBjb250cm9sRmllbGQuVGl0bGUsXG4gICAgICAgICAgICBhY2Nlc3Nvcnk6IGRhdGFGaWVsZC5BY2Nlc3NvcnksXG4gICAgICAgICAgICBwbGFjZWhvbGRlcixcbiAgICAgICAgICAgIHJlYWRvbmx5OiBjb250cm9sRmllbGQuUmVhZE9ubHkgfHwgIWNhbkVkaXRPYmplY3QsXG4gICAgICAgICAgICBkaXNhYmxlZDogIWRhdGFGaWVsZC5FbmFibGVkIHx8ICFjYW5FZGl0T2JqZWN0LFxuICAgICAgICAgICAgaGlkZGVuOiBjb250cm9sRmllbGQuSGlkZGVuLFxuICAgICAgICAgICAgbWFuZGF0b3J5OiBjb250cm9sRmllbGQuTWFuZGF0b3J5LFxuICAgICAgICAgICAgdmFsdWU6IGRhdGFGaWVsZC5WYWx1ZSxcbiAgICAgICAgICAgIGZvcm1hdHRlZFZhbHVlOiBkYXRhRmllbGQuRm9ybWF0dGVkVmFsdWUsXG4gICAgICAgICAgICBhZGRpdGlvbmFsVmFsdWU6IGRhdGFGaWVsZC5BZGRpdGlvbmFsVmFsdWUsXG4gICAgICAgICAgICByb3c6IGNvbnRyb2xGaWVsZC5MYXlvdXQuWSxcbiAgICAgICAgICAgIHJvd1NwYW46IGNvbnRyb2xGaWVsZC5MYXlvdXQuSGVpZ2h0LFxuICAgICAgICAgICAgY29sOiBjb250cm9sRmllbGQuTGF5b3V0LlgsXG4gICAgICAgICAgICBjb2xTcGFuOiBjb250cm9sRmllbGQuTGF5b3V0LldpZHRoLFxuICAgICAgICAgICAgeEFsaWdubWVudDogdGhpcy5jb252ZXJ0WEFsaWduVG9Ib3Jpem9udGFsQWxpZ24oXG4gICAgICAgICAgICAgICAgY29udHJvbEZpZWxkLkxheW91dC5YQWxpZ25tZW50XG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgeUFsaWdubWVudDogdGhpcy5jb252ZXJ0WUFsaWduVG9WZXJ0aWNhbEFsaWduKFxuICAgICAgICAgICAgICAgIGNvbnRyb2xGaWVsZC5MYXlvdXQuWUFsaWdubWVudFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIG9wdGlvbnM6IHRoaXMuY29udmVydE9wdGlvbmFsVmFsdWVzKGRhdGFGaWVsZC5PcHRpb25hbFZhbHVlcyksXG4gICAgICAgICAgICBncm91cEZpZWxkczogdW5kZWZpbmVkLFxuICAgICAgICAgICAgbWF4RmllbGRDaGFyYWN0ZXJzOiBjb250cm9sRmllbGQuTWF4RmllbGRDaGFyYWN0ZXJzLFxuICAgICAgICAgICAgbWluVmFsdWU6IGNvbnRyb2xGaWVsZC5NaW5WYWx1ZSxcbiAgICAgICAgICAgIG1heFZhbHVlOiBjb250cm9sRmllbGQuTWF4VmFsdWUsXG4gICAgICAgICAgICAvLyBoYXNNZW51OiBoYXNNZW51LFxuICAgICAgICAgICAgLy8gaGFzQ2FtcGFpZ246IGhhc0NhbXBhaWduLFxuICAgICAgICAgICAgLy8gaGFzSW5kaWNhdG9yczogaGFzSW5kaWNhdG9ycyxcbiAgICAgICAgICAgIHRleHRDb2xvcjogZGF0YUZpZWxkLlRleHRDb2xvcixcbiAgICAgICAgICAgIHZpc2libGU6IGRhdGFGaWVsZC5WaXNpYmxlLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGNvbnZlcnRUb0N1c3RvbUZpZWxkKFxuICAgICAgICBjb250cm9sRmllbGQ6IFVJQ29udHJvbEZpZWxkLFxuICAgICAgICBkYXRhRmllbGQ6IGFueSxcbiAgICAgICAgY2FuRWRpdE9iamVjdDogYm9vbGVhbixcbiAgICAgICAgbWVudUZpZWxkOiBhbnksXG4gICAgICAgIGhhc0NhbXBhaWduRmllbGQ6IGFueSxcbiAgICAgICAgaW5kaWNhdG9yc0ZpZWxkOiBhbnksXG4gICAgICAgIG9iamVjdElkOiBhbnksXG4gICAgICAgIHBhcmVudElkOiBhbnksXG4gICAgICAgIHNlYXJjaENvZGU6IGFueVxuICAgICk6IFBlcEZpZWxkQmFzZSB7XG4gICAgICAgIGxldCBjdXN0b21GaWVsZDogUGVwRmllbGRCYXNlO1xuICAgICAgICBjb25zdCBvcHRpb25zID0gdGhpcy5nZXRPcHRpb25zRm9yQ3VzdG9tRmllbGQoXG4gICAgICAgICAgICBjb250cm9sRmllbGQsXG4gICAgICAgICAgICBkYXRhRmllbGQsXG4gICAgICAgICAgICBjYW5FZGl0T2JqZWN0XG4gICAgICAgICk7XG5cbiAgICAgICAgaWYgKGNvbnRyb2xGaWVsZC5BcGlOYW1lID09PSAnT2JqZWN0TWVudScpIHtcbiAgICAgICAgICAgIG9wdGlvbnMudHlwZSA9ICdtZW51JztcbiAgICAgICAgICAgIGN1c3RvbUZpZWxkID0gbmV3IFBlcEludGVybmFsTWVudUZpZWxkKG9wdGlvbnMpO1xuICAgICAgICB9IGVsc2UgaWYgKFxuICAgICAgICAgICAgY29udHJvbEZpZWxkLkZpZWxkVHlwZSA9PT0gRklFTERfVFlQRS5OdW1iZXJSZWFsUXVhbnRpdHlTZWxlY3RvciB8fFxuICAgICAgICAgICAgY29udHJvbEZpZWxkLkZpZWxkVHlwZSA9PT1cbiAgICAgICAgICAgIEZJRUxEX1RZUEUuTnVtYmVySW50ZWdlclF1YW50aXR5U2VsZWN0b3IgfHxcbiAgICAgICAgICAgIGNvbnRyb2xGaWVsZC5BcGlOYW1lID09PSAnUXVhbnRpdHlTZWxlY3RvcicgfHxcbiAgICAgICAgICAgIGNvbnRyb2xGaWVsZC5BcGlOYW1lID09PSAnVW5pdHNRdWFudGl0eScgfHxcbiAgICAgICAgICAgIGNvbnRyb2xGaWVsZC5BcGlOYW1lLmluZGV4T2YoJ3NpemVfJykgPT09IDBcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBpZiAoZGF0YUZpZWxkLkZpZWxkVHlwZSA9PT0gRklFTERfVFlQRS5JbnRlcm5hbExpbmspIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLnR5cGUgPSAnYnV0dG9uJztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YUZpZWxkLkZpZWxkVHlwZSA9PT0gRklFTERfVFlQRS5QYWNrYWdlKSB7XG4gICAgICAgICAgICAgICAgb3B0aW9ucy50eXBlID0gJ3BhY2thZ2VCdXR0b24nO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgICAgICAgICBkYXRhRmllbGQuRmllbGRUeXBlID09PSBGSUVMRF9UWVBFLk51bWJlclJlYWxRdWFudGl0eVNlbGVjdG9yIHx8XG4gICAgICAgICAgICAgICAgZGF0YUZpZWxkLkZpZWxkVHlwZSA9PT0gRklFTERfVFlQRS5OdW1iZXJSZWFsXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLnR5cGUgPSAncXMnO1xuICAgICAgICAgICAgICAgIG9wdGlvbnMuYWxsb3dEZWNpbWFsID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgICAgICAgICAgZGF0YUZpZWxkLkZpZWxkVHlwZSA9PT1cbiAgICAgICAgICAgICAgICBGSUVMRF9UWVBFLk51bWJlckludGVnZXJRdWFudGl0eVNlbGVjdG9yIHx8XG4gICAgICAgICAgICAgICAgZGF0YUZpZWxkLkZpZWxkVHlwZSA9PT0gRklFTERfVFlQRS5OdW1iZXJJbnRlZ2VyXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLnR5cGUgPSAncXMnO1xuICAgICAgICAgICAgICAgIG9wdGlvbnMuYWxsb3dEZWNpbWFsID0gZmFsc2U7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKFxuICAgICAgICAgICAgICAgIGRhdGFGaWVsZC5GaWVsZFR5cGUgPT09IEZJRUxEX1RZUEUuTnVtYmVySW50ZWdlckZvck1hdHJpeFxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgb3B0aW9ucy50eXBlID0gJ3FzRm9yTWF0cml4JztcbiAgICAgICAgICAgICAgICBvcHRpb25zLmFsbG93RGVjaW1hbCA9IGZhbHNlO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhRmllbGQuRmllbGRUeXBlID09PSBGSUVMRF9UWVBFLk51bWJlclJlYWxGb3JNYXRyaXgpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLnR5cGUgPSAncXNGb3JNYXRyaXgnO1xuICAgICAgICAgICAgICAgIG9wdGlvbnMuYWxsb3dEZWNpbWFsID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgb3B0aW9ucy5ub3RpZmljYXRpb25JbmZvID0gZGF0YUZpZWxkLk5vdGlmaWNhdGlvbkluZm87XG4gICAgICAgICAgICBjdXN0b21GaWVsZCA9IG5ldyBQZXBRdWFudGl0eVNlbGVjdG9yRmllbGQob3B0aW9ucyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBIQUNLOiBuZWVkIHRvIHJlbW92ZSB0aGlzLi5cbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBkYXRhRmllbGQuRmllbGRUeXBlID09PSBGSUVMRF9UWVBFLkluZGljYXRvcnMgJiZcbiAgICAgICAgICAgICAgICB0aGlzLmlzTWF0cml4RmllbGQoZGF0YUZpZWxkLkFwaU5hbWUpXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICBkYXRhRmllbGQuRmllbGRUeXBlID0gRklFTERfVFlQRS5JbnRlcm5hbFBhZ2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHN3aXRjaCAoZGF0YUZpZWxkLkZpZWxkVHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgRklFTERfVFlQRS5BZGRyZXNzOiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhbkVkaXRHcm91cE9iamVjdCA9IGNvbnRyb2xGaWVsZC5SZWFkT25seVxuICAgICAgICAgICAgICAgICAgICAgICAgPyBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgOiBjYW5FZGl0T2JqZWN0O1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmdyb3VwRmllbGRzID0gdGhpcy5jb252ZXJ0QWRkcmVzc0ZpZWxkcyhcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xGaWVsZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFGaWVsZC5Hcm91cEZpZWxkcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbkVkaXRHcm91cE9iamVjdFxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICBjdXN0b21GaWVsZCA9IG5ldyBQZXBBZGRyZXNzRmllbGQob3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlIEZJRUxEX1RZUEUuSW5kaWNhdG9yczoge1xuICAgICAgICAgICAgICAgICAgICAvLyBvcHRpb25zWyd0eXBlJ10gPSAnaW5kaWNhdG9ycyc7IC8vIE5vdCBuZWVkZWQgdGhpcyBpcyBQZXBJbmRpY2F0b3JzRmllbGQuXG4gICAgICAgICAgICAgICAgICAgIGN1c3RvbUZpZWxkID0gbmV3IFBlcEluZGljYXRvcnNGaWVsZChvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgRklFTERfVFlQRS5JbnRlcm5hbFBhZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNNYXRyaXhGaWVsZChjb250cm9sRmllbGQuQXBpTmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMucm93U3BhbiA9IGNvbnRyb2xGaWVsZC5MYXlvdXQuSGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5vYmplY3RJZCA9IG9iamVjdElkO1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5wYXJlbnRJZCA9IHBhcmVudElkO1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5zZWFyY2hDb2RlID0gc2VhcmNoQ29kZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY3VzdG9tRmllbGQgPSBuZXcgUGVwSW50ZXJuYWxQYWdlRmllbGQob3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3Qgc3VwcG9ydGVkXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgRklFTERfVFlQRS5MaW5rOiB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMudHlwZSA9ICdsaW5rJztcbiAgICAgICAgICAgICAgICAgICAgY3VzdG9tRmllbGQgPSBuZXcgUGVwVGV4dGJveEZpZWxkKG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2FzZSBGSUVMRF9UWVBFLkludGVybmFsTGluazpcbiAgICAgICAgICAgICAgICBjYXNlIEZJRUxEX1RZUEUuQnV0dG9uOiB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMudHlwZSA9ICdidXR0b24nO1xuICAgICAgICAgICAgICAgICAgICBjdXN0b21GaWVsZCA9IG5ldyBQZXBJbnRlcm5hbEJ1dHRvbkZpZWxkKG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2FzZSBGSUVMRF9UWVBFLkF0dGFjaG1lbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gb3B0aW9ucy50eXBlID0gJ2F0dGFjaG1lbnQnO1xuICAgICAgICAgICAgICAgICAgICBjdXN0b21GaWVsZCA9IG5ldyBQZXBBdHRhY2htZW50RmllbGQob3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlIEZJRUxEX1RZUEUuU2lnbmF0dXJlOiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG9wdGlvbnMudHlwZSA9ICdzaWduYXR1cmUnO1xuICAgICAgICAgICAgICAgICAgICBjdXN0b21GaWVsZCA9IG5ldyBQZXBTaWduYXR1cmVGaWVsZChvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgRklFTERfVFlQRS5JbWFnZTpcbiAgICAgICAgICAgICAgICBjYXNlIEZJRUxEX1RZUEUuSW1hZ2VVUkw6IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gb3B0aW9ucy50eXBlID0gJ2ltYWdlJztcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5tZW51RmllbGQgPVxuICAgICAgICAgICAgICAgICAgICAgICAgbWVudUZpZWxkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kb2VzRmllbGRIYXZhRmxvYXRpbmdGaWVsZChjb250cm9sRmllbGQsIG1lbnVGaWVsZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IG1lbnVGaWVsZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5oYXNDYW1wYWlnbkZpZWxkID1cbiAgICAgICAgICAgICAgICAgICAgICAgIGhhc0NhbXBhaWduRmllbGQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRvZXNGaWVsZEhhdmFGbG9hdGluZ0ZpZWxkKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sRmllbGQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc0NhbXBhaWduRmllbGRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBoYXNDYW1wYWlnbkZpZWxkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBudWxsO1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmluZGljYXRvcnNGaWVsZCA9XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3JzRmllbGQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRvZXNGaWVsZEhhdmFGbG9hdGluZ0ZpZWxkKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sRmllbGQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGljYXRvcnNGaWVsZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGluZGljYXRvcnNGaWVsZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogbnVsbDtcblxuICAgICAgICAgICAgICAgICAgICBjdXN0b21GaWVsZCA9IG5ldyBQZXBJbWFnZUZpZWxkKG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2FzZSBGSUVMRF9UWVBFLkltYWdlczoge1xuICAgICAgICAgICAgICAgICAgICAvLyBvcHRpb25zLnR5cGUgPSAnaW1hZ2VzJztcbiAgICAgICAgICAgICAgICAgICAgY3VzdG9tRmllbGQgPSBuZXcgUGVwSW1hZ2VzRmllbGQob3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlIEZJRUxEX1RZUEUuRW1haWw6IHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy50eXBlID0gJ2VtYWlsJztcbiAgICAgICAgICAgICAgICAgICAgY3VzdG9tRmllbGQgPSBuZXcgUGVwVGV4dGJveEZpZWxkKG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2FzZSBGSUVMRF9UWVBFLlBob25lOiB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMudHlwZSA9ICdwaG9uZSc7XG4gICAgICAgICAgICAgICAgICAgIGN1c3RvbUZpZWxkID0gbmV3IFBlcFRleHRib3hGaWVsZChvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgRklFTERfVFlQRS5EdXJhdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLnR5cGUgPSAnZHVyYXRpb24nO1xuICAgICAgICAgICAgICAgICAgICBjdXN0b21GaWVsZCA9IG5ldyBQZXBUZXh0Ym94RmllbGQob3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlIEZJRUxEX1RZUEUuRGVmYXVsdDpcbiAgICAgICAgICAgICAgICBjYXNlIEZJRUxEX1RZUEUuVGV4dEJveDpcbiAgICAgICAgICAgICAgICBjYXNlIEZJRUxEX1RZUEUuTGltaXRlZExlbmd0aFRleHRCb3g6XG4gICAgICAgICAgICAgICAgY2FzZSBGSUVMRF9UWVBFLlRleHRIZWFkZXI6XG4gICAgICAgICAgICAgICAgY2FzZSBGSUVMRF9UWVBFLkNhbGN1bGF0ZWRTdHJpbmc6XG4gICAgICAgICAgICAgICAgY2FzZSBGSUVMRF9UWVBFLk1hcERhdGFTdHJpbmc6IHtcbiAgICAgICAgICAgICAgICAgICAgY3VzdG9tRmllbGQgPSBuZXcgUGVwVGV4dGJveEZpZWxkKG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2FzZSBGSUVMRF9UWVBFLlRleHRBcmVhOiB7XG4gICAgICAgICAgICAgICAgICAgIGN1c3RvbUZpZWxkID0gbmV3IFBlcFRleHRhcmVhRmllbGQob3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNhc2UgRklFTERfVFlQRS5SaWNoVGV4dEhUTUw6IHtcbiAgICAgICAgICAgICAgICAgICAgY3VzdG9tRmllbGQgPSBuZXcgUGVwUmljaEh0bWxUZXh0YXJlYUZpZWxkKG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2FzZSBGSUVMRF9UWVBFLkRhdGU6XG4gICAgICAgICAgICAgICAgY2FzZSBGSUVMRF9UWVBFLkxpbWl0ZWREYXRlOlxuICAgICAgICAgICAgICAgIGNhc2UgRklFTERfVFlQRS5DYWxjdWxhdGVkRGF0ZTpcbiAgICAgICAgICAgICAgICBjYXNlIEZJRUxEX1RZUEUuRGF0ZUFuZFRpbWU6IHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy50eXBlID1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFGaWVsZC5GaWVsZFR5cGUgPT09IEZJRUxEX1RZUEUuRGF0ZUFuZFRpbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/ICdkYXRldGltZSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICdkYXRlJztcbiAgICAgICAgICAgICAgICAgICAgY3VzdG9tRmllbGQgPSBuZXcgUGVwRGF0ZUZpZWxkKG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2FzZSBGSUVMRF9UWVBFLk51bWJlckludGVnZXI6XG4gICAgICAgICAgICAgICAgY2FzZSBGSUVMRF9UWVBFLkNhbGN1bGF0ZWRJbnQ6XG4gICAgICAgICAgICAgICAgY2FzZSBGSUVMRF9UWVBFLk1hcERhdGFJbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy50eXBlID0gJ2ludCc7XG4gICAgICAgICAgICAgICAgICAgIGN1c3RvbUZpZWxkID0gbmV3IFBlcFRleHRib3hGaWVsZChvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgRklFTERfVFlQRS5QZXJjZW50YWdlOiB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMudHlwZSA9ICdwZXJjZW50YWdlJztcbiAgICAgICAgICAgICAgICAgICAgY3VzdG9tRmllbGQgPSBuZXcgUGVwVGV4dGJveEZpZWxkKG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2FzZSBGSUVMRF9UWVBFLkN1cnJlbmN5OiB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMudHlwZSA9ICdjdXJyZW5jeSc7XG4gICAgICAgICAgICAgICAgICAgIGN1c3RvbUZpZWxkID0gbmV3IFBlcFRleHRib3hGaWVsZChvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgRklFTERfVFlQRS5OdW1iZXJSZWFsOlxuICAgICAgICAgICAgICAgIGNhc2UgRklFTERfVFlQRS5DYWxjdWxhdGVkUmVhbDpcbiAgICAgICAgICAgICAgICBjYXNlIEZJRUxEX1RZUEUuTWFwRGF0YVJlYWw6XG4gICAgICAgICAgICAgICAgY2FzZSBGSUVMRF9UWVBFLlN1bTpcbiAgICAgICAgICAgICAgICBjYXNlIEZJRUxEX1RZUEUuVG90YWxzOiB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMudHlwZSA9ICdyZWFsJztcbiAgICAgICAgICAgICAgICAgICAgY3VzdG9tRmllbGQgPSBuZXcgUGVwVGV4dGJveEZpZWxkKG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2FzZSBGSUVMRF9UWVBFLkJvb2xlYW46XG4gICAgICAgICAgICAgICAgY2FzZSBGSUVMRF9UWVBFLkNhbGN1bGF0ZWRCb29sOiB7XG4gICAgICAgICAgICAgICAgICAgIGN1c3RvbUZpZWxkID0gbmV3IFBlcENoZWNrYm94RmllbGQob3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlIEZJRUxEX1RZUEUuQm9vbGVhblRleHQ6IHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy50eXBlID0gJ2Jvb2xlYW5UZXh0JztcbiAgICAgICAgICAgICAgICAgICAgY3VzdG9tRmllbGQgPSBuZXcgUGVwQ2hlY2tib3hGaWVsZChvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgRklFTERfVFlQRS5Db21ib0JveDpcbiAgICAgICAgICAgICAgICBjYXNlIEZJRUxEX1RZUEUuRW1wdHlDb21ib0JveDpcbiAgICAgICAgICAgICAgICBjYXNlIEZJRUxEX1RZUEUuTWFwRGF0YURyb3BEb3duOiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG9wdGlvbnMudHlwZSA9ICdzZWxlY3QnO1xuICAgICAgICAgICAgICAgICAgICBjdXN0b21GaWVsZCA9IG5ldyBQZXBTZWxlY3RGaWVsZChvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgRklFTERfVFlQRS5NdWx0aVRpY2tCb3g6XG4gICAgICAgICAgICAgICAgY2FzZSBGSUVMRF9UWVBFLk11bHRpVGlja0JveFRvQ29tYm9Cb3g6XG4gICAgICAgICAgICAgICAgY2FzZSBGSUVMRF9UWVBFLkVtcHR5TXVsdGlUaWNrQm94OiB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMudHlwZSA9ICdtdWx0aSc7XG4gICAgICAgICAgICAgICAgICAgIGN1c3RvbUZpZWxkID0gbmV3IFBlcFNlbGVjdEZpZWxkKG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2FzZSBGSUVMRF9UWVBFLkd1aWRSZWZlcmVuY2VUeXBlOiB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMudHlwZSA9ICdyZWZlcmVuY2UnO1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLnJlZmVyZW5jZU9iamVjdFR5cGUgPSBkYXRhRmllbGQuUmVmZXJlbmNlT2JqZWN0VHlwZTtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5yZWZlcmVuY2VPYmplY3RTdWJUeXBlID1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFGaWVsZC5SZWZlcmVuY2VPYmplY3RTdWJUeXBlO1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLnJlZmVyZW5jZU9iamVjdEludGVybmFsVHlwZSA9XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhRmllbGQuUmVmZXJlbmNlT2JqZWN0SW50ZXJuYWxUeXBlO1xuICAgICAgICAgICAgICAgICAgICBjdXN0b21GaWVsZCA9IG5ldyBQZXBJbnRlcm5hbEJ1dHRvbkZpZWxkKG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2FzZSBGSUVMRF9UWVBFLkxpc3RPZk9iamVjdHM6IHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy50eXBlID0gJ2xpc3RvZm9iamVjdHMnO1xuICAgICAgICAgICAgICAgICAgICBjdXN0b21GaWVsZCA9IG5ldyBQZXBJbnRlcm5hbEJ1dHRvbkZpZWxkKG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2FzZSBGSUVMRF9UWVBFLlNlcGFyYXRvcjoge1xuICAgICAgICAgICAgICAgICAgICBjdXN0b21GaWVsZCA9IG5ldyBQZXBTZXBhcmF0b3JGaWVsZChvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgRklFTERfVFlQRS5JbWFnZXM6IHJldHVybiB0aGF0LmZpZWxkKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGNhc2UgRklFTERfVFlQRS5OdW1iZXJSZWFsUXVhbnRpdHlTZWxlY3RvcjpcbiAgICAgICAgICAgICAgICBjYXNlIEZJRUxEX1RZUEUuTnVtYmVySW50ZWdlclF1YW50aXR5U2VsZWN0b3I6IHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy50eXBlID0gJ3FzJztcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5hbGxvd0RlY2ltYWwgPVxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YUZpZWxkLkZpZWxkVHlwZSA9PT1cbiAgICAgICAgICAgICAgICAgICAgICAgIEZJRUxEX1RZUEUuTnVtYmVyUmVhbFF1YW50aXR5U2VsZWN0b3I7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMubm90aWZpY2F0aW9uSW5mbyA9IGRhdGFGaWVsZC5Ob3RpZmljYXRpb25JbmZvO1xuXG4gICAgICAgICAgICAgICAgICAgIGN1c3RvbUZpZWxkID0gbmV3IFBlcFF1YW50aXR5U2VsZWN0b3JGaWVsZChvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgRklFTERfVFlQRS5QYWNrYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMudHlwZSA9ICdwYWNrYWdlQnV0dG9uJztcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5ub3RpZmljYXRpb25JbmZvID0gZGF0YUZpZWxkLk5vdGlmaWNhdGlvbkluZm87XG5cbiAgICAgICAgICAgICAgICAgICAgY3VzdG9tRmllbGQgPSBuZXcgUGVwUXVhbnRpdHlTZWxlY3RvckZpZWxkKG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWN1c3RvbUZpZWxkKSB7XG4gICAgICAgICAgICBvcHRpb25zLmxhYmVsID0gY29udHJvbEZpZWxkLkFwaU5hbWUgKyAnIGlzIG5vdCBzdXBwb3J0ZWQhISEnO1xuICAgICAgICAgICAgY3VzdG9tRmllbGQgPSBuZXcgUGVwU2VwYXJhdG9yRmllbGQob3B0aW9ucyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY3VzdG9tRmllbGQ7XG4gICAgfVxuXG4gICAgZ2V0RmllbGRGb3JtYXR0ZWRWYWx1ZShmaWVsZDogUGVwRmllbGRCYXNlKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IGZpZWxkRm9ybWF0dGVkVmFsdWUgPSBmaWVsZC5mb3JtYXR0ZWRWYWx1ZTtcblxuICAgICAgICAvLyBGaXggZm9yIHRoZSBjdXN0b20gY2hlY2sgYm94IGNvbXBvbmVudC5cbiAgICAgICAgaWYgKGZpZWxkLmNvbnRyb2xUeXBlID09PSAnY2hlY2tib3gnKSB7XG4gICAgICAgICAgICBmaWVsZEZvcm1hdHRlZFZhbHVlID0gZmllbGRGb3JtYXR0ZWRWYWx1ZSA9PT0gJ3RydWUnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRml4IGZvciB0aGUgY3VzdG9tIGJ1dHRvbiBjb21wb25lbnQuXG4gICAgICAgIGlmIChmaWVsZC5jb250cm9sVHlwZSA9PT0gJ2J1dHRvbicpIHtcbiAgICAgICAgICAgIGZpZWxkRm9ybWF0dGVkVmFsdWUgPVxuICAgICAgICAgICAgICAgIGZpZWxkRm9ybWF0dGVkVmFsdWUgPT09ICcwJyA/ICcnIDogZmllbGRGb3JtYXR0ZWRWYWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmaWVsZEZvcm1hdHRlZFZhbHVlO1xuICAgIH1cblxuICAgIHByaXZhdGUgdG9Db250cm9sR3JvdXAoZmllbGRzOiBQZXBGaWVsZEJhc2VbXSk6IEZvcm1Hcm91cCB7XG4gICAgICAgIGNvbnN0IGdyb3VwID0ge307XG4gICAgICAgIGlmIChmaWVsZHMgJiYgZmllbGRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZpZWxkcy5mb3JFYWNoKChmaWVsZCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChmaWVsZC5ncm91cEZpZWxkcyAmJiBmaWVsZC5ncm91cEZpZWxkcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1Ykdyb3VwID0ge307XG5cbiAgICAgICAgICAgICAgICAgICAgZmllbGQuZ3JvdXBGaWVsZHMuZm9yRWFjaCgoZ3JvdXBGaWVsZCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwRmllbGQubWFuZGF0b3J5ICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIWZpZWxkLnJlYWRvbmx5ICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIWZpZWxkLmRpc2FibGVkXG4gICAgICAgICAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJHcm91cFtncm91cEZpZWxkLmtleV0gPSBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBncm91cEZpZWxkLmZvcm1hdHRlZFZhbHVlIHx8ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGQucmVhZG9ubHkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZC5kaXNhYmxlZCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwRmllbGQuZGlzYWJsZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtWYWxpZGF0b3JzLnJlcXVpcmVkXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJHcm91cFtncm91cEZpZWxkLmtleV0gPSBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBncm91cEZpZWxkLmZvcm1hdHRlZFZhbHVlIHx8ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGQucmVhZG9ubHkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZC5kaXNhYmxlZCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwRmllbGQuZGlzYWJsZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtWYWxpZGF0b3JzLm51bGxWYWxpZGF0b3JdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGdyb3VwW2ZpZWxkLmtleV0gPSB0aGlzLmZiLmdyb3VwKHN1Ykdyb3VwKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWxpZGF0b3JzID0gZmllbGQuZ2V0VmFsaWRhdG9ycygpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZEZvcm1hdHRlZFZhbHVlID0gdGhpcy5nZXRGaWVsZEZvcm1hdHRlZFZhbHVlKFxuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRcbiAgICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgICBncm91cFtmaWVsZC5rZXldID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBmaWVsZEZvcm1hdHRlZFZhbHVlIHx8ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkOiBmaWVsZC5kaXNhYmxlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWxpZGF0b3JzLFxuICAgICAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuZmIuZ3JvdXAoZ3JvdXApO1xuICAgIH1cblxuICAgIHB1YmxpYyBzaG93Rm9ybVZhbGlkYXRpb25NZXNzYWdlKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBmaWVsZHM6IFBlcEZpZWxkQmFzZVtdID0gdGhpcy5maWVsZHM7XG4gICAgICAgIGxldCBlbXB0eU1hbmRhdG9yeUZpZWxkc01zZyA9ICcnO1xuICAgICAgICBsZXQgbm90VmFsaWRGaWVsZHNNc2cgPSAnJztcblxuICAgICAgICAvLyBmb3IgKGxldCBpOiBudW1iZXIgPSAwOyBpIDwgZmllbGRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIC8vICAgICBsZXQgZmllbGQgPSBmaWVsZHNbaV07XG4gICAgICAgIGZvciAoY29uc3QgZmllbGQgb2YgZmllbGRzKSB7XG4gICAgICAgICAgICBjb25zdCBmb3JtQ29udHJvbCA9IHRoaXMuZm9ybSAmJiB0aGlzLmZvcm0uZ2V0KGZpZWxkLmtleSk7XG5cbiAgICAgICAgICAgIGlmIChmb3JtQ29udHJvbCkge1xuICAgICAgICAgICAgICAgIC8vIE1hbmRhdG9yeSBpcyBlbXB0eS5cbiAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgIGZpZWxkLm1hbmRhdG9yeSAmJlxuICAgICAgICAgICAgICAgICAgICBmb3JtQ29udHJvbC52YWx1ZS50b1N0cmluZygpLnRyaW0oKS5sZW5ndGggPT09IDBcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgZW1wdHlNYW5kYXRvcnlGaWVsZHNNc2cgKz1cbiAgICAgICAgICAgICAgICAgICAgICAgICc8bGk+PHNtYWxsPicgKyBmaWVsZC5sYWJlbCArICc8L3NtYWxsPjwvbGk+JztcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFmaWVsZC5kaXNhYmxlZCAmJiAhZm9ybUNvbnRyb2wudmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbm90VmFsaWRGaWVsZHNNc2cgKz1cbiAgICAgICAgICAgICAgICAgICAgICAgICc8bGk+PHNtYWxsPicgKyBmaWVsZC5sYWJlbCArICc8L3NtYWxsPjwvbGk+JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgdGhlIGhlYWRlciBtZXNzYWdlIG9mIHRoZSBlbXB0eSBtYW5kYXRvcnkgZmllbGRzXG4gICAgICAgIGlmIChlbXB0eU1hbmRhdG9yeUZpZWxkc01zZy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBlbXB0eU1hbmRhdG9yeUZpZWxkc01zZyA9XG4gICAgICAgICAgICAgICAgJzxkaXY+JyArXG4gICAgICAgICAgICAgICAgdGhpcy50cmFuc2xhdGUuaW5zdGFudCgnTUVTU0FHRVMuRVJST1JfTUFOREFUT1JZX0ZJRUxEUycpICtcbiAgICAgICAgICAgICAgICBcIjwvZGl2Pjx1bCBzdHlsZT0ncGFkZGluZzogMCAyMHB4Oyc+XCIgK1xuICAgICAgICAgICAgICAgIGVtcHR5TWFuZGF0b3J5RmllbGRzTXNnICtcbiAgICAgICAgICAgICAgICAnPC91bD48YnIvPic7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgdGhlIGhlYWRlciBtZXNzYWdlIG9mIHRoZSBlbXB0eSBtYW5kYXRvcnkgZmllbGRzXG4gICAgICAgIGlmIChub3RWYWxpZEZpZWxkc01zZy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBub3RWYWxpZEZpZWxkc01zZyA9XG4gICAgICAgICAgICAgICAgJzxkaXY+JyArXG4gICAgICAgICAgICAgICAgdGhpcy50cmFuc2xhdGUuaW5zdGFudCgnTUVTU0FHRVMuRVJST1JfSU5WQUxJRF9GSUVMRFMnKSArXG4gICAgICAgICAgICAgICAgXCI8L2Rpdj48dWwgc3R5bGU9J3BhZGRpbmc6IDAgMjBweDsnPlwiICtcbiAgICAgICAgICAgICAgICBub3RWYWxpZEZpZWxkc01zZyArXG4gICAgICAgICAgICAgICAgJzwvdWw+JztcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHRpdGxlID0gdGhpcy50cmFuc2xhdGUuaW5zdGFudCgnTUVTU0FHRVMuVElUTEVfTk9USUNFJyk7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBuZXcgUGVwRGlhbG9nRGF0YSh7XG4gICAgICAgICAgICB0aXRsZSxcbiAgICAgICAgICAgIGNvbnRlbnQ6IGVtcHR5TWFuZGF0b3J5RmllbGRzTXNnICsgbm90VmFsaWRGaWVsZHNNc2csXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmRpYWxvZ1NlcnZpY2Uub3BlbkRlZmF1bHREaWFsb2coZGF0YSk7XG4gICAgfVxuXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHRoZW1lVmFycyA9IHRoaXMuY3VzdG9taXphdGlvblNlcnZpY2UuZ2V0VGhlbWVWYXJpYWJsZXMoKTtcbiAgICAgICAgLy8gY29udmVydCByZW0gdG8gcGl4ZWxcbiAgICAgICAgY29uc3QgUmVtVG9QaXhlbCA9IDE2O1xuICAgICAgICB0aGlzLmZvcm1HdXR0ZXJTaXplID1cbiAgICAgICAgICAgIHRoaXMuY3VzdG9taXphdGlvblNlcnZpY2UuZ2V0TnVtYmVyVGhlbWVWYXJpYWJsZShcbiAgICAgICAgICAgICAgICB0aGVtZVZhcnMsXG4gICAgICAgICAgICAgICAgUGVwQ3VzdG9taXphdGlvblNlcnZpY2UuRk9STV9TUEFDRUlOR19LRVlcbiAgICAgICAgICAgICkgKiBSZW1Ub1BpeGVsO1xuICAgICAgICB0aGlzLmNhcmRHdXR0ZXJTaXplID1cbiAgICAgICAgICAgIHRoaXMuY3VzdG9taXphdGlvblNlcnZpY2UuZ2V0TnVtYmVyVGhlbWVWYXJpYWJsZShcbiAgICAgICAgICAgICAgICB0aGVtZVZhcnMsXG4gICAgICAgICAgICAgICAgUGVwQ3VzdG9taXphdGlvblNlcnZpY2UuQ0FSRF9TUEFDRUlOR19LRVlcbiAgICAgICAgICAgICkgKiBSZW1Ub1BpeGVsO1xuICAgIH1cblxuICAgIG5nRG9DaGVjaygpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY2hhbmdlcyA9IHRoaXMuZGlmZmVyLmRpZmYodGhpcy5kYXRhKTsgLy8gY2hlY2sgZm9yIGNoYW5nZXNcbiAgICAgICAgaWYgKGNoYW5nZXMpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlRm9ybSgpO1xuICAgICAgICAgICAgdGhpcy5jaGVja0ZvckNoYW5nZXMgPSBuZXcgRGF0ZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlcyk6IHZvaWQge1xuICAgICAgICAvLyBpZiAoY2hhbmdlcy5kYXRhICYmIGNoYW5nZXMuZGF0YS5jdXJyZW50VmFsdWUpIHtcbiAgICAgICAgLy8gICAgIC8vIExvYWQgY2hhbmdlc1xuICAgICAgICAvLyAgICAgaWYgKCF0aGlzLnNob3VsZFJlbG9hZEZvcm0gJiYgY2hhbmdlcy5kYXRhLnByZXZpb3VzVmFsdWUpIHtcbiAgICAgICAgLy8gICAgICAgICB0aGlzLmRhdGEgPSBjaGFuZ2VzLmRhdGEuY3VycmVudFZhbHVlO1xuICAgICAgICAvLyAgICAgICAgIHRoaXMudXBkYXRlRm9ybSgpO1xuICAgICAgICAvLyAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gICAgICAgICB0aGlzLl9zaG91bGRSZWxvYWRGb3JtID0gZmFsc2U7XG4gICAgICAgIC8vICAgICAgICAgdGhpcy5pbml0Rm9ybSgpO1xuICAgICAgICAvLyAgICAgfVxuICAgICAgICAvLyB9XG4gICAgICAgIC8vIGlmICh0aGlzLnNob3VsZFJlbG9hZEZvcm0gfHwgIWNoYW5nZXM/LmRhdGE/LnByZXZpb3VzVmFsdWUpIHtcbiAgICAgICAgLy8gICAgIHRoaXMuX3Nob3VsZFJlbG9hZEZvcm0gPSBmYWxzZTtcbiAgICAgICAgLy8gICAgIHRoaXMuaW5pdEZvcm0oKTtcbiAgICAgICAgLy8gICAgIHRoaXMuY2hlY2tGb3JDaGFuZ2VzID0gbmV3IERhdGUoKTtcbiAgICAgICAgLy8gfVxuICAgIH1cblxuICAgIG5nT25EZXN0cm95KCk6IHZvaWQge1xuICAgICAgICAvLyBpZiAodGhpcy52YWx1ZUNoYW5nZSkge1xuICAgICAgICAvLyAgICAgdGhpcy52YWx1ZUNoYW5nZS51bnN1YnNjcmliZSgpO1xuICAgICAgICAvLyB9XG4gICAgICAgIC8vIGlmICh0aGlzLmZvcm1WYWxpZGF0aW9uQ2hhbmdlKSB7XG4gICAgICAgIC8vICAgICB0aGlzLmZvcm1WYWxpZGF0aW9uQ2hhbmdlLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgIC8vIH1cbiAgICAgICAgLy8gaWYgKHRoaXMuY2hpbGRDbGljaykge1xuICAgICAgICAvLyAgICAgdGhpcy5jaGlsZENsaWNrLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgIC8vIH1cbiAgICAgICAgLy8gaWYgKHRoaXMuY2hpbGRDaGFuZ2UpIHtcbiAgICAgICAgLy8gICAgIHRoaXMuY2hpbGRDaGFuZ2UudW5zdWJzY3JpYmUoKTtcbiAgICAgICAgLy8gfVxuICAgICAgICAvLyBpZiAodGhpcy5maWVsZENsaWNrKSB7XG4gICAgICAgIC8vICAgICB0aGlzLmZpZWxkQ2xpY2sudW5zdWJzY3JpYmUoKTtcbiAgICAgICAgLy8gfVxuICAgIH1cblxuICAgIGdldFVpQ29udHJvbEZpZWxkcygpOiBBcnJheTxVSUNvbnRyb2xGaWVsZD4ge1xuICAgICAgICByZXR1cm4gdGhpcy5sYXlvdXQgPyB0aGlzLmxheW91dC5Db250cm9sRmllbGRzIDogW107XG4gICAgfVxuXG4gICAgaW5pdEZpZWxkc1N0cnVjdHVyZShmaWVsZHM6IFBlcEZpZWxkQmFzZVtdLCBtYXhSb3c6IG51bWJlcik6IHZvaWQge1xuICAgICAgICBjb25zdCB0aGVtZVZhcnMgPSB0aGlzLmN1c3RvbWl6YXRpb25TZXJ2aWNlLmdldFRoZW1lVmFyaWFibGVzKCk7XG5cbiAgICAgICAgLy8gU2V0IGZvcm0gcm93IGhlaWdodC5cbiAgICAgICAgaWYgKHRoaXMubGF5b3V0VHlwZSA9PT0gJ2NhcmQnKSB7XG4gICAgICAgICAgICBjb25zdCBjYXJkRmllbGRIZWlnaHQgPSB0aGlzLmN1c3RvbWl6YXRpb25TZXJ2aWNlLmdldE51bWJlclRoZW1lVmFyaWFibGUoXG4gICAgICAgICAgICAgICAgdGhlbWVWYXJzLFxuICAgICAgICAgICAgICAgIFBlcEN1c3RvbWl6YXRpb25TZXJ2aWNlLkNBUkRfRklFTERfSEVJR0hUX0tFWVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRoaXMucm93SGVpZ2h0ID0gY2FyZEZpZWxkSGVpZ2h0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3Qgcm93RmllbGRIZWlnaHQgPSB0aGlzLmN1c3RvbWl6YXRpb25TZXJ2aWNlLmdldE51bWJlclRoZW1lVmFyaWFibGUoXG4gICAgICAgICAgICAgICAgdGhlbWVWYXJzLFxuICAgICAgICAgICAgICAgIFBlcEN1c3RvbWl6YXRpb25TZXJ2aWNlLkZPUk1fRklFTERfSEVJR0hUX0tFWVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGNvbnN0IHJvd0ZpZWxkVGl0bGVIZWlnaHQgPSB0aGlzLmN1c3RvbWl6YXRpb25TZXJ2aWNlLmdldE51bWJlclRoZW1lVmFyaWFibGUoXG4gICAgICAgICAgICAgICAgdGhlbWVWYXJzLFxuICAgICAgICAgICAgICAgIFBlcEN1c3RvbWl6YXRpb25TZXJ2aWNlLkZPUk1fRklFTERfVElUTEVfSEVJR0hUX0tFWVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRoaXMucm93SGVpZ2h0ID0gcm93RmllbGRIZWlnaHQgKyByb3dGaWVsZFRpdGxlSGVpZ2h0O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBmaWVsZHMgc3RydWN0dXJlICh0aGUgZmllbGRzIG11c3QgYmUgc29ydGVkISEhKS5cbiAgICAgICAgaWYgKGZpZWxkcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAvLyBJbml0IHRoZSBsYXlvdXQuXG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5sYXlvdXRUeXBlID09PSAnZm9ybScgfHxcbiAgICAgICAgICAgICAgICB0aGlzLmxheW91dFR5cGUgPT09ICd0YWJsZSdcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIHRoaXMuZmllbGRzID0gZmllbGRzO1xuICAgICAgICAgICAgICAgIHRoaXMucm93cyA9IFtdO1xuXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gbWF4Um93OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yb3dzW2ldID0gW107XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gZm9yIChsZXQgaSA9IDA7IGkgPCBmaWVsZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAvLyBjb25zdCBmaWVsZCA9IGZpZWxkc1tpXVxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZmllbGQgb2YgZmllbGRzKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucm93c1tmaWVsZC5yb3ddLnB1c2goZmllbGQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZG9lc2ZpZWxkRXhpc3RJbjogYm9vbGVhbltdW10gPSBuZXcgQXJyYXkobWF4Um93KTtcblxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZG9lc2ZpZWxkRXhpc3RJbi5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBkb2VzZmllbGRFeGlzdEluW2ldID0gbmV3IEFycmF5KHRoaXMuY29sdW1ucyk7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBkb2VzZmllbGRFeGlzdEluW2ldLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkb2VzZmllbGRFeGlzdEluW2ldW2pdID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBSdW4gaW4gc3F1ZXJlIChyb3cgLSBjb2xzcGFuLCBjb2wgLSByb3dzcGFuKSBhbmQgcHV0IHRydWUgd2hlcmUgaXQgc2hvdWxkLlxuICAgICAgICAgICAgICAgIC8vIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBmaWVsZHMubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgIGNvbnN0IGN1cnJlbnRGaWVsZCA9IGZpZWxkc1tpbmRleF07XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBjdXJyZW50RmllbGQgb2YgZmllbGRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50RmllbGQucm93U3BhbiA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJvdzogbnVtYmVyID0gY3VycmVudEZpZWxkLnJvdztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3cgPCBjdXJyZW50RmllbGQucm93ICsgY3VycmVudEZpZWxkLnJvd1NwYW47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93KytcbiAgICAgICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50RmllbGQuY29sU3BhbiA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb2w6IG51bWJlciA9IGN1cnJlbnRGaWVsZC5jb2w7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2wgPFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEZpZWxkLmNvbCArIGN1cnJlbnRGaWVsZC5jb2xTcGFuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sKytcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9lc2ZpZWxkRXhpc3RJbi5sZW5ndGggPiByb3cgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2VzZmllbGRFeGlzdEluWzBdLmxlbmd0aCA+IGNvbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9lc2ZpZWxkRXhpc3RJbltyb3ddW2NvbF0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9lc2ZpZWxkRXhpc3RJbi5sZW5ndGggPiByb3cgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvZXNmaWVsZEV4aXN0SW5bMF0ubGVuZ3RoID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRGaWVsZC5jb2xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2VzZmllbGRFeGlzdEluW3Jvd11bXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEZpZWxkLmNvbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY3VycmVudEZpZWxkLmNvbFNwYW4gPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb2w6IG51bWJlciA9IGN1cnJlbnRGaWVsZC5jb2w7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sIDwgY3VycmVudEZpZWxkLmNvbCArIGN1cnJlbnRGaWVsZC5jb2xTcGFuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbCsrXG4gICAgICAgICAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvZXNmaWVsZEV4aXN0SW4ubGVuZ3RoID4gY3VycmVudEZpZWxkLnJvdyAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2VzZmllbGRFeGlzdEluWzBdLmxlbmd0aCA+IGNvbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2VzZmllbGRFeGlzdEluW2N1cnJlbnRGaWVsZC5yb3ddW2NvbF0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2VzZmllbGRFeGlzdEluLmxlbmd0aCA+IGN1cnJlbnRGaWVsZC5yb3cgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2VzZmllbGRFeGlzdEluWzBdLmxlbmd0aCA+IGN1cnJlbnRGaWVsZC5jb2xcbiAgICAgICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvZXNmaWVsZEV4aXN0SW5bY3VycmVudEZpZWxkLnJvd11bXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRGaWVsZC5jb2xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBlbXB0eSBmaWVsZHMgd2hlcmUgZG9lc2ZpZWxkRXhpc3RJbiBpcyBmYWxzZSAoRm9yIHRoZSBtZC1ncmlkLWxpc3QgVUkgQ29tcG9uZW50KS5cbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRvZXNmaWVsZEV4aXN0SW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBkb2VzZmllbGRFeGlzdEluW2ldLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWRvZXNmaWVsZEV4aXN0SW5baV1bal0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgZW1wdHkgZmllbGQgYW5kIGFkZCBpdCB0byB0aGUgZmllbGRzIGxpc3QuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRzLnB1c2goXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBQZXBQbGFjZWhvbGRlckZpZWxkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleTogaSArICdfJyArIGosXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogJycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjogJycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFkb25seTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWRkZW46IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFuZGF0b3J5OiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlZFZhbHVlOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdzogaSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd1NwYW46IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2w6IGosXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xTcGFuOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXI6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFNvcnQgdGhlIGZpZWxkcyBhZ2Fpbi5cbiAgICAgICAgICAgICAgICB0aGlzLmZpZWxkcyA9IGZpZWxkcy5zb3J0KChmMSwgZjIpID0+XG4gICAgICAgICAgICAgICAgICAgIGYxLnJvdyA+IGYyLnJvd1xuICAgICAgICAgICAgICAgICAgICAgICAgPyAxXG4gICAgICAgICAgICAgICAgICAgICAgICA6IGYxLnJvdyA8IGYyLnJvd1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gLTFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGYxLmNvbCA+IGYyLmNvbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IDFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBmMS5jb2wgPCBmMi5jb2xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gLTFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogMFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzZXRGb3JtKGlzRm9yVXBkYXRlID0gZmFsc2UpOiB2b2lkIHtcbiAgICAgICAgbGV0IGFsbEZpZWxkc0FyZVJlYWRPbmx5ID0gdHJ1ZTtcblxuICAgICAgICBpZiAoIWlzRm9yVXBkYXRlKSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZHMgPSBbXTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgY3VycmVudEZpZWxkIG9mIHRoaXMuZmllbGRzKSB7XG4gICAgICAgICAgICAgICAgLy8gQWRkIGFsbCBmaWVsZHMgZXhjZXB0ICdpbnRlcm5hbFBhZ2UnIHR5cGUgKGZvciBjaGlsZHJlbikuXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRGaWVsZC5jb250cm9sVHlwZSAhPT0gJ2ludGVybmFsUGFnZScpIHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGRzLnB1c2goY3VycmVudEZpZWxkKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnRGaWVsZC5yZWFkb25seSkge1xuICAgICAgICAgICAgICAgICAgICBhbGxGaWVsZHNBcmVSZWFkT25seSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5mb3JtID0gdGhpcy50b0NvbnRyb2xHcm91cChmaWVsZHMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gVXBkYXRlIGZvcm0gdmFsdWVzIGlmIGNoYW5nZWQgYnkgY2FsY3VsYXRlZCBmaWVsZHMuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGN1cnJlbnRGaWVsZCBvZiB0aGlzLmZpZWxkcykge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50RmllbGQuY29udHJvbFR5cGUgIT09ICdpbnRlcm5hbFBhZ2UnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRGaWVsZC5ncm91cEZpZWxkcyAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEZpZWxkLmdyb3VwRmllbGRzLmxlbmd0aCA+IDBcbiAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBmb3IgKGxldCBqID0gMDsgaiA8IGN1cnJlbnRGaWVsZC5ncm91cEZpZWxkcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIGxldCBjdXJyZW50R3JvdXBGaWVsZCA9IGN1cnJlbnRGaWVsZC5ncm91cEZpZWxkc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY3VycmVudEdyb3VwRmllbGQgb2YgY3VycmVudEZpZWxkLmdyb3VwRmllbGRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGRGb3JtYXR0ZWRWYWx1ZSA9IHRoaXMuZ2V0RmllbGRGb3JtYXR0ZWRWYWx1ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEdyb3VwRmllbGRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VzdG9taXphdGlvblNlcnZpY2UudXBkYXRlRm9ybUZpZWxkKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRHcm91cEZpZWxkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZEZvcm1hdHRlZFZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50RmllbGRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGRGb3JtYXR0ZWRWYWx1ZSA9IHRoaXMuZ2V0RmllbGRGb3JtYXR0ZWRWYWx1ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50RmllbGRcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLmZvcm0uY29udHJvbHNbY3VycmVudEZpZWxkLmtleV0uc2V0VmFsdWUoZmllbGRGb3JtYXR0ZWRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1c3RvbWl6YXRpb25TZXJ2aWNlLnVwZGF0ZUZvcm1GaWVsZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEZpZWxkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkRm9ybWF0dGVkVmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnRGaWVsZC5yZWFkb25seSkge1xuICAgICAgICAgICAgICAgICAgICBhbGxGaWVsZHNBcmVSZWFkT25seSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBpc0Zvcm1WYWxpZCA9IHRoaXMuZm9ybT8udmFsaWQ7XG5cbiAgICAgICAgLy8gQ2hhbmdlIHZhbGlkYXRpb24gdG8gdHJ1ZSBpZiBhbGwgZmllbGRzIGFyZSByZWFkIG9ubHkuXG4gICAgICAgIGlmICghaXNGb3JtVmFsaWQgJiYgYWxsRmllbGRzQXJlUmVhZE9ubHkpIHtcbiAgICAgICAgICAgIGlzRm9ybVZhbGlkID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMub25Gb3JtVmFsaWRhdGlvbkNoYW5nZWQoaXNGb3JtVmFsaWQpO1xuXG4gICAgICAgIC8vIFNldCBpdCB0byBmYWxzZSB0byBlbmFibGUgYWxsIGZpZWxkcy5cbiAgICAgICAgdGhpcy5pc0xvY2tlZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIGluaXRGb3JtKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5kYXRhICYmIHRoaXMuZGF0YS5GaWVsZHMpIHtcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkczogUGVwRmllbGRCYXNlW10gPSB0aGlzLmNvbnZlcnRDdXN0b21GaWVsZHMoXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRVaUNvbnRyb2xGaWVsZHMoKSxcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGEuRmllbGRzXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBjb25zdCBtYXhSb3cgPSBNYXRoLm1heChcbiAgICAgICAgICAgICAgICAuLi5maWVsZHMubWFwKChmKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmLnJvdyArIGYucm93U3BhbjtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRoaXMuY29sdW1ucyA9IE1hdGgubWF4KFxuICAgICAgICAgICAgICAgIC4uLmZpZWxkcy5tYXAoKGYpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGYuY29sICsgZi5jb2xTcGFuO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICB0aGlzLmluaXRGaWVsZHNTdHJ1Y3R1cmUoZmllbGRzLCBtYXhSb3cpO1xuICAgICAgICAgICAgdGhpcy5zZXRGb3JtKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHVwZGF0ZUZpZWxkKFxuICAgICAgICBjdXN0b21GaWVsZDogUGVwRmllbGRCYXNlLFxuICAgICAgICB1cGRhdGVkRmllbGQ6IE9iamVjdHNEYXRhUm93Q2VsbFxuICAgICk6IHZvaWQge1xuICAgICAgICBjb25zdCBvcHRpb25zOiBhbnkgPSB7XG4gICAgICAgICAgICBkaXNhYmxlZDogIXVwZGF0ZWRGaWVsZC5FbmFibGVkIHx8ICF0aGlzLmNhbkVkaXRPYmplY3QsXG4gICAgICAgICAgICByZWFkb25seTogIXVwZGF0ZWRGaWVsZC5FbmFibGVkIHx8ICF0aGlzLmNhbkVkaXRPYmplY3QsXG4gICAgICAgICAgICB2aXNpYmxlOiB1cGRhdGVkRmllbGQuVmlzaWJsZSxcbiAgICAgICAgICAgIHZhbHVlOiB1cGRhdGVkRmllbGQuVmFsdWUsXG4gICAgICAgICAgICBhZGRpdGlvbmFsVmFsdWU6IHVwZGF0ZWRGaWVsZC5BZGRpdGlvbmFsVmFsdWUsXG4gICAgICAgICAgICBmb3JtYXR0ZWRWYWx1ZTogdXBkYXRlZEZpZWxkLkZvcm1hdHRlZFZhbHVlLFxuICAgICAgICAgICAgdGV4dENvbG9yOiB1cGRhdGVkRmllbGQuVGV4dENvbG9yLFxuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChjdXN0b21GaWVsZCBpbnN0YW5jZW9mIFBlcFF1YW50aXR5U2VsZWN0b3JGaWVsZCkge1xuICAgICAgICAgICAgY29uc3Qgbm90aWZpY2F0aW9uSW5mbyA9IHVwZGF0ZWRGaWVsZC5Ob3RpZmljYXRpb25JbmZvO1xuICAgICAgICAgICAgb3B0aW9ucy5ub3RpZmljYXRpb25JbmZvID0gbm90aWZpY2F0aW9uSW5mbztcbiAgICAgICAgfSBlbHNlIGlmIChjdXN0b21GaWVsZCBpbnN0YW5jZW9mIFBlcFNlbGVjdEZpZWxkKSB7XG4gICAgICAgICAgICBvcHRpb25zLm9wdGlvbnMgPSB0aGlzLmNvbnZlcnRPcHRpb25hbFZhbHVlcyhcbiAgICAgICAgICAgICAgICB1cGRhdGVkRmllbGQuT3B0aW9uYWxWYWx1ZXNcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGlmICghb3B0aW9ucy5vcHRpb25zIHx8IG9wdGlvbnMub3B0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGtleTogb3B0aW9ucy52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG9wdGlvbnMuZm9ybWF0dGVkVmFsdWUsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjdXN0b21GaWVsZC51cGRhdGUob3B0aW9ucyk7XG4gICAgfVxuXG4gICAgdXBkYXRlRm9ybSgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuZGF0YSAmJiB0aGlzLmRhdGEuRmllbGRzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGN1cnJlbnRGaWVsZCBvZiB0aGlzLmRhdGEuRmllbGRzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VzdG9tRmllbGQgPSB0aGlzLmZpZWxkcy5maWx0ZXIoXG4gICAgICAgICAgICAgICAgICAgIChmKSA9PiBmLmtleSA9PT0gY3VycmVudEZpZWxkLkFwaU5hbWVcbiAgICAgICAgICAgICAgICApWzBdO1xuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBhbGwgZmllbGRzIGV4Y2VwdCAnaW50ZXJuYWxQYWdlJyB0eXBlIChmb3IgY2hpbGRyZW4pLlxuICAgICAgICAgICAgICAgIGlmIChjdXN0b21GaWVsZCAmJiBjdXN0b21GaWVsZC5jb250cm9sVHlwZSAhPT0gJ2ludGVybmFsUGFnZScpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVGaWVsZChjdXN0b21GaWVsZCwgY3VycmVudEZpZWxkKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGhlIGdyb3VwIGZpZWxkcy5cbiAgICAgICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VzdG9tRmllbGQuY29udHJvbFR5cGUgPT09ICdhZGRyZXNzJyAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEZpZWxkLkdyb3VwRmllbGRzXG4gICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZm9yIChsZXQgaiA9IDA7IGogPCBjdXJyZW50RmllbGQuR3JvdXBGaWVsZHMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGxldCBjdXJyZW50R3JvdXBGaWVsZCA9IGN1cnJlbnRGaWVsZC5Hcm91cEZpZWxkc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY3VycmVudEdyb3VwRmllbGQgb2YgY3VycmVudEZpZWxkLkdyb3VwRmllbGRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEdyb3VwRmllbGQuRW5hYmxlZCA9ICFjdXJyZW50RmllbGQuRW5hYmxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogY3VycmVudEdyb3VwRmllbGQuRW5hYmxlZDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1c3RvbUdyb3VwRmllbGQgPSBjdXN0b21GaWVsZC5ncm91cEZpZWxkcy5maWx0ZXIoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChmKSA9PiBmLmtleSA9PT0gY3VycmVudEdyb3VwRmllbGQuQXBpTmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVGaWVsZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VzdG9tR3JvdXBGaWVsZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEdyb3VwRmllbGRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnNldEZvcm0odHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgUmVsb2FkRm9ybSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fc2hvdWxkUmVsb2FkRm9ybSA9IHRydWU7XG4gICAgfVxuXG4gICAgLy8gb25TdWJtaXQoKSB7XG4gICAgLy8gICAgIGlmICh0aGlzLmZvcm0udmFsaWQpIHtcbiAgICAvLyAgICAgICAgIHRoaXMucGF5TG9hZCA9IEpTT04uc3RyaW5naWZ5KHRoaXMuZm9ybS52YWx1ZSk7XG4gICAgLy8gICAgICAgICAvL3RoaXMuc3VibWl0dGVkLmVtaXQodGhpcy5mb3JtLnZhbHVlKTtcbiAgICAvLyAgICAgfVxuICAgIC8vIH1cblxuICAgIHByaXZhdGUgZ2V0Rm9ybUNvbnRyb2xCeUlkKGtleTogc3RyaW5nKTogQWJzdHJhY3RDb250cm9sIHwgbnVsbCB7XG4gICAgICAgIGxldCBmb3JtQ29udHJvbCA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5maWVsZHMuZm9yRWFjaCgoZmllbGQpID0+IHtcbiAgICAgICAgICAgIGlmIChmaWVsZC5rZXkgPT09IGtleSkge1xuICAgICAgICAgICAgICAgIGZvcm1Db250cm9sID0gdGhpcy5mb3JtLmdldChmaWVsZC5rZXkpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZmllbGQuZ3JvdXBGaWVsZHMgJiYgZmllbGQuZ3JvdXBGaWVsZHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGZpZWxkLmdyb3VwRmllbGRzLmZvckVhY2goKGdyb3VwRmllbGQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdyb3VwRmllbGQua2V5ID09PSBrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1Db250cm9sID0gdGhpcy5mb3JtLmdldChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZC5rZXkgKyAnLicgKyBncm91cEZpZWxkLmtleVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gZm9ybUNvbnRyb2w7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXRTcGVjaWFsRmllbGRzKFxuICAgICAgICBjb250cm9sRmllbGRzOiBBcnJheTxhbnk+LFxuICAgICAgICBkYXRhRmllbGRzOiBBcnJheTxhbnk+XG4gICAgKTogdm9pZCB7XG4gICAgICAgIC8vIGxldCBjZjtcbiAgICAgICAgLy8gZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGNvbnRyb2xGaWVsZHMubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgIC8vICAgICBjZiA9IGNvbnRyb2xGaWVsZHNbaW5kZXhdO1xuICAgICAgICBmb3IgKGNvbnN0IGNmIG9mIGNvbnRyb2xGaWVsZHMpIHtcbiAgICAgICAgICAgIGlmIChjZi5BcGlOYW1lID09PSAnT2JqZWN0TWVudScpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1lbnVGaWVsZCA9IGNmO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjZi5BcGlOYW1lID09PSAnSXRlbUhhc0FjdGl2ZUNhbXBhaWduJykge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFzQ2FtcGFpZ25GaWVsZCA9IGNmO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjZi5BcGlOYW1lID09PSAnSXRlbUluZGljYXRvcnNXaXRob3V0Q2FtcGFpZ24nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbmRpY2F0b3JzRmllbGQgPSBjZjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGxldCBkZjtcbiAgICAgICAgLy8gZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGRhdGFGaWVsZHMubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgIC8vICAgICBkZiA9IGRhdGFGaWVsZHNbaW5kZXhdO1xuICAgICAgICBmb3IgKGNvbnN0IGRmIG9mIGRhdGFGaWVsZHMpIHtcbiAgICAgICAgICAgIGlmIChkZi5BcGlOYW1lID09PSAnT2JqZWN0TWVudScpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1lbnVEYXRhRmllbGQgPSBkZjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGYuQXBpTmFtZSA9PT0gJ0l0ZW1IYXNBY3RpdmVDYW1wYWlnbicpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhc0NhbXBhaWduRGF0YUZpZWxkID0gZGY7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRmLkFwaU5hbWUgPT09ICdJdGVtSW5kaWNhdG9yc1dpdGhvdXRDYW1wYWlnbicpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmluZGljYXRvcnNEYXRhRmllbGQgPSBkZjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLm1lbnVGaWVsZCAmJiB0aGlzLm1lbnVEYXRhRmllbGQpIHtcbiAgICAgICAgICAgIHRoaXMubWVudURhdGFGaWVsZC5MYXlvdXQgPSB0aGlzLm1lbnVGaWVsZC5MYXlvdXQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5oYXNDYW1wYWlnbkZpZWxkICYmIHRoaXMuaGFzQ2FtcGFpZ25EYXRhRmllbGQpIHtcbiAgICAgICAgICAgIHRoaXMuaGFzQ2FtcGFpZ25EYXRhRmllbGQuTGF5b3V0ID0gdGhpcy5oYXNDYW1wYWlnbkZpZWxkLkxheW91dDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmluZGljYXRvcnNGaWVsZCAmJiB0aGlzLmluZGljYXRvcnNEYXRhRmllbGQpIHtcbiAgICAgICAgICAgIHRoaXMuaW5kaWNhdG9yc0RhdGFGaWVsZC5MYXlvdXQgPSB0aGlzLmluZGljYXRvcnNGaWVsZC5MYXlvdXQ7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiBtZW51IGlzIGZsb2F0aW5nIG9uIG90aGVyIGZpZWxkLlxuICAgICAgICAvLyBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgY29udHJvbEZpZWxkcy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgLy8gICAgIGNmID0gY29udHJvbEZpZWxkc1tpbmRleF07XG4gICAgICAgIGZvciAoY29uc3QgY2Ygb2YgY29udHJvbEZpZWxkcykge1xuICAgICAgICAgICAgaWYgKHRoaXMubWVudUZpZWxkICYmIGNmLkFwaU5hbWUgIT09ICdPYmplY3RNZW51Jykge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFzTWVudUZsb2F0aW5nT25PdGhlckZpZWxkID0gdGhpcy5kb2VzRmllbGRIYXZhRmxvYXRpbmdGaWVsZChcbiAgICAgICAgICAgICAgICAgICAgY2YsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWVudUZpZWxkXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc01lbnVGbG9hdGluZ09uT3RoZXJGaWVsZCkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb252ZXJ0Q3VzdG9tRmllbGRzKFxuICAgICAgICBjb250cm9sRmllbGRzOiBBcnJheTxhbnk+LFxuICAgICAgICBkYXRhRmllbGRzOiBBcnJheTxhbnk+XG4gICAgKTogUGVwRmllbGRCYXNlW10ge1xuICAgICAgICBpZiAodGhpcy5sYXlvdXRUeXBlICE9PSAndGFibGUnKSB7XG4gICAgICAgICAgICB0aGlzLnNldFNwZWNpYWxGaWVsZHMoY29udHJvbEZpZWxkcywgZGF0YUZpZWxkcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBIQUNLOiBjb252ZXJ0IHRvIGNlbnRlciBhbGlnbm1lbnQgaWYgdGFibGUgdmlldyAmIHNwZWNpYWwgZmllbGRzKVxuICAgICAgICAgICAgY29udHJvbEZpZWxkcy5mb3JFYWNoKChmaWVsZCwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgIGZpZWxkLkFwaU5hbWUgPT09ICdVbml0c1F1YW50aXR5JyB8fFxuICAgICAgICAgICAgICAgICAgICBmaWVsZC5BcGlOYW1lID09PSAnUXVhbnRpdHlTZWxlY3RvcicgfHxcbiAgICAgICAgICAgICAgICAgICAgZmllbGQuQXBpTmFtZSA9PT0gJ09iamVjdE1lbnUnIHx8XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkLkZpZWxkVHlwZSA9PT0gRklFTERfVFlQRS5JbWFnZSB8fFxuICAgICAgICAgICAgICAgICAgICBmaWVsZC5GaWVsZFR5cGUgPT09IEZJRUxEX1RZUEUuSW1hZ2VVUkwgfHxcbiAgICAgICAgICAgICAgICAgICAgZmllbGQuRmllbGRUeXBlID09PSBGSUVMRF9UWVBFLkluZGljYXRvcnMgfHxcbiAgICAgICAgICAgICAgICAgICAgZmllbGQuRmllbGRUeXBlID09PSBGSUVMRF9UWVBFLkJvb2xlYW4gfHxcbiAgICAgICAgICAgICAgICAgICAgZmllbGQuRmllbGRUeXBlID09PSBGSUVMRF9UWVBFLkNhbGN1bGF0ZWRCb29sIHx8XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkLkZpZWxkVHlwZSA9PT0gRklFTERfVFlQRS5TaWduYXR1cmUgfHxcbiAgICAgICAgICAgICAgICAgICAgZmllbGQuRmllbGRUeXBlID09PVxuICAgICAgICAgICAgICAgICAgICBGSUVMRF9UWVBFLk51bWJlckludGVnZXJRdWFudGl0eVNlbGVjdG9yIHx8XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkLkZpZWxkVHlwZSA9PT0gRklFTERfVFlQRS5OdW1iZXJSZWFsUXVhbnRpdHlTZWxlY3RvciB8fFxuICAgICAgICAgICAgICAgICAgICBmaWVsZC5GaWVsZFR5cGUgPT09IEZJRUxEX1RZUEUuUGFja2FnZSB8fFxuICAgICAgICAgICAgICAgICAgICBmaWVsZC5GaWVsZFR5cGUgPT09IEZJRUxEX1RZUEUuTnVtYmVySW50ZWdlckZvck1hdHJpeCB8fFxuICAgICAgICAgICAgICAgICAgICBmaWVsZC5GaWVsZFR5cGUgPT09IEZJRUxEX1RZUEUuTnVtYmVyUmVhbEZvck1hdHJpeFxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICBmaWVsZC5MYXlvdXQuWEFsaWdubWVudCA9IFhfQUxJR05NRU5UX1RZUEUuQ2VudGVyO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEhBQ0s6IGFsaWduIHRoZSByZXN0IG9mIHRoZSBmaWVsZHMgYnkgdGhlIGN1bHR1cmUuXG4gICAgICAgICAgICAgICAgICAgIC8vIGZpZWxkLkxheW91dC5YQWxpZ25tZW50ID0gdGhpcy5sYXlvdXRTZXJ2aWNlLmlzUnRsKCkgPyBYX0FMSUdOTUVOVF9UWVBFLlJpZ2h0IDogWF9BTElHTk1FTlRfVFlQRS5MZWZ0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZmllbGRzOiBQZXBGaWVsZEJhc2VbXSA9IFtdO1xuXG4gICAgICAgIC8vIGNvbnN0IG1hdHJpeEZpZWxkcyA9IGNvbnRyb2xGaWVsZHMuZmlsdGVyKChjZikgPT5cbiAgICAgICAgLy8gICAgIHRoaXMuaXNNYXRyaXhGaWVsZChjZi5BcGlOYW1lKVxuICAgICAgICAvLyApLmxlbmd0aDtcbiAgICAgICAgLy8gbGV0IG1hdHJpeEFscmVhZHlQbGFjZWQgPSBmYWxzZTtcblxuICAgICAgICBjb250cm9sRmllbGRzLmZvckVhY2goKGZpZWxkLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZGF0YUZpZWxkID0gZGF0YUZpZWxkcy5maWx0ZXIoXG4gICAgICAgICAgICAgICAgKGRmKSA9PiBkZi5BcGlOYW1lID09PSBmaWVsZC5BcGlOYW1lXG4gICAgICAgICAgICApWzBdO1xuXG4gICAgICAgICAgICBpZiAoIWRhdGFGaWVsZCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gSWYgY3VycmVudCB2aWV3IGlzIG5vdCB0YWJsZSB2aWV3IGFuZCB0aG9zZSBmaWVsZHMgYXJlIHNwZWNpYWwuXG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgdGhpcy5sYXlvdXRUeXBlICE9PSAndGFibGUnICYmXG4gICAgICAgICAgICAgICAgKCh0aGlzLmhhc01lbnVGbG9hdGluZ09uT3RoZXJGaWVsZCAmJlxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbnVGaWVsZCAmJlxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbnVGaWVsZC5BcGlOYW1lID09PSBmaWVsZC5BcGlOYW1lKSB8fFxuICAgICAgICAgICAgICAgICAgICAodGhpcy5pbmRpY2F0b3JzRmllbGQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5kaWNhdG9yc0ZpZWxkLkFwaU5hbWUgPT09IGZpZWxkLkFwaU5hbWUpIHx8XG4gICAgICAgICAgICAgICAgICAgICh0aGlzLmhhc0NhbXBhaWduRmllbGQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzQ2FtcGFpZ25GaWVsZC5BcGlOYW1lID09PSBmaWVsZC5BcGlOYW1lKSlcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU2V0IHR5cGUgdG8gbGlua1xuICAgICAgICAgICAgaWYgKGluZGV4ID09PSAwICYmIHRoaXMuZmlyc3RGaWVsZEFzTGluaykge1xuICAgICAgICAgICAgICAgIGRhdGFGaWVsZC5GaWVsZFR5cGUgPSBGSUVMRF9UWVBFLkludGVybmFsTGluaztcbiAgICAgICAgICAgICAgICAvLyBkYXRhRmllbGQuVmFsdWUgPSB0aGlzLmdldEludGVybmFsTGlua0hyZWYoKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgICAgICAgICAgZGF0YUZpZWxkLlZhbHVlLmxlbmd0aCA+IDAgJiZcbiAgICAgICAgICAgICAgICAoZmllbGQuRmllbGRUeXBlID09PSBGSUVMRF9UWVBFLlJlZmVyZW5jZVR5cGUgfHxcbiAgICAgICAgICAgICAgICAgICAgZmllbGQuRmllbGRUeXBlID09PSBGSUVMRF9UWVBFLkd1aWRSZWZlcmVuY2VUeXBlKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgLy8gY29uc3QgdHJhbnNhY3Rpb25VcmwgPVxuICAgICAgICAgICAgICAgIC8vICAgICB0aGlzLmRhdGEuTWFpbkFjdGlvbiA9PT0gJzInXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICA/ICd0cmFuc2FjdGlvbnMvc2NvcGVfaXRlbXMvJ1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgOiAndHJhbnNhY3Rpb25zL2NhcnQvJztcbiAgICAgICAgICAgICAgICAvLyBkYXRhRmllbGQuVmFsdWUgPSB0cmFuc2FjdGlvblVybCArIGRhdGFGaWVsZC5WYWx1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGZpZWxkLkFwaU5hbWUgPT09ICdPYmplY3RNZW51Jykge1xuICAgICAgICAgICAgICAgIGRhdGFGaWVsZC5FbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAvLyBIQUNLIDogVW50aWwgXCJFbmFibGVkXCIgcmV0dXJucyBmcm9tIHRoZSBzZXJ2ZXIsIHdlIHNldCBQZXBNZW51IHRvIGJlXG4gICAgICAgICAgICAgICAgLy8gICAgICAgIERpc2FibGVkIGluIGNhcnQgb24gcmVndWxhciBpdGVtcyBhbmQgbm90IGNhbXBpZ24gaXRlbXMuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBjdXN0b21GaWVsZDogUGVwRmllbGRCYXNlID0gdGhpcy5jb252ZXJ0VG9DdXN0b21GaWVsZChcbiAgICAgICAgICAgICAgICBmaWVsZCxcbiAgICAgICAgICAgICAgICBkYXRhRmllbGQsXG4gICAgICAgICAgICAgICAgdGhpcy5jYW5FZGl0T2JqZWN0LFxuICAgICAgICAgICAgICAgIHRoaXMubWVudURhdGFGaWVsZCxcbiAgICAgICAgICAgICAgICB0aGlzLmhhc0NhbXBhaWduRGF0YUZpZWxkLFxuICAgICAgICAgICAgICAgIHRoaXMuaW5kaWNhdG9yc0RhdGFGaWVsZCxcbiAgICAgICAgICAgICAgICB0aGlzLm9iamVjdElkLFxuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50SWQsXG4gICAgICAgICAgICAgICAgdGhpcy5zZWFyY2hDb2RlXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBmaWVsZHMucHVzaChjdXN0b21GaWVsZCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBmaWVsZHMuc29ydCgoZjEsIGYyKSA9PlxuICAgICAgICAgICAgZjEucm93ID4gZjIucm93XG4gICAgICAgICAgICAgICAgPyAxXG4gICAgICAgICAgICAgICAgOiBmMS5yb3cgPCBmMi5yb3dcbiAgICAgICAgICAgICAgICAgICAgPyAtMVxuICAgICAgICAgICAgICAgICAgICA6IGYxLmNvbCA+IGYyLmNvbFxuICAgICAgICAgICAgICAgICAgICAgICAgPyAxXG4gICAgICAgICAgICAgICAgICAgICAgICA6IGYxLmNvbCA8IGYyLmNvbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gLTFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IDBcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBvblZhbHVlQ2hhbmdlZChldmVudDogSVBlcEZpZWxkVmFsdWVDaGFuZ2VFdmVudCk6IHZvaWQge1xuICAgICAgICB0aGlzLm9uRm9ybVZhbGlkYXRpb25DaGFuZ2VkKHRoaXMuZm9ybS52YWxpZCk7XG5cbiAgICAgICAgY29uc3QgZm9ybUNvbnRyb2wgPSB0aGlzLmdldEZvcm1Db250cm9sQnlJZChldmVudC5rZXkpO1xuXG4gICAgICAgIGNvbnN0IGlzVmFsaWQgPSBmb3JtQ29udHJvbCA/IGZvcm1Db250cm9sLnZhbGlkIDogdHJ1ZTtcbiAgICAgICAgLy8gY29uc3QgaXNWYWxpZCA9IHRydWU7XG5cbiAgICAgICAgaWYgKGlzVmFsaWQpIHtcbiAgICAgICAgICAgIC8vIFNldCBpdCB0byBmYWxzZSB0byBkaXNhYmxlIGFsbCBmaWVsZHMuXG4gICAgICAgICAgICBpZiAodGhpcy5sYXlvdXRUeXBlID09PSAnZm9ybScpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlzTG9ja2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBjdXJyZW50IGZpZWxkIHZhbHVlLlxuICAgICAgICAgICAgY29uc3QgY3VycmVudEZpZWxkID0gdGhpcy5maWVsZHMuZmluZCgoZikgPT4gZi5rZXkgPT09IGV2ZW50LmtleSk7XG4gICAgICAgICAgICBpZiAoY3VycmVudEZpZWxkKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudEZpZWxkLmZvcm1hdHRlZFZhbHVlID0gY3VycmVudEZpZWxkLnZhbHVlID0gZXZlbnQudmFsdWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMudmFsdWVDaGFuZ2UuZW1pdCh7XG4gICAgICAgICAgICAgICAgaWQ6IHRoaXMuZGF0YS5VSUQudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICBrZXk6IGV2ZW50LmtleSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogZXZlbnQudmFsdWUsXG4gICAgICAgICAgICAgICAgY29udHJvbFR5cGU6IGV2ZW50LmNvbnRyb2xUeXBlLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbkNoaWxkQ2xpY2tlZChjaGlsZENsaWNrOiBhbnkpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jaGlsZENsaWNrLmVtaXQoY2hpbGRDbGljayk7XG4gICAgfVxuXG4gICAgb25DaGlsZENoYW5nZWQoY2hpbGRDaGFuZ2U6IGFueSk6IHZvaWQge1xuICAgICAgICB0aGlzLmNoaWxkQ2hhbmdlLmVtaXQoY2hpbGRDaGFuZ2UpO1xuICAgIH1cblxuICAgIG9uRm9ybVZhbGlkYXRpb25DaGFuZ2VkKGZvcm1WYWxpZGF0aW9uQ2hhbmdlOiBhbnkpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5mb3JtVmFsaWRhdGlvbkNoYW5nZS5lbWl0KGZvcm1WYWxpZGF0aW9uQ2hhbmdlKTtcbiAgICB9XG5cbiAgICBvbkNsaWNrKGZpZWxkQ2xpY2tFdmVudDogSVBlcEZpZWxkQ2xpY2tFdmVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBjbGlja2VkVWlDb250cm9sRmllbGQgPSB0aGlzLmRhdGEuRmllbGRzLmZpbHRlcihcbiAgICAgICAgICAgIChmKSA9PiBmLkFwaU5hbWUgPT09IGZpZWxkQ2xpY2tFdmVudC5rZXlcbiAgICAgICAgKVswXTtcbiAgICAgICAgY29uc3QgaWRUeXBlID0gdGhpcy5kYXRhLlR5cGUgPyB0aGlzLmRhdGEuVHlwZS50b1N0cmluZygpIDogJyc7XG5cbiAgICAgICAgaWYgKGNsaWNrZWRVaUNvbnRyb2xGaWVsZCkge1xuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgIGNsaWNrZWRVaUNvbnRyb2xGaWVsZC5GaWVsZFR5cGUgPT09IEZJRUxEX1RZUEUuR3VpZFJlZmVyZW5jZVR5cGVcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIHRoaXMuZmllbGRDbGljay5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHRoaXMuZGF0YS5VSUQudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAga2V5OiBmaWVsZENsaWNrRXZlbnQua2V5LFxuICAgICAgICAgICAgICAgICAgICBpZFR5cGUsXG4gICAgICAgICAgICAgICAgICAgIHdoaWNoOiBmaWVsZENsaWNrRXZlbnQuZXZlbnRXaGljaCxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGZpZWxkQ2xpY2tFdmVudC52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbFR5cGU6IGZpZWxkQ2xpY2tFdmVudC5jb250cm9sVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgZmllbGRUeXBlOiBjbGlja2VkVWlDb250cm9sRmllbGQuRmllbGRUeXBlLFxuICAgICAgICAgICAgICAgICAgICBvdGhlckRhdGE6IGZpZWxkQ2xpY2tFdmVudC5vdGhlckRhdGEsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKFxuICAgICAgICAgICAgICAgIGNsaWNrZWRVaUNvbnRyb2xGaWVsZC5GaWVsZFR5cGUgPT09IEZJRUxEX1RZUEUuTGlzdE9mT2JqZWN0c1xuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZENsaWNrLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICBpZDogdGhpcy5kYXRhLlVJRC50b1N0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICBrZXk6IGZpZWxkQ2xpY2tFdmVudC5rZXksXG4gICAgICAgICAgICAgICAgICAgIGlkVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgd2hpY2g6IGZpZWxkQ2xpY2tFdmVudC5ldmVudFdoaWNoLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZmllbGRDbGlja0V2ZW50LnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sVHlwZTogZmllbGRDbGlja0V2ZW50LmNvbnRyb2xUeXBlLFxuICAgICAgICAgICAgICAgICAgICBmaWVsZFR5cGU6IGNsaWNrZWRVaUNvbnRyb2xGaWVsZC5GaWVsZFR5cGUsXG4gICAgICAgICAgICAgICAgICAgIG90aGVyRGF0YTogZmllbGRDbGlja0V2ZW50Lm90aGVyRGF0YSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZENsaWNrLmVtaXQoe1xuICAgICAgICAgICAgICAgICAgICBpZDogdGhpcy5kYXRhLlVJRC50b1N0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICBrZXk6IGZpZWxkQ2xpY2tFdmVudC5rZXksXG4gICAgICAgICAgICAgICAgICAgIGlkVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgd2hpY2g6IGZpZWxkQ2xpY2tFdmVudC5ldmVudFdoaWNoLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZmllbGRDbGlja0V2ZW50LnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sVHlwZTogZmllbGRDbGlja0V2ZW50LmNvbnRyb2xUeXBlLFxuICAgICAgICAgICAgICAgICAgICBmaWVsZFR5cGU6IGNsaWNrZWRVaUNvbnRyb2xGaWVsZC5GaWVsZFR5cGUsXG4gICAgICAgICAgICAgICAgICAgIG90aGVyRGF0YTogZmllbGRDbGlja0V2ZW50Lm90aGVyRGF0YSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEZvciBvdGhlciBhcGkgbmFtZXMgKGxpa2UgZW50ZXIgY2hpbGRyZW4gZXRjKS5cbiAgICAgICAgICAgIHRoaXMuZmllbGRDbGljay5lbWl0KHtcbiAgICAgICAgICAgICAgICBpZDogdGhpcy5kYXRhLlVJRC50b1N0cmluZygpLFxuICAgICAgICAgICAgICAgIGtleTogZmllbGRDbGlja0V2ZW50LmtleSxcbiAgICAgICAgICAgICAgICBpZFR5cGUsXG4gICAgICAgICAgICAgICAgd2hpY2g6IGZpZWxkQ2xpY2tFdmVudC5ldmVudFdoaWNoLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBmaWVsZENsaWNrRXZlbnQudmFsdWUsXG4gICAgICAgICAgICAgICAgY29udHJvbFR5cGU6IGZpZWxkQ2xpY2tFdmVudC5jb250cm9sVHlwZSxcbiAgICAgICAgICAgICAgICBvdGhlckRhdGE6IGZpZWxkQ2xpY2tFdmVudC5vdGhlckRhdGEsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIGdldEludGVybmFsTGlua0hyZWYoKTogc3RyaW5nIHtcbiAgICAvLyAgICAgbGV0IGhyZWZTdHIgPSAnJztcbiAgICAvLyAgICAgY29uc3QgdWlkID0gdGhpcy5kYXRhLlVJRDtcbiAgICAvLyAgICAgY29uc3QgdHJhbnNhY3Rpb25VcmwgPVxuICAgIC8vICAgICAgICAgdGhpcy5kYXRhLk1haW5BY3Rpb24gPT09ICcyJ1xuICAgIC8vICAgICAgICAgICAgID8gJ3RyYW5zYWN0aW9ucy9zY29wZV9pdGVtcy8nXG4gICAgLy8gICAgICAgICAgICAgOiAndHJhbnNhY3Rpb25zL2NhcnQvJztcbiAgICAvLyAgICAgLy8gbGV0IGlzQnV5ZXIgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCd1c2VyUm9sZScpID09ICdCdXllcicgPyB0cnVlIDogZmFsc2U7XG5cbiAgICAvLyAgICAgaWYgKHRoaXMubGlzdFR5cGUgPT09ICdhbGxfYWN0aXZpdGllcycpIHtcbiAgICAvLyAgICAgICAgIGhyZWZTdHIgPVxuICAgIC8vICAgICAgICAgICAgIHRoaXMuZGF0YS5UeXBlID09PSAwXG4gICAgLy8gICAgICAgICAgICAgICAgID8gdHJhbnNhY3Rpb25VcmwgKyB1aWRcbiAgICAvLyAgICAgICAgICAgICAgICAgOiAnYWN0aXZpdGllcy9kZXRhaWxzLycgKyB1aWQ7XG4gICAgLy8gICAgIH0gZWxzZSBpZiAodGhpcy5saXN0VHlwZSA9PT0gJ2FjY291bnRzJykge1xuICAgIC8vICAgICAgICAgaHJlZlN0ciA9ICdhY2NvdW50cy9ob21lX3BhZ2UvJyArIHVpZDtcbiAgICAvLyAgICAgfVxuXG4gICAgLy8gICAgIHJldHVybiBocmVmU3RyO1xuICAgIC8vIH1cbn1cbiJdfQ==