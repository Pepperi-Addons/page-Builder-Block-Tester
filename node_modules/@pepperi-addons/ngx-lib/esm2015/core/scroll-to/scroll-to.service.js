import { Injectable } from '@angular/core';
import { Subject } from 'rxjs';
import * as i0 from "@angular/core";
export class PepScrollToService {
    scrollElementTo(element, duration = 500, top = 0) {
        const subject = new Subject();
        if (element instanceof Element || element instanceof Window) {
            this._scrollElementTo(element, duration, top, subject);
        }
        else {
            subject.error("I don't find element");
        }
        return subject;
    }
    _scrollElementTo(el, duration, top, subject) {
        if (el) {
            let startingY;
            if (el instanceof Window) {
                startingY = window.pageYOffset;
            }
            else {
                const viewportOffset = el.getBoundingClientRect();
                startingY = viewportOffset.top;
            }
            this.doScrolling(el, startingY, top, duration, subject);
        }
        else {
            subject.error("I don't find element");
        }
        return subject;
    }
    scrollWindowToElement(element, duration = 500, offset = 0) {
        const subject = new Subject();
        if (typeof element === 'string') {
            const el = document.querySelector(element);
            this._scrollWindowToElement(el, duration, offset, subject);
        }
        else if (element instanceof HTMLElement) {
            this._scrollWindowToElement(element, duration, offset, subject);
        }
        else {
            subject.error("I don't find element");
        }
        return subject;
    }
    _scrollWindowToElement(el, duration, offset, subject) {
        if (el) {
            const viewportOffset = el.getBoundingClientRect();
            const startingY = window.pageYOffset;
            const offsetTop = viewportOffset.top + startingY;
            this.doScrolling(window, startingY, offsetTop + offset, duration, subject);
        }
        else {
            subject.error("I don't find element");
        }
        return subject;
    }
    doScrolling(scrollingElement, startingY, elementY, duration, subject) {
        const diff = elementY - startingY;
        let start;
        requestAnimationFrame(function step(timestamp) {
            start = !start ? timestamp : start;
            const time = timestamp - start;
            const percent = Math.min(time / duration, 1);
            scrollingElement.scrollTo(0, startingY + diff * percent);
            if (time < duration) {
                requestAnimationFrame(step);
                subject.next({});
            }
            else {
                subject.complete();
            }
        });
    }
}
PepScrollToService.ɵprov = i0.ɵɵdefineInjectable({ factory: function PepScrollToService_Factory() { return new PepScrollToService(); }, token: PepScrollToService, providedIn: "root" });
PepScrollToService.decorators = [
    { type: Injectable, args: [{
                providedIn: 'root',
            },] }
];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2Nyb2xsLXRvLnNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9uZ3gtbGliL3NyYy9jb3JlL3Njcm9sbC10by9zY3JvbGwtdG8uc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFBYyxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7O0FBSzNDLE1BQU0sT0FBTyxrQkFBa0I7SUFDcEIsZUFBZSxDQUNsQixPQUF5QixFQUN6QixRQUFRLEdBQUcsR0FBRyxFQUNkLEdBQUcsR0FBRyxDQUFDO1FBRVAsTUFBTSxPQUFPLEdBQWlCLElBQUksT0FBTyxFQUFPLENBQUM7UUFDakQsSUFBSSxPQUFPLFlBQVksT0FBTyxJQUFJLE9BQU8sWUFBWSxNQUFNLEVBQUU7WUFDekQsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxRQUFRLEVBQUUsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1NBQzFEO2FBQU07WUFDSCxPQUFPLENBQUMsS0FBSyxDQUFDLHNCQUFzQixDQUFDLENBQUM7U0FDekM7UUFFRCxPQUFPLE9BQU8sQ0FBQztJQUNuQixDQUFDO0lBRU8sZ0JBQWdCLENBQ3BCLEVBQW9CLEVBQ3BCLFFBQWdCLEVBQ2hCLEdBQVcsRUFDWCxPQUFxQjtRQUVyQixJQUFJLEVBQUUsRUFBRTtZQUNKLElBQUksU0FBaUIsQ0FBQztZQUN0QixJQUFJLEVBQUUsWUFBWSxNQUFNLEVBQUU7Z0JBQ3RCLFNBQVMsR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDO2FBQ2xDO2lCQUFNO2dCQUNILE1BQU0sY0FBYyxHQUFJLEVBQWMsQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO2dCQUMvRCxTQUFTLEdBQUcsY0FBYyxDQUFDLEdBQUcsQ0FBQzthQUNsQztZQUNELElBQUksQ0FBQyxXQUFXLENBQUMsRUFBRSxFQUFFLFNBQVMsRUFBRSxHQUFHLEVBQUUsUUFBUSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1NBQzNEO2FBQU07WUFDSCxPQUFPLENBQUMsS0FBSyxDQUFDLHNCQUFzQixDQUFDLENBQUM7U0FDekM7UUFFRCxPQUFPLE9BQU8sQ0FBQztJQUNuQixDQUFDO0lBRU0scUJBQXFCLENBQ3hCLE9BQTZCLEVBQzdCLFFBQVEsR0FBRyxHQUFHLEVBQ2QsTUFBTSxHQUFHLENBQUM7UUFFVixNQUFNLE9BQU8sR0FBaUIsSUFBSSxPQUFPLEVBQU8sQ0FBQztRQUNqRCxJQUFJLE9BQU8sT0FBTyxLQUFLLFFBQVEsRUFBRTtZQUM3QixNQUFNLEVBQUUsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLE9BQWlCLENBQUMsQ0FBQztZQUNyRCxJQUFJLENBQUMsc0JBQXNCLENBQ3ZCLEVBQWlCLEVBQ2pCLFFBQVEsRUFDUixNQUFNLEVBQ04sT0FBTyxDQUNWLENBQUM7U0FDTDthQUFNLElBQUksT0FBTyxZQUFZLFdBQVcsRUFBRTtZQUN2QyxJQUFJLENBQUMsc0JBQXNCLENBQUMsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUM7U0FDbkU7YUFBTTtZQUNILE9BQU8sQ0FBQyxLQUFLLENBQUMsc0JBQXNCLENBQUMsQ0FBQztTQUN6QztRQUVELE9BQU8sT0FBTyxDQUFDO0lBQ25CLENBQUM7SUFFTyxzQkFBc0IsQ0FDMUIsRUFBZSxFQUNmLFFBQWdCLEVBQ2hCLE1BQWMsRUFDZCxPQUFxQjtRQUVyQixJQUFJLEVBQUUsRUFBRTtZQUNKLE1BQU0sY0FBYyxHQUFHLEVBQUUsQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO1lBQ2xELE1BQU0sU0FBUyxHQUFHLE1BQU0sQ0FBQyxXQUFXLENBQUM7WUFDckMsTUFBTSxTQUFTLEdBQUcsY0FBYyxDQUFDLEdBQUcsR0FBRyxTQUFTLENBQUM7WUFDakQsSUFBSSxDQUFDLFdBQVcsQ0FDWixNQUFNLEVBQ04sU0FBUyxFQUNULFNBQVMsR0FBRyxNQUFNLEVBQ2xCLFFBQVEsRUFDUixPQUFPLENBQ1YsQ0FBQztTQUNMO2FBQU07WUFDSCxPQUFPLENBQUMsS0FBSyxDQUFDLHNCQUFzQixDQUFDLENBQUM7U0FDekM7UUFFRCxPQUFPLE9BQU8sQ0FBQztJQUNuQixDQUFDO0lBRU8sV0FBVyxDQUNmLGdCQUFrQyxFQUNsQyxTQUFpQixFQUNqQixRQUFnQixFQUNoQixRQUFnQixFQUNoQixPQUFxQjtRQUVyQixNQUFNLElBQUksR0FBRyxRQUFRLEdBQUcsU0FBUyxDQUFDO1FBQ2xDLElBQUksS0FBSyxDQUFDO1FBRVYscUJBQXFCLENBQUMsU0FBUyxJQUFJLENBQUMsU0FBUztZQUN6QyxLQUFLLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDO1lBRW5DLE1BQU0sSUFBSSxHQUFHLFNBQVMsR0FBRyxLQUFLLENBQUM7WUFDL0IsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEdBQUcsUUFBUSxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBRTdDLGdCQUFnQixDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsU0FBUyxHQUFHLElBQUksR0FBRyxPQUFPLENBQUMsQ0FBQztZQUV6RCxJQUFJLElBQUksR0FBRyxRQUFRLEVBQUU7Z0JBQ2pCLHFCQUFxQixDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUM1QixPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO2FBQ3BCO2lCQUFNO2dCQUNILE9BQU8sQ0FBQyxRQUFRLEVBQUUsQ0FBQzthQUN0QjtRQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQzs7OztZQWpISixVQUFVLFNBQUM7Z0JBQ1IsVUFBVSxFQUFFLE1BQU07YUFDckIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XG5cbkBJbmplY3RhYmxlKHtcbiAgICBwcm92aWRlZEluOiAncm9vdCcsXG59KVxuZXhwb3J0IGNsYXNzIFBlcFNjcm9sbFRvU2VydmljZSB7XG4gICAgcHVibGljIHNjcm9sbEVsZW1lbnRUbyhcbiAgICAgICAgZWxlbWVudDogRWxlbWVudCB8IFdpbmRvdyxcbiAgICAgICAgZHVyYXRpb24gPSA1MDAsXG4gICAgICAgIHRvcCA9IDBcbiAgICApOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgICAgICBjb25zdCBzdWJqZWN0OiBTdWJqZWN0PGFueT4gPSBuZXcgU3ViamVjdDxhbnk+KCk7XG4gICAgICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YgRWxlbWVudCB8fCBlbGVtZW50IGluc3RhbmNlb2YgV2luZG93KSB7XG4gICAgICAgICAgICB0aGlzLl9zY3JvbGxFbGVtZW50VG8oZWxlbWVudCwgZHVyYXRpb24sIHRvcCwgc3ViamVjdCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdWJqZWN0LmVycm9yKFwiSSBkb24ndCBmaW5kIGVsZW1lbnRcIik7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc3ViamVjdDtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9zY3JvbGxFbGVtZW50VG8oXG4gICAgICAgIGVsOiBFbGVtZW50IHwgV2luZG93LFxuICAgICAgICBkdXJhdGlvbjogbnVtYmVyLFxuICAgICAgICB0b3A6IG51bWJlcixcbiAgICAgICAgc3ViamVjdDogU3ViamVjdDxhbnk+XG4gICAgKTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICAgICAgaWYgKGVsKSB7XG4gICAgICAgICAgICBsZXQgc3RhcnRpbmdZOiBudW1iZXI7XG4gICAgICAgICAgICBpZiAoZWwgaW5zdGFuY2VvZiBXaW5kb3cpIHtcbiAgICAgICAgICAgICAgICBzdGFydGluZ1kgPSB3aW5kb3cucGFnZVlPZmZzZXQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IHZpZXdwb3J0T2Zmc2V0ID0gKGVsIGFzIEVsZW1lbnQpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICAgICAgICAgIHN0YXJ0aW5nWSA9IHZpZXdwb3J0T2Zmc2V0LnRvcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZG9TY3JvbGxpbmcoZWwsIHN0YXJ0aW5nWSwgdG9wLCBkdXJhdGlvbiwgc3ViamVjdCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdWJqZWN0LmVycm9yKFwiSSBkb24ndCBmaW5kIGVsZW1lbnRcIik7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc3ViamVjdDtcbiAgICB9XG5cbiAgICBwdWJsaWMgc2Nyb2xsV2luZG93VG9FbGVtZW50KFxuICAgICAgICBlbGVtZW50OiBzdHJpbmcgfCBIVE1MRWxlbWVudCxcbiAgICAgICAgZHVyYXRpb24gPSA1MDAsXG4gICAgICAgIG9mZnNldCA9IDBcbiAgICApOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgICAgICBjb25zdCBzdWJqZWN0OiBTdWJqZWN0PGFueT4gPSBuZXcgU3ViamVjdDxhbnk+KCk7XG4gICAgICAgIGlmICh0eXBlb2YgZWxlbWVudCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50IGFzIHN0cmluZyk7XG4gICAgICAgICAgICB0aGlzLl9zY3JvbGxXaW5kb3dUb0VsZW1lbnQoXG4gICAgICAgICAgICAgICAgZWwgYXMgSFRNTEVsZW1lbnQsXG4gICAgICAgICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgb2Zmc2V0LFxuICAgICAgICAgICAgICAgIHN1YmplY3RcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XG4gICAgICAgICAgICB0aGlzLl9zY3JvbGxXaW5kb3dUb0VsZW1lbnQoZWxlbWVudCwgZHVyYXRpb24sIG9mZnNldCwgc3ViamVjdCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdWJqZWN0LmVycm9yKFwiSSBkb24ndCBmaW5kIGVsZW1lbnRcIik7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc3ViamVjdDtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9zY3JvbGxXaW5kb3dUb0VsZW1lbnQoXG4gICAgICAgIGVsOiBIVE1MRWxlbWVudCxcbiAgICAgICAgZHVyYXRpb246IG51bWJlcixcbiAgICAgICAgb2Zmc2V0OiBudW1iZXIsXG4gICAgICAgIHN1YmplY3Q6IFN1YmplY3Q8YW55PlxuICAgICk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgICAgIGlmIChlbCkge1xuICAgICAgICAgICAgY29uc3Qgdmlld3BvcnRPZmZzZXQgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0aW5nWSA9IHdpbmRvdy5wYWdlWU9mZnNldDtcbiAgICAgICAgICAgIGNvbnN0IG9mZnNldFRvcCA9IHZpZXdwb3J0T2Zmc2V0LnRvcCArIHN0YXJ0aW5nWTtcbiAgICAgICAgICAgIHRoaXMuZG9TY3JvbGxpbmcoXG4gICAgICAgICAgICAgICAgd2luZG93LFxuICAgICAgICAgICAgICAgIHN0YXJ0aW5nWSxcbiAgICAgICAgICAgICAgICBvZmZzZXRUb3AgKyBvZmZzZXQsXG4gICAgICAgICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgc3ViamVjdFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN1YmplY3QuZXJyb3IoXCJJIGRvbid0IGZpbmQgZWxlbWVudFwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzdWJqZWN0O1xuICAgIH1cblxuICAgIHByaXZhdGUgZG9TY3JvbGxpbmcoXG4gICAgICAgIHNjcm9sbGluZ0VsZW1lbnQ6IEVsZW1lbnQgfCBXaW5kb3csXG4gICAgICAgIHN0YXJ0aW5nWTogbnVtYmVyLFxuICAgICAgICBlbGVtZW50WTogbnVtYmVyLFxuICAgICAgICBkdXJhdGlvbjogbnVtYmVyLFxuICAgICAgICBzdWJqZWN0OiBTdWJqZWN0PGFueT5cbiAgICApOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZGlmZiA9IGVsZW1lbnRZIC0gc3RhcnRpbmdZO1xuICAgICAgICBsZXQgc3RhcnQ7XG5cbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uIHN0ZXAodGltZXN0YW1wKSB7XG4gICAgICAgICAgICBzdGFydCA9ICFzdGFydCA/IHRpbWVzdGFtcCA6IHN0YXJ0O1xuXG4gICAgICAgICAgICBjb25zdCB0aW1lID0gdGltZXN0YW1wIC0gc3RhcnQ7XG4gICAgICAgICAgICBjb25zdCBwZXJjZW50ID0gTWF0aC5taW4odGltZSAvIGR1cmF0aW9uLCAxKTtcblxuICAgICAgICAgICAgc2Nyb2xsaW5nRWxlbWVudC5zY3JvbGxUbygwLCBzdGFydGluZ1kgKyBkaWZmICogcGVyY2VudCk7XG5cbiAgICAgICAgICAgIGlmICh0aW1lIDwgZHVyYXRpb24pIHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoc3RlcCk7XG4gICAgICAgICAgICAgICAgc3ViamVjdC5uZXh0KHt9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc3ViamVjdC5jb21wbGV0ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG4iXX0=