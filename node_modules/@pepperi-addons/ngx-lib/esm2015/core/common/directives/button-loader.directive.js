import { DOCUMENT } from '@angular/common';
import { Directive, ElementRef, HostListener, Inject, Input, Optional, Renderer2, } from '@angular/core';
import { PepUtilitiesService } from '../services/utilities.service';
export class PepButtonLoaderDirective {
    constructor(renderer, element, utilitiesService, document) {
        this.renderer = renderer;
        this.element = element;
        this.utilitiesService = utilitiesService;
        this.document = document;
        this.loaderTime = 0;
        this.loaderColor = null;
        this.loaderWidth = '1.5rem';
        this.loaderHeight = 'inherit';
        this.ignoreDisabledStyle = false;
        this._isLoading = false;
        this._finish = null;
    }
    set finish(value) {
        this._finish = value;
        if (this._isLoading && value) {
            this.toggleLoading(false);
        }
    }
    clickEvent(event) {
        this.toggleLoading(true);
        // In case that the finish input is supplied - init it.
        if (this._finish !== null) {
            this._finish = false;
        }
        else {
            // Init loaderTime if is not supplied (3000 - default 3 seconds).
            if (this.loaderTime === 0) {
                this.loaderTime = 3000;
            }
        }
        if (this.loaderTime > 0) {
            setTimeout(() => {
                this.toggleLoading(false);
            }, this.loaderTime);
        }
    }
    ngOnInit() {
        this.setButtonStyle();
        const svgData = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128" preserveAspectRatio="xMidYMid" class="lds-ripple" style="background:0 0; "><circle cx="64" cy="64" r="0" fill="none" stroke-width="10"><animate attributeName="r" calcMode="spline" values="0;59" keyTimes="0;1" dur="2.4" keySplines="0 0.3 0.8 0.8" begin="-1.6s" repeatCount="indefinite"/><animate attributeName="opacity" calcMode="spline" values="1;0" keyTimes="0;1" dur="2.4" keySplines="0.3 0 0.8 1" begin="-1.6s" repeatCount="indefinite"/></circle><circle cx="64" cy="64" r="0" fill="none" stroke-width="10"><animate attributeName="r" calcMode="spline" values="0;59" keyTimes="0;1" dur="2.4" keySplines="0 0.3 0.8 0.8" begin="-0.8s" repeatCount="indefinite"/><animate attributeName="opacity" calcMode="spline" values="1;0" keyTimes="0;1" dur="2.4" keySplines="0.3 0 0.8 1" begin="-0.8s" repeatCount="indefinite"/></circle><circle cx="64" cy="64" r="0" fill="none" stroke-width="10"><animate attributeName="r" calcMode="spline" values="0;59" keyTimes="0;1" dur="2.4" keySplines="0 0.3 0.8 0.8" begin="0s" repeatCount="indefinite"/><animate attributeName="opacity" calcMode="spline" values="1;0" keyTimes="0;1" dur="2.4" keySplines="0.3 0 0.8 1" begin="0s" repeatCount="indefinite"/></circle></svg>';
        this.svgIcon = this.utilitiesService.getSvgElementFromString(this.document, svgData);
        this.setIconStyle();
    }
    setButtonStyle() {
        this.renderer.setStyle(this.element.nativeElement, 'display', 'flex');
        this.renderer.setStyle(this.element.nativeElement, 'justify-content', 'center');
        this.renderer.setStyle(this.element.nativeElement, 'align-items', 'center');
        if (this.ignoreDisabledStyle) {
            this.renderer.addClass(this.element.nativeElement, 'ignore-disabled');
        }
    }
    setIconStyle() {
        if (this.loaderColor) {
            this.renderer.setStyle(this.svgIcon, 'stroke', this.loaderColor);
        }
        this.renderer.setStyle(this.svgIcon, 'width', this.loaderWidth);
        this.renderer.setStyle(this.svgIcon, 'height', this.loaderHeight);
        this.renderer.setStyle(this.svgIcon, 'margin-inline-start', '0.5rem');
        this.renderer.addClass(this.svgIcon, 'svg-icon');
        this.renderer.addClass(this.svgIcon, 'stroke');
    }
    toggleLoading(show) {
        if (show) {
            this._isLoading = true;
            this.renderer.appendChild(this.element.nativeElement, this.svgIcon);
            this.renderer.setAttribute(this.element.nativeElement, 'disabled', 'true');
            this.renderer.addClass(this.element.nativeElement, 'lock-events');
        }
        else {
            if (this._isLoading) {
                this._isLoading = false;
                this.renderer.removeChild(this.element.nativeElement, this.svgIcon);
                this.renderer.removeAttribute(this.element.nativeElement, 'disabled');
                this.renderer.removeClass(this.element.nativeElement, 'lock-events');
            }
        }
    }
}
PepButtonLoaderDirective.decorators = [
    { type: Directive, args: [{
                selector: '[pepButtonLoader]',
            },] }
];
PepButtonLoaderDirective.ctorParameters = () => [
    { type: Renderer2 },
    { type: ElementRef },
    { type: PepUtilitiesService },
    { type: undefined, decorators: [{ type: Optional }, { type: Inject, args: [DOCUMENT,] }] }
];
PepButtonLoaderDirective.propDecorators = {
    loaderTime: [{ type: Input }],
    loaderColor: [{ type: Input }],
    loaderWidth: [{ type: Input }],
    loaderHeight: [{ type: Input }],
    ignoreDisabledStyle: [{ type: Input }],
    finish: [{ type: Input }],
    clickEvent: [{ type: HostListener, args: ['click', ['$event'],] }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnV0dG9uLWxvYWRlci5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9uZ3gtbGliL3NyYy9jb3JlL2NvbW1vbi9kaXJlY3RpdmVzL2J1dHRvbi1sb2FkZXIuZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUMzQyxPQUFPLEVBQ0gsU0FBUyxFQUNULFVBQVUsRUFDVixZQUFZLEVBQ1osTUFBTSxFQUNOLEtBQUssRUFFTCxRQUFRLEVBQ1IsU0FBUyxHQUNaLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBS3BFLE1BQU0sT0FBTyx3QkFBd0I7SUFvQmpDLFlBQ1ksUUFBbUIsRUFDbkIsT0FBbUIsRUFDbkIsZ0JBQXFDLEVBQ1AsUUFBYTtRQUgzQyxhQUFRLEdBQVIsUUFBUSxDQUFXO1FBQ25CLFlBQU8sR0FBUCxPQUFPLENBQVk7UUFDbkIscUJBQWdCLEdBQWhCLGdCQUFnQixDQUFxQjtRQUNQLGFBQVEsR0FBUixRQUFRLENBQUs7UUF2QjlDLGVBQVUsR0FBRyxDQUFDLENBQUM7UUFDZixnQkFBVyxHQUFHLElBQUksQ0FBQztRQUNuQixnQkFBVyxHQUFHLFFBQVEsQ0FBQztRQUN2QixpQkFBWSxHQUFHLFNBQVMsQ0FBQztRQUN6Qix3QkFBbUIsR0FBRyxLQUFLLENBQUM7UUFFN0IsZUFBVSxHQUFHLEtBQUssQ0FBQztRQUNuQixZQUFPLEdBQUcsSUFBSSxDQUFDO0lBaUJwQixDQUFDO0lBaEJKLElBQ0ksTUFBTSxDQUFDLEtBQWM7UUFDckIsSUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7UUFFckIsSUFBSSxJQUFJLENBQUMsVUFBVSxJQUFJLEtBQUssRUFBRTtZQUMxQixJQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FB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LENBQUM7WUFDcEUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQ3RCLElBQUksQ0FBQyxPQUFPLENBQUMsYUFBYSxFQUMxQixVQUFVLEVBQ1YsTUFBTSxDQUNULENBQUM7WUFDRixJQUFJLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLGFBQWEsRUFBRSxhQUFhLENBQUMsQ0FBQztTQUNyRTthQUFNO1lBQ0gsSUFBSSxJQUFJLENBQUMsVUFBVSxFQUFFO2dCQUNqQixJQUFJLENBQUMsVUFBVSxHQUFHLEtBQUssQ0FBQztnQkFDeEIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQ3JCLElBQUksQ0FBQyxPQUFPLENBQUMsYUFBYSxFQUMxQixJQUFJLENBQUMsT0FBTyxDQUNmLENBQUM7Z0JBQ0YsSUFBSSxDQUFDLFFBQVEsQ0FBQyxlQUFlLENBQ3pCLElBQUksQ0FBQyxPQUFPLENBQUMsYUFBYSxFQUMxQixVQUFVLENBQ2IsQ0FBQztnQkFDRixJQUFJLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FDckIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLEVBQzFCLGFBQWEsQ0FDaEIsQ0FBQzthQUNMO1NBQ0o7SUFDTCxDQUFDOzs7WUExSEosU0FBUyxTQUFDO2dCQUNQLFFBQVEsRUFBRSxtQkFBbUI7YUFDaEM7OztZQU5HLFNBQVM7WUFOVCxVQUFVO1lBUUwsbUJBQW1COzRDQTZCbkIsUUFBUSxZQUFJLE1BQU0sU0FBQyxRQUFROzs7eUJBdkIvQixLQUFLOzBCQUNMLEtBQUs7MEJBQ0wsS0FBSzsyQkFDTCxLQUFLO2tDQUNMLEtBQUs7cUJBSUwsS0FBSzt5QkFrQkwsWUFBWSxTQUFDLE9BQU8sRUFBRSxDQUFDLFFBQVEsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERPQ1VNRU5UIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcbmltcG9ydCB7XG4gICAgRGlyZWN0aXZlLFxuICAgIEVsZW1lbnRSZWYsXG4gICAgSG9zdExpc3RlbmVyLFxuICAgIEluamVjdCxcbiAgICBJbnB1dCxcbiAgICBPbkluaXQsXG4gICAgT3B0aW9uYWwsXG4gICAgUmVuZGVyZXIyLFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFBlcFV0aWxpdGllc1NlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy91dGlsaXRpZXMuc2VydmljZSc7XG5cbkBEaXJlY3RpdmUoe1xuICAgIHNlbGVjdG9yOiAnW3BlcEJ1dHRvbkxvYWRlcl0nLFxufSlcbmV4cG9ydCBjbGFzcyBQZXBCdXR0b25Mb2FkZXJEaXJlY3RpdmUgaW1wbGVtZW50cyBPbkluaXQge1xuICAgIEBJbnB1dCgpIGxvYWRlclRpbWUgPSAwO1xuICAgIEBJbnB1dCgpIGxvYWRlckNvbG9yID0gbnVsbDtcbiAgICBASW5wdXQoKSBsb2FkZXJXaWR0aCA9ICcxLjVyZW0nO1xuICAgIEBJbnB1dCgpIGxvYWRlckhlaWdodCA9ICdpbmhlcml0JztcbiAgICBASW5wdXQoKSBpZ25vcmVEaXNhYmxlZFN0eWxlID0gZmFsc2U7XG5cbiAgICBwcml2YXRlIF9pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICBwcml2YXRlIF9maW5pc2ggPSBudWxsO1xuICAgIEBJbnB1dCgpXG4gICAgc2V0IGZpbmlzaCh2YWx1ZTogYm9vbGVhbikge1xuICAgICAgICB0aGlzLl9maW5pc2ggPSB2YWx1ZTtcblxuICAgICAgICBpZiAodGhpcy5faXNMb2FkaW5nICYmIHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUxvYWRpbmcoZmFsc2UpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdmdJY29uOiBTVkdFbGVtZW50O1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyMixcbiAgICAgICAgcHJpdmF0ZSBlbGVtZW50OiBFbGVtZW50UmVmLFxuICAgICAgICBwcml2YXRlIHV0aWxpdGllc1NlcnZpY2U6IFBlcFV0aWxpdGllc1NlcnZpY2UsXG4gICAgICAgIEBPcHRpb25hbCgpIEBJbmplY3QoRE9DVU1FTlQpIHByaXZhdGUgZG9jdW1lbnQ6IGFueVxuICAgICkge31cblxuICAgIEBIb3N0TGlzdGVuZXIoJ2NsaWNrJywgWyckZXZlbnQnXSlcbiAgICBjbGlja0V2ZW50KGV2ZW50KTogdm9pZCB7XG4gICAgICAgIHRoaXMudG9nZ2xlTG9hZGluZyh0cnVlKTtcblxuICAgICAgICAvLyBJbiBjYXNlIHRoYXQgdGhlIGZpbmlzaCBpbnB1dCBpcyBzdXBwbGllZCAtIGluaXQgaXQuXG4gICAgICAgIGlmICh0aGlzLl9maW5pc2ggIT09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuX2ZpbmlzaCA9IGZhbHNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gSW5pdCBsb2FkZXJUaW1lIGlmIGlzIG5vdCBzdXBwbGllZCAoMzAwMCAtIGRlZmF1bHQgMyBzZWNvbmRzKS5cbiAgICAgICAgICAgIGlmICh0aGlzLmxvYWRlclRpbWUgPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWRlclRpbWUgPSAzMDAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMubG9hZGVyVGltZSA+IDApIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlTG9hZGluZyhmYWxzZSk7XG4gICAgICAgICAgICB9LCB0aGlzLmxvYWRlclRpbWUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc2V0QnV0dG9uU3R5bGUoKTtcbiAgICAgICAgY29uc3Qgc3ZnRGF0YSA9XG4gICAgICAgICAgICAnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCAxMjggMTI4XCIgcHJlc2VydmVBc3BlY3RSYXRpbz1cInhNaWRZTWlkXCIgY2xhc3M9XCJsZHMtcmlwcGxlXCIgc3R5bGU9XCJiYWNrZ3JvdW5kOjAgMDsgXCI+PGNpcmNsZSBjeD1cIjY0XCIgY3k9XCI2NFwiIHI9XCIwXCIgZmlsbD1cIm5vbmVcIiBzdHJva2Utd2lkdGg9XCIxMFwiPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9XCJyXCIgY2FsY01vZGU9XCJzcGxpbmVcIiB2YWx1ZXM9XCIwOzU5XCIga2V5VGltZXM9XCIwOzFcIiBkdXI9XCIyLjRcIiBrZXlTcGxpbmVzPVwiMCAwLjMgMC44IDAuOFwiIGJlZ2luPVwiLTEuNnNcIiByZXBlYXRDb3VudD1cImluZGVmaW5pdGVcIi8+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT1cIm9wYWNpdHlcIiBjYWxjTW9kZT1cInNwbGluZVwiIHZhbHVlcz1cIjE7MFwiIGtleVRpbWVzPVwiMDsxXCIgZHVyPVwiMi40XCIga2V5U3BsaW5lcz1cIjAuMyAwIDAuOCAxXCIgYmVnaW49XCItMS42c1wiIHJlcGVhdENvdW50PVwiaW5kZWZpbml0ZVwiLz48L2NpcmNsZT48Y2lyY2xlIGN4PVwiNjRcIiBjeT1cIjY0XCIgcj1cIjBcIiBmaWxsPVwibm9uZVwiIHN0cm9rZS13aWR0aD1cIjEwXCI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT1cInJcIiBjYWxjTW9kZT1cInNwbGluZVwiIHZhbHVlcz1cIjA7NTlcIiBrZXlUaW1lcz1cIjA7MVwiIGR1cj1cIjIuNFwiIGtleVNwbGluZXM9XCIwIDAuMyAwLjggMC44XCIgYmVnaW49XCItMC44c1wiIHJlcGVhdENvdW50PVwiaW5kZWZpbml0ZVwiLz48YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPVwib3BhY2l0eVwiIGNhbGNNb2RlPVwic3BsaW5lXCIgdmFsdWVzPVwiMTswXCIga2V5VGltZXM9XCIwOzFcIiBkdXI9XCIyLjRcIiBrZXlTcGxpbmVzPVwiMC4zIDAgMC44IDFcIiBiZWdpbj1cIi0wLjhzXCIgcmVwZWF0Q291bnQ9XCJpbmRlZmluaXRlXCIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9XCI2NFwiIGN5PVwiNjRcIiByPVwiMFwiIGZpbGw9XCJub25lXCIgc3Ryb2tlLXdpZHRoPVwiMTBcIj48YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPVwiclwiIGNhbGNNb2RlPVwic3BsaW5lXCIgdmFsdWVzPVwiMDs1OVwiIGtleVRpbWVzPVwiMDsxXCIgZHVyPVwiMi40XCIga2V5U3BsaW5lcz1cIjAgMC4zIDAuOCAwLjhcIiBiZWdpbj1cIjBzXCIgcmVwZWF0Q291bnQ9XCJpbmRlZmluaXRlXCIvPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9XCJvcGFjaXR5XCIgY2FsY01vZGU9XCJzcGxpbmVcIiB2YWx1ZXM9XCIxOzBcIiBrZXlUaW1lcz1cIjA7MVwiIGR1cj1cIjIuNFwiIGtleVNwbGluZXM9XCIwLjMgMCAwLjggMVwiIGJlZ2luPVwiMHNcIiByZXBlYXRDb3VudD1cImluZGVmaW5pdGVcIi8+PC9jaXJjbGU+PC9zdmc+JztcbiAgICAgICAgdGhpcy5zdmdJY29uID0gdGhpcy51dGlsaXRpZXNTZXJ2aWNlLmdldFN2Z0VsZW1lbnRGcm9tU3RyaW5nKFxuICAgICAgICAgICAgdGhpcy5kb2N1bWVudCxcbiAgICAgICAgICAgIHN2Z0RhdGFcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5zZXRJY29uU3R5bGUoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNldEJ1dHRvblN0eWxlKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50LCAnZGlzcGxheScsICdmbGV4Jyk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUoXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudCxcbiAgICAgICAgICAgICdqdXN0aWZ5LWNvbnRlbnQnLFxuICAgICAgICAgICAgJ2NlbnRlcidcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZShcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50LFxuICAgICAgICAgICAgJ2FsaWduLWl0ZW1zJyxcbiAgICAgICAgICAgICdjZW50ZXInXG4gICAgICAgICk7XG5cbiAgICAgICAgaWYgKHRoaXMuaWdub3JlRGlzYWJsZWRTdHlsZSkge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyhcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudCxcbiAgICAgICAgICAgICAgICAnaWdub3JlLWRpc2FibGVkJ1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgc2V0SWNvblN0eWxlKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5sb2FkZXJDb2xvcikge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLnN2Z0ljb24sICdzdHJva2UnLCB0aGlzLmxvYWRlckNvbG9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy5zdmdJY29uLCAnd2lkdGgnLCB0aGlzLmxvYWRlcldpZHRoKTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLnN2Z0ljb24sICdoZWlnaHQnLCB0aGlzLmxvYWRlckhlaWdodCk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy5zdmdJY29uLCAnbWFyZ2luLWlubGluZS1zdGFydCcsICcwLjVyZW0nKTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLnN2Z0ljb24sICdzdmctaWNvbicpO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMuc3ZnSWNvbiwgJ3N0cm9rZScpO1xuICAgIH1cblxuICAgIHByaXZhdGUgdG9nZ2xlTG9hZGluZyhzaG93OiBib29sZWFuKTogdm9pZCB7XG4gICAgICAgIGlmIChzaG93KSB7XG4gICAgICAgICAgICB0aGlzLl9pc0xvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudCwgdGhpcy5zdmdJY29uKTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuc2V0QXR0cmlidXRlKFxuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50LFxuICAgICAgICAgICAgICAgICdkaXNhYmxlZCcsXG4gICAgICAgICAgICAgICAgJ3RydWUnXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudCwgJ2xvY2stZXZlbnRzJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAodGhpcy5faXNMb2FkaW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDaGlsZChcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3ZnSWNvblxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVBdHRyaWJ1dGUoXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50LFxuICAgICAgICAgICAgICAgICAgICAnZGlzYWJsZWQnXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbW92ZUNsYXNzKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgJ2xvY2stZXZlbnRzJ1xuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4iXX0=