import { Injectable } from '@angular/core';
import { FieldLayout, ObjectsDataRow, UIControl, UIControlField, ObjectsDataRowCell, X_ALIGNMENT_TYPE, } from '../model/wapi.model';
import { PepGuid } from '../model/utilities.model';
import * as i0 from "@angular/core";
export class PepFieldData {
    constructor(options = {}) {
        this.ApiName = options.ApiName;
        this.Enabled = !!options.Enabled;
        this.Value = options.Value;
        this.FormattedValue = options.FormattedValue || '';
        this.FieldType = options.FieldType;
        this.ReadOnly = !!options.ReadOnly;
        this.ColumnWidth = options.ColumnWidth;
        this.ColumnWidthType = options.ColumnWidthType;
        this.XAlignment = options.XAlignment || X_ALIGNMENT_TYPE.Left;
        this.Title = options.Title || '';
    }
}
export class PepRowData {
}
export class PepDataConvertorService {
    getUiControl(formData) {
        var _a;
        const uiControl = new UIControl();
        if (((_a = formData === null || formData === void 0 ? void 0 : formData.Fields) === null || _a === void 0 ? void 0 : _a.length) > 0) {
            const uiRow = formData.Fields;
            uiControl.ControlFields = [];
            uiRow.forEach((field) => uiControl.ControlFields.push(this.setUIControlField(field)));
        }
        return uiControl;
    }
    convertFormData(formData) {
        const rowData = new ObjectsDataRow();
        rowData.Fields = [];
        rowData.Type = 0;
        rowData.UID = PepGuid.newGuid();
        formData.Fields.forEach((field) => rowData.Fields.push(this.setDataField(field)));
        return rowData;
    }
    convertListData(tableData, rowUUID = '') {
        const rows = new Array();
        if (tableData.length > 0) {
            tableData.forEach((row) => {
                const rowData = new ObjectsDataRow();
                rowData.Fields = [];
                rowData.Type = 0;
                rowData.UID = rowUUID
                    ? rowUUID
                    : row.UUID
                        ? row.UUID
                        : PepGuid.newGuid();
                row.Fields.forEach((field) => rowData.Fields.push(this.setDataField(field)));
                rows.push(rowData);
            });
        }
        return rows;
    }
    setUIControlField(field) {
        const controlField = new UIControlField();
        controlField.ApiName = field.ApiName;
        controlField.FieldType = field.FieldType;
        controlField.Layout = new FieldLayout({
            X: 1,
            Width: 1,
            XAlignment: field.XAlignment,
            Y: 1,
            Height: 1,
            YAlignment: 1,
        });
        controlField.Title = field.Title;
        controlField.ReadOnly = field.ReadOnly === true ? true : false;
        controlField.ColumnWidth = field.ColumnWidth;
        controlField.ColumnWidthType = field.ColumnWidthType || 1;
        return controlField;
    }
    setDataField(field) {
        const dataField = new ObjectsDataRowCell();
        dataField.AdditionalValue = field.AdditionalValue;
        dataField.ApiName = field.ApiName;
        dataField.Enabled = field.Enabled === false ? false : true;
        dataField.FieldType = field.FieldType;
        dataField.FormattedValue =
            field.FormattedValue || field.Value.toString();
        dataField.GroupFields = null;
        dataField.NotificationInfo = '';
        dataField.OptionalValues = field.OptionalValues;
        dataField.ReferenceObjectSubType = '';
        dataField.TextColor = '';
        dataField.Value = field.Value.toString();
        dataField.Visible = true;
        return dataField;
    }
    setFieldLayout(x, width, xAlignment, y, height, yAlignment, lineNumber) {
        const layout = new FieldLayout({
            X: x,
            Width: width,
            XAlignment: xAlignment,
            Y: y,
            Height: height,
            YAlignment: yAlignment,
            LineNumber: lineNumber,
        });
        return layout;
    }
}
PepDataConvertorService.ɵprov = i0.ɵɵdefineInjectable({ factory: function PepDataConvertorService_Factory() { return new PepDataConvertorService(); }, token: PepDataConvertorService, providedIn: "root" });
PepDataConvertorService.decorators = [
    { type: Injectable, args: [{
                providedIn: 'root',
            },] }
];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YS1jb252ZXJ0b3Iuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL25neC1saWIvc3JjL2NvcmUvY29tbW9uL3NlcnZpY2VzL2RhdGEtY29udmVydG9yLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMzQyxPQUFPLEVBQ0gsV0FBVyxFQUNYLGNBQWMsRUFDZCxTQUFTLEVBQ1QsY0FBYyxFQUNkLGtCQUFrQixFQUVsQixnQkFBZ0IsR0FDbkIsTUFBTSxxQkFBcUIsQ0FBQztBQUM3QixPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sMEJBQTBCLENBQUM7O0FBRW5ELE1BQU0sT0FBTyxZQUFZO0lBY3JCLFlBQ0ksVUFXSSxFQUFFO1FBRU4sSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDO1FBQy9CLElBQUksQ0FBQyxPQUFPLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUM7UUFDakMsSUFBSSxDQUFDLEtBQUssR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDO1FBQzNCLElBQUksQ0FBQyxjQUFjLEdBQUcsT0FBTyxDQUFDLGNBQWMsSUFBSSxFQUFFLENBQUM7UUFDbkQsSUFBSSxDQUFDLFNBQVMsR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDO1FBQ25DLElBQUksQ0FBQyxRQUFRLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUM7UUFDbkMsSUFBSSxDQUFDLFdBQVcsR0FBRyxPQUFPLENBQUMsV0FBVyxDQUFDO1FBQ3ZDLElBQUksQ0FBQyxlQUFlLEdBQUcsT0FBTyxDQUFDLGVBQWUsQ0FBQztRQUMvQyxJQUFJLENBQUMsVUFBVSxHQUFHLE9BQU8sQ0FBQyxVQUFVLElBQUksZ0JBQWdCLENBQUMsSUFBSSxDQUFDO1FBQzlELElBQUksQ0FBQyxLQUFLLEdB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R0FBRyxFQUFFLENBQUM7UUFDekIsU0FBUyxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUMsS0FBSyxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQ3pDLFNBQVMsQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDO1FBQ3pCLE9BQU8sU0FBUyxDQUFDO0lBQ3JCLENBQUM7SUFFRCxjQUFjLENBQ1YsQ0FBUyxFQUNULEtBQWEsRUFDYixVQUFrQixFQUNsQixDQUFTLEVBQ1QsTUFBYyxFQUNkLFVBQWtCLEVBQ2xCLFVBQWtCO1FBRWxCLE1BQU0sTUFBTSxHQUFHLElBQUksV0FBVyxDQUFDO1lBQzNCLENBQUMsRUFBRSxDQUFDO1lBQ0osS0FBSyxFQUFFLEtBQUs7WUFDWixVQUFVLEVBQUUsVUFBVTtZQUN0QixDQUFDLEVBQUUsQ0FBQztZQUNKLE1BQU0sRUFBRSxNQUFNO1lBQ2QsVUFBVSxFQUFFLFVBQVU7WUFDdEIsVUFBVSxFQUFFLFVBQVU7U0FDekIsQ0FBQyxDQUFDO1FBRUgsT0FBTyxNQUFNLENBQUM7SUFDbEIsQ0FBQzs7OztZQW5ISixVQUFVLFNBQUM7Z0JBQ1IsVUFBVSxFQUFFLE1BQU07YUFDckIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1xuICAgIEZpZWxkTGF5b3V0LFxuICAgIE9iamVjdHNEYXRhUm93LFxuICAgIFVJQ29udHJvbCxcbiAgICBVSUNvbnRyb2xGaWVsZCxcbiAgICBPYmplY3RzRGF0YVJvd0NlbGwsXG4gICAgRklFTERfVFlQRSxcbiAgICBYX0FMSUdOTUVOVF9UWVBFLFxufSBmcm9tICcuLi9tb2RlbC93YXBpLm1vZGVsJztcbmltcG9ydCB7IFBlcEd1aWQgfSBmcm9tICcuLi9tb2RlbC91dGlsaXRpZXMubW9kZWwnO1xuXG5leHBvcnQgY2xhc3MgUGVwRmllbGREYXRhIHtcbiAgICBBcGlOYW1lOiBzdHJpbmc7XG4gICAgRW5hYmxlZD86IGJvb2xlYW47XG4gICAgVmFsdWU6IHN0cmluZztcbiAgICBGb3JtYXR0ZWRWYWx1ZT86IHN0cmluZztcbiAgICBGaWVsZFR5cGU6IEZJRUxEX1RZUEU7XG4gICAgUmVhZE9ubHk/OiBib29sZWFuO1xuICAgIENvbHVtbldpZHRoOiBudW1iZXI7XG4gICAgQ29sdW1uV2lkdGhUeXBlPzogbnVtYmVyO1xuICAgIFhBbGlnbm1lbnQ6IFhfQUxJR05NRU5UX1RZUEU7XG4gICAgVGl0bGU6IHN0cmluZztcbiAgICBBZGRpdGlvbmFsVmFsdWU/OiBzdHJpbmc7XG4gICAgT3B0aW9uYWxWYWx1ZXM/OiBhbnk7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgICAgQXBpTmFtZT86IHN0cmluZztcbiAgICAgICAgICAgIEVuYWJsZWQ/OiBib29sZWFuO1xuICAgICAgICAgICAgVmFsdWU/OiBzdHJpbmc7XG4gICAgICAgICAgICBGb3JtYXR0ZWRWYWx1ZT86IHN0cmluZztcbiAgICAgICAgICAgIEZpZWxkVHlwZT86IEZJRUxEX1RZUEU7XG4gICAgICAgICAgICBSZWFkT25seT86IGJvb2xlYW47XG4gICAgICAgICAgICBDb2x1bW5XaWR0aD86IG51bWJlcjtcbiAgICAgICAgICAgIENvbHVtbldpZHRoVHlwZT86IG51bWJlcjtcbiAgICAgICAgICAgIFhBbGlnbm1lbnQ/OiBYX0FMSUdOTUVOVF9UWVBFO1xuICAgICAgICAgICAgVGl0bGU/OiBzdHJpbmc7XG4gICAgICAgIH0gPSB7fVxuICAgICkge1xuICAgICAgICB0aGlzLkFwaU5hbWUgPSBvcHRpb25zLkFwaU5hbWU7XG4gICAgICAgIHRoaXMuRW5hYmxlZCA9ICEhb3B0aW9ucy5FbmFibGVkO1xuICAgICAgICB0aGlzLlZhbHVlID0gb3B0aW9ucy5WYWx1ZTtcbiAgICAgICAgdGhpcy5Gb3JtYXR0ZWRWYWx1ZSA9IG9wdGlvbnMuRm9ybWF0dGVkVmFsdWUgfHwgJyc7XG4gICAgICAgIHRoaXMuRmllbGRUeXBlID0gb3B0aW9ucy5GaWVsZFR5cGU7XG4gICAgICAgIHRoaXMuUmVhZE9ubHkgPSAhIW9wdGlvbnMuUmVhZE9ubHk7XG4gICAgICAgIHRoaXMuQ29sdW1uV2lkdGggPSBvcHRpb25zLkNvbHVtbldpZHRoO1xuICAgICAgICB0aGlzLkNvbHVtbldpZHRoVHlwZSA9IG9wdGlvbnMuQ29sdW1uV2lkdGhUeXBlO1xuICAgICAgICB0aGlzLlhBbGlnbm1lbnQgPSBvcHRpb25zLlhBbGlnbm1lbnQgfHwgWF9BTElHTk1FTlRfVFlQRS5MZWZ0O1xuICAgICAgICB0aGlzLlRpdGxlID0gb3B0aW9ucy5UaXRsZSB8fCAnJztcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgUGVwUm93RGF0YSB7XG4gICAgVVVJRD86IHN0cmluZztcbiAgICBGaWVsZHM6IFBlcEZpZWxkRGF0YVtdO1xufVxuXG5ASW5qZWN0YWJsZSh7XG4gICAgcHJvdmlkZWRJbjogJ3Jvb3QnLFxufSlcbmV4cG9ydCBjbGFzcyBQZXBEYXRhQ29udmVydG9yU2VydmljZSB7XG4gICAgZ2V0VWlDb250cm9sKGZvcm1EYXRhOiBQZXBSb3dEYXRhKTogVUlDb250cm9sIHtcbiAgICAgICAgY29uc3QgdWlDb250cm9sID0gbmV3IFVJQ29udHJvbCgpO1xuXG4gICAgICAgIGlmIChmb3JtRGF0YT8uRmllbGRzPy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCB1aVJvdyA9IGZvcm1EYXRhLkZpZWxkcztcbiAgICAgICAgICAgIHVpQ29udHJvbC5Db250cm9sRmllbGRzID0gW107XG4gICAgICAgICAgICB1aVJvdy5mb3JFYWNoKChmaWVsZCkgPT5cbiAgICAgICAgICAgICAgICB1aUNvbnRyb2wuQ29udHJvbEZpZWxkcy5wdXNoKHRoaXMuc2V0VUlDb250cm9sRmllbGQoZmllbGQpKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB1aUNvbnRyb2w7XG4gICAgfVxuXG4gICAgY29udmVydEZvcm1EYXRhKGZvcm1EYXRhOiBQZXBSb3dEYXRhKTogT2JqZWN0c0RhdGFSb3cge1xuICAgICAgICBjb25zdCByb3dEYXRhID0gbmV3IE9iamVjdHNEYXRhUm93KCk7XG4gICAgICAgIHJvd0RhdGEuRmllbGRzID0gW107XG4gICAgICAgIHJvd0RhdGEuVHlwZSA9IDA7XG4gICAgICAgIHJvd0RhdGEuVUlEID0gUGVwR3VpZC5uZXdHdWlkKCk7XG4gICAgICAgIGZvcm1EYXRhLkZpZWxkcy5mb3JFYWNoKChmaWVsZCkgPT5cbiAgICAgICAgICAgIHJvd0RhdGEuRmllbGRzLnB1c2godGhpcy5zZXREYXRhRmllbGQoZmllbGQpKVxuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiByb3dEYXRhO1xuICAgIH1cblxuICAgIGNvbnZlcnRMaXN0RGF0YShcbiAgICAgICAgdGFibGVEYXRhOiBQZXBSb3dEYXRhW10sXG4gICAgICAgIHJvd1VVSUQgPSAnJ1xuICAgICk6IEFycmF5PE9iamVjdHNEYXRhUm93PiB7XG4gICAgICAgIGNvbnN0IHJvd3MgPSBuZXcgQXJyYXk8T2JqZWN0c0RhdGFSb3c+KCk7XG5cbiAgICAgICAgaWYgKHRhYmxlRGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0YWJsZURhdGEuZm9yRWFjaCgocm93KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgcm93RGF0YSA9IG5ldyBPYmplY3RzRGF0YVJvdygpO1xuICAgICAgICAgICAgICAgIHJvd0RhdGEuRmllbGRzID0gW107XG4gICAgICAgICAgICAgICAgcm93RGF0YS5UeXBlID0gMDtcbiAgICAgICAgICAgICAgICByb3dEYXRhLlVJRCA9IHJvd1VVSURcbiAgICAgICAgICAgICAgICAgICAgPyByb3dVVUlEXG4gICAgICAgICAgICAgICAgICAgIDogcm93LlVVSURcbiAgICAgICAgICAgICAgICAgICAgPyByb3cuVVVJRFxuICAgICAgICAgICAgICAgICAgICA6IFBlcEd1aWQubmV3R3VpZCgpO1xuICAgICAgICAgICAgICAgIHJvdy5GaWVsZHMuZm9yRWFjaCgoZmllbGQpID0+XG4gICAgICAgICAgICAgICAgICAgIHJvd0RhdGEuRmllbGRzLnB1c2godGhpcy5zZXREYXRhRmllbGQoZmllbGQpKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgcm93cy5wdXNoKHJvd0RhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcm93cztcbiAgICB9XG5cbiAgICBzZXRVSUNvbnRyb2xGaWVsZChmaWVsZDogUGVwRmllbGREYXRhKTogVUlDb250cm9sRmllbGQge1xuICAgICAgICBjb25zdCBjb250cm9sRmllbGQgPSBuZXcgVUlDb250cm9sRmllbGQoKTtcbiAgICAgICAgY29udHJvbEZpZWxkLkFwaU5hbWUgPSBmaWVsZC5BcGlOYW1lO1xuICAgICAgICBjb250cm9sRmllbGQuRmllbGRUeXBlID0gZmllbGQuRmllbGRUeXBlO1xuXG4gICAgICAgIGNvbnRyb2xGaWVsZC5MYXlvdXQgPSBuZXcgRmllbGRMYXlvdXQoe1xuICAgICAgICAgICAgWDogMSxcbiAgICAgICAgICAgIFdpZHRoOiAxLFxuICAgICAgICAgICAgWEFsaWdubWVudDogZmllbGQuWEFsaWdubWVudCxcbiAgICAgICAgICAgIFk6IDEsXG4gICAgICAgICAgICBIZWlnaHQ6IDEsXG4gICAgICAgICAgICBZQWxpZ25tZW50OiAxLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb250cm9sRmllbGQuVGl0bGUgPSBmaWVsZC5UaXRsZTtcbiAgICAgICAgY29udHJvbEZpZWxkLlJlYWRPbmx5ID0gZmllbGQuUmVhZE9ubHkgPT09IHRydWUgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgIGNvbnRyb2xGaWVsZC5Db2x1bW5XaWR0aCA9IGZpZWxkLkNvbHVtbldpZHRoO1xuICAgICAgICBjb250cm9sRmllbGQuQ29sdW1uV2lkdGhUeXBlID0gZmllbGQuQ29sdW1uV2lkdGhUeXBlIHx8IDE7XG4gICAgICAgIHJldHVybiBjb250cm9sRmllbGQ7XG4gICAgfVxuXG4gICAgc2V0RGF0YUZpZWxkKGZpZWxkOiBQZXBGaWVsZERhdGEpOiBPYmplY3RzRGF0YVJvd0NlbGwge1xuICAgICAgICBjb25zdCBkYXRhRmllbGQgPSBuZXcgT2JqZWN0c0RhdGFSb3dDZWxsKCk7XG4gICAgICAgIGRhdGFGaWVsZC5BZGRpdGlvbmFsVmFsdWUgPSBmaWVsZC5BZGRpdGlvbmFsVmFsdWU7XG4gICAgICAgIGRhdGFGaWVsZC5BcGlOYW1lID0gZmllbGQuQXBpTmFtZTtcbiAgICAgICAgZGF0YUZpZWxkLkVuYWJsZWQgPSBmaWVsZC5FbmFibGVkID09PSBmYWxzZSA/IGZhbHNlIDogdHJ1ZTtcbiAgICAgICAgZGF0YUZpZWxkLkZpZWxkVHlwZSA9IGZpZWxkLkZpZWxkVHlwZTtcbiAgICAgICAgZGF0YUZpZWxkLkZvcm1hdHRlZFZhbHVlID1cbiAgICAgICAgICAgIGZpZWxkLkZvcm1hdHRlZFZhbHVlIHx8IGZpZWxkLlZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgIGRhdGFGaWVsZC5Hcm91cEZpZWxkcyA9IG51bGw7XG4gICAgICAgIGRhdGFGaWVsZC5Ob3RpZmljYXRpb25JbmZvID0gJyc7XG4gICAgICAgIGRhdGFGaWVsZC5PcHRpb25hbFZhbHVlcyA9IGZpZWxkLk9wdGlvbmFsVmFsdWVzO1xuICAgICAgICBkYXRhRmllbGQuUmVmZXJlbmNlT2JqZWN0U3ViVHlwZSA9ICcnO1xuICAgICAgICBkYXRhRmllbGQuVGV4dENvbG9yID0gJyc7XG4gICAgICAgIGRhdGFGaWVsZC5WYWx1ZSA9IGZpZWxkLlZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgIGRhdGFGaWVsZC5WaXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIGRhdGFGaWVsZDtcbiAgICB9XG5cbiAgICBzZXRGaWVsZExheW91dChcbiAgICAgICAgeDogbnVtYmVyLFxuICAgICAgICB3aWR0aDogbnVtYmVyLFxuICAgICAgICB4QWxpZ25tZW50OiBudW1iZXIsXG4gICAgICAgIHk6IG51bWJlcixcbiAgICAgICAgaGVpZ2h0OiBudW1iZXIsXG4gICAgICAgIHlBbGlnbm1lbnQ6IG51bWJlcixcbiAgICAgICAgbGluZU51bWJlcjogbnVtYmVyXG4gICAgKTogRmllbGRMYXlvdXQge1xuICAgICAgICBjb25zdCBsYXlvdXQgPSBuZXcgRmllbGRMYXlvdXQoe1xuICAgICAgICAgICAgWDogeCxcbiAgICAgICAgICAgIFdpZHRoOiB3aWR0aCxcbiAgICAgICAgICAgIFhBbGlnbm1lbnQ6IHhBbGlnbm1lbnQsXG4gICAgICAgICAgICBZOiB5LFxuICAgICAgICAgICAgSGVpZ2h0OiBoZWlnaHQsXG4gICAgICAgICAgICBZQWxpZ25tZW50OiB5QWxpZ25tZW50LFxuICAgICAgICAgICAgTGluZU51bWJlcjogbGluZU51bWJlcixcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGxheW91dDtcbiAgICB9XG59XG4iXX0=