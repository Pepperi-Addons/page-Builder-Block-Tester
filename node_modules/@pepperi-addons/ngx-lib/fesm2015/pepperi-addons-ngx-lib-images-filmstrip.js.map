{"version":3,"file":"pepperi-addons-ngx-lib-images-filmstrip.js","sources":["../../../projects/ngx-lib/images-filmstrip/images-filmstrip.component.ts","../../../projects/ngx-lib/images-filmstrip/images-filmstrip.module.ts","../../../projects/ngx-lib/images-filmstrip/public-api.ts","../../../projects/ngx-lib/images-filmstrip/pepperi-addons-ngx-lib-images-filmstrip.ts"],"sourcesContent":["import {\n    Component,\n    ViewChild,\n    OnInit,\n    OnDestroy,\n    AfterViewInit,\n    ElementRef,\n    Input,\n    TemplateRef,\n    Renderer2,\n    ChangeDetectorRef,\n    Inject,\n    Optional,\n    ViewContainerRef,\n    OnChanges,\n} from '@angular/core';\nimport {\n    trigger,\n    state,\n    style,\n    transition,\n    animate,\n} from '@angular/animations';\nimport { FormGroup } from '@angular/forms';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { TranslateService } from '@ngx-translate/core';\nimport {\n    Gallery,\n    GalleryConfig,\n    LoadingStrategy,\n    SlidingDirection,\n    ThumbnailsPosition,\n    GalleryItem,\n    ImageItem,\n    GalleryRef,\n} from 'ng-gallery';\nimport {\n    PepCustomizationService,\n    PepLayoutType,\n    PepLayoutService,\n    PepFileService,\n    PepHorizontalAlignment,\n    DEFAULT_HORIZONTAL_ALIGNMENT,\n    PepImagesField,\n} from '@pepperi-addons/ngx-lib';\nimport { PepDialogService } from '@pepperi-addons/ngx-lib/dialog';\nimport { pepIconArrowRightAlt } from '@pepperi-addons/ngx-lib/icon';\nimport { pepIconNoImage2 } from '@pepperi-addons/ngx-lib/icon';\n\nimport 'hammerjs';\n\ninterface IPepImagesFilmstripDialogData {\n    currIndex: number;\n    key: string;\n    value: string;\n    label: string;\n    uid: string;\n    showThumbnails: boolean;\n}\n\n// export const slideInAnimation = trigger('slideAnimation', [\n//     state('in', style({ transform: 'translateY(0)', opacity: 1 })),\n//     transition(':enter', [\n//         style({ transform: 'translateY(-100%)', opacity: 0 }),\n//         animate(400)\n//     ]),\n//     transition(':leave', [\n//         animate(400, style({ transform: 'translateY(-100%)', opacity: 0 }))\n//     ])\n// ]);\n\nimport {\n    IMAGEVIEWER_CONFIG,\n    ImageViewerConfig,\n    createButtonConfig,\n} from '@hallysonh/ngx-imageviewer';\n\nexport function createViewerConfig(\n    translate: TranslateService\n): ImageViewerConfig {\n    return {\n        // width: 850,\n        // height: 150,\n        bgStyle: '#FFF', // component background style\n        // scaleStep: 0.1, // zoom scale step (using the zoom in/out buttons)\n        // rotateStepper: false, // touch rotate should rotate only 90 to 90 degrees\n        loadingMessage: translate.instant('MESSAGES.INFO_LOADING_FILE'), // 'Loading...',\n        // buttonStyle: {\n        //     iconFontFamily: 'Material Icons', // font used to render the button icons\n        //     alpha: 0.5, // buttons' transparence value\n        //     hoverAlpha: 0.7, // buttons' transparence value when mouse is over\n        //     bgStyle: '#000000', //  buttons' background style\n        //     iconStyle: '#ffffff', // buttons' icon colors\n        //     borderStyle: '#000000', // buttons' border style\n        //     borderWidth: 0, // buttons' border width (0 == disabled)\n        // },\n        // tooltips: {\n        //     enabled: true, // enable or disable tooltips for buttons\n        //     bgStyle: '#000000', // tooltip background style\n        //     bgAlpha: 0.5, // tooltip background transparence\n        //     textStyle: '#ffffff', // tooltip's text style\n        //     textAlpha: 0.9, // tooltip's text transparence\n        //     padding: 15, // tooltip padding\n        //     radius: 20, // tooltip border radius\n        // },\n        // shorter button configuration style\n        nextPageButton: createButtonConfig(\n            'navigate_next',\n            'Next page',\n            0,\n            false\n        ),\n        beforePageButton: createButtonConfig(\n            'navigate_before',\n            'Previous page',\n            1,\n            false\n        ),\n        zoomOutButton: createButtonConfig('zoom_out', 'Zoom out', 0, false),\n        zoomInButton: createButtonConfig('zoom_in', 'Zoom in', 1, false),\n        rotateLeftButton: createButtonConfig(\n            'rotate_left',\n            'Rotate left',\n            2,\n            false\n        ),\n        rotateRightButton: createButtonConfig(\n            'rotate_right',\n            'Rotate right',\n            3,\n            false\n        ),\n        resetButton: createButtonConfig('autorenew', 'Reset', 4, false),\n    };\n}\n\n@Component({\n    selector: 'pep-images-filmstrip',\n    templateUrl: './images-filmstrip.component.html',\n    styleUrls: ['./images-filmstrip.component.scss'],\n    // animations: [slideInAnimation],\n    providers: [\n        {\n            provide: IMAGEVIEWER_CONFIG,\n            // useValue: IMAGEVIEWER_CONFIG_DEFAULT,\n            useFactory: createViewerConfig,\n            deps: [TranslateService],\n        },\n    ],\n})\nexport class PepImagesFilmstripComponent\n    implements OnInit, OnChanges, AfterViewInit, OnDestroy {\n    // @ViewChild('ngxViewerImage') ngxViewerImage: any; // TODO: Check if we need to use this??\n    @Input() key = '';\n    @Input() value = '';\n    @Input() label = '';\n    @Input() xAlignment: PepHorizontalAlignment = DEFAULT_HORIZONTAL_ALIGNMENT;\n\n    private _rowSpan = 1;\n    @Input()\n    set rowSpan(value) {\n        this._rowSpan = value;\n        this.setFieldHeight();\n    }\n    get rowSpan(): number {\n        return this._rowSpan;\n    }\n\n    controlType = 'images';\n\n    @Input() form: FormGroup = null;\n    @Input() uid = '0';\n    @Input() showTitle = false;\n\n    private _layoutType: PepLayoutType = 'form';\n    @Input()\n    set layoutType(value: PepLayoutType) {\n        this._layoutType = value;\n        this.setFieldHeight();\n    }\n    get layoutType(): PepLayoutType {\n        return this._layoutType;\n    }\n\n    @Input() currIndex = 0;\n    @Input() showThumbnails = false;\n\n    @ViewChild('galleryCont') galleryCont: ElementRef;\n    @ViewChild('galleryDialogTemplate', { read: TemplateRef })\n    galleryDialogTemplate: TemplateRef<any>;\n    @ViewChild('galleryDialogCont') galleryDialogCont: ElementRef;\n\n    config: GalleryConfig;\n    items: GalleryItem[] = null;\n    inDialog = false;\n\n    mandatory = false;\n    readonly = false;\n    disabled = false;\n    fieldHeight = '';\n    standAlone = false;\n\n    galleryWidth = 0;\n    galleryHeight;\n    isVertical = false;\n    galleryRef: GalleryRef;\n    dialogGalleryRef: GalleryRef;\n\n    constructor(\n        private customizationService: PepCustomizationService,\n        private dialogService: PepDialogService,\n        private layoutService: PepLayoutService,\n        private fileService: PepFileService,\n        private gallery: Gallery,\n        private renderer: Renderer2,\n        private element: ElementRef,\n        private cd: ChangeDetectorRef,\n        @Optional()\n        private dialogRef: MatDialogRef<PepImagesFilmstripComponent>,\n        @Optional()\n        @Inject(MAT_DIALOG_DATA)\n        private data: IPepImagesFilmstripDialogData\n    ) {\n        // If data exist copy all data properties into this.\n        if (dialogRef && data) {\n            this.inDialog = true;\n\n            Object.keys(data).forEach((key) => {\n                if (key in this) {\n                    this[key] = data[key];\n                }\n            });\n        }\n\n        this.config = {\n            // nav: false, // Show navigation buttons\n            navIcon: pepIconArrowRightAlt.data,\n            // loop: true,\n            // zoomOut: 0,\n            // dots: false,\n            // dotsPosition: 'bottom',\n            // counterPosition: 'top',\n            // thumb: true,\n            counter: false, // Show counter\n            gestures: true, // Use touch events (requires hammer.js)\n            // autoPlay: false,\n            // thumbWidth: 120,\n            // thumbHeight: 90,\n            imageSize: 'contain',\n            // panSensitivity: 25,\n            // disableThumb: false,\n            // playerInterval: 3000,\n            // thumbMode: ThumbnailsMode.Free,\n            // thumbPosition: ThumbnailsPosition.Bottom,\n            loadingStrategy: LoadingStrategy.Default,\n            // slidingDirection: SlidingDirection.Horizontal,\n        };\n    }\n\n    private setFieldHeight(): void {\n        this.fieldHeight = this.customizationService.calculateFieldHeight(\n            this.layoutType,\n            this.rowSpan,\n            this.standAlone\n        );\n    }\n\n    private setDefaultForm(): void {\n        const pepField = new PepImagesField({\n            key: this.key,\n            value: this.value,\n            mandatory: this.mandatory,\n            readonly: this.readonly,\n            disabled: this.disabled,\n        });\n        this.form = this.customizationService.getDefaultFromGroup(pepField);\n    }\n\n    ngOnInit(): void {\n        if (!this.inDialog) {\n            if (this.form === null) {\n                this.standAlone = true;\n                this.setFieldHeight();\n                this.setDefaultForm();\n\n                this.renderer.addClass(\n                    this.element.nativeElement,\n                    PepCustomizationService.STAND_ALONE_FIELD_CLASS_NAME\n                );\n            }\n        }\n\n        if (this.items === null) {\n            const imgArr = this.value ? this.value.split(';') : [];\n            // add No image image when there is no images\n            if (imgArr.length === 0) {\n                const noImageSrc = this.fileService.getSvgAsImageSrc(\n                    pepIconNoImage2.data\n                );\n                imgArr.push(noImageSrc);\n            }\n\n            this.items = imgArr.map(\n                (img) => new ImageItem({ src: img, thumb: img })\n            );\n        }\n\n        this.config.dots = this.config.nav = this.items.length > 1;\n        this.config.thumb =\n            (this.key === 'ItemFilmstripImages' || this.showThumbnails) &&\n            this.items.length > 1\n                ? true\n                : false;\n        this.currIndex =\n            this.key === 'ItemFilmstripImages' &&\n            this.currIndex === 0 &&\n            this.items.length > 1\n                ? Math.floor(this.items.length / 2) - 1\n                : this.currIndex;\n    }\n\n    ngAfterViewInit(): void {\n        if (this.inDialog) {\n            this.afterDialogOpened();\n        } else {\n            this.galleryRef = this.gallery.ref(\n                `${this.key}-${this.uid}-gallery`\n            );\n            this.initGalleryStyle(this.galleryCont, this.galleryRef);\n        }\n    }\n\n    ngOnChanges(): void {\n        if (this.standAlone) {\n            this.setDefaultForm();\n        }\n    }\n\n    ngOnDestroy(): void {\n        if (this.galleryRef) {\n            this.galleryRef.destroy();\n        }\n        if (this.dialogGalleryRef) {\n            this.dialogGalleryRef.destroy();\n        }\n        // if (this.myPinch) { this.myPinch.destroy(); }\n    }\n\n    initGalleryStyle(galleryContainer, galleryRef): void {\n        setTimeout(() => {\n            // Set thumbnails position and sliding direction\n            this.setThumbnailDimension(galleryContainer);\n            galleryRef.setConfig(this.config);\n        }, 0);\n\n        const currentIndex = this.currIndex;\n        if (currentIndex > 0) {\n            setTimeout(() => {\n                galleryRef.load(this.items);\n                galleryRef.set(currentIndex);\n            }, 0);\n            // galleryRef.set(currentIndex);\n        } else {\n            galleryRef.load(this.items);\n        }\n    }\n\n    onError(e): void {\n        const noImageSrc = this.fileService.getSvgAsImageSrc(\n            pepIconNoImage2.data\n        );\n        const noimg = new ImageItem({ src: noImageSrc, thumb: noImageSrc });\n        this.items.splice(e.itemIndex, 1, noimg);\n    }\n\n    enlargeImage(event: any): void {\n        const config = this.dialogService.getDialogConfig({}, 'inline');\n        config.maxWidth = '75vw';\n        config.height = '95vh';\n\n        const dialogRef = this.dialogService.openDialog(\n            this.galleryDialogTemplate,\n            {\n                currIndex: this.currIndex,\n            },\n            config\n        );\n\n        dialogRef.afterOpened().subscribe(() => {\n            this.afterDialogOpened();\n        });\n\n        // Update currentIndex in galleryRef\n        // dialogRef.afterClosed().subscribe(value => {\n        //     this.galleryRef.set(this.currIndex);\n        // });\n    }\n\n    afterDialogOpened(): void {\n        this.dialogGalleryRef = this.gallery.ref(\n            `${this.key}-${this.uid}-dlgGallery`\n        );\n        this.initGalleryStyle(this.galleryDialogCont, this.dialogGalleryRef);\n    }\n\n    setThumbnailDimension(galleryContainer): void {\n        this.galleryWidth = galleryContainer.nativeElement.clientWidth;\n        // this.galleryHeight = galleryContainer.nativeElement.clientHeight - 32; // TODO - TALK WITH TOMER\n        this.galleryHeight = this.inDialog\n            ? galleryContainer.nativeElement.clientHeight - 32\n            : galleryContainer.nativeElement.clientHeight;\n        // this.galleryHeight = galleryContainer.nativeElement.clientHeight - 32;\n        this.cd.detectChanges();\n\n        this.isVertical = this.galleryWidth < this.galleryHeight;\n        this.cd.detectChanges();\n        if (this.isVertical) {\n            let width =\n                (this.galleryWidth - (this.items.length - 1) * 16) /\n                this.items.length;\n            width = Math.min(Math.max(width, 24), 96);\n\n            this.config.thumbHeight = width;\n            this.config.thumbWidth = width + 16;\n        } else {\n            let height =\n                (this.galleryHeight - (this.items.length - 1) * 16) /\n                this.items.length;\n            height = Math.min(Math.max(height, 24), 96);\n\n            this.config.thumbHeight = height + 16;\n            this.config.thumbWidth = height;\n        }\n\n        this.config.thumbPosition = this.isVertical\n            ? ThumbnailsPosition.Bottom\n            : this.layoutService.isRtl()\n            ? ThumbnailsPosition.Right\n            : ThumbnailsPosition.Left;\n        this.config.slidingDirection =\n            this.key !== 'ItemFilmstripImages'\n                ? SlidingDirection.Horizontal\n                : this.isVertical\n                ? SlidingDirection.Horizontal\n                : SlidingDirection.Vertical;\n\n        this.config.imageSize = 'contain';\n    }\n\n    indexChange(item: any): void {\n        this.currIndex = item.currIndex;\n        // if (this.ngxViewerImage && this.ngxViewerImage.scale) {\n        //     this.ngxViewerImage.scale = 1;\n        //     this.updateStyle();\n        // }\n    }\n\n    // scrollFunction(e: any): boolean {\n    //     e.deltaY > 0 ? this.zoomOut() : this.zoomIn();\n    //     return false;\n    // }\n\n    // zoomIn(): void {\n    //     if (this.ngxViewerImage.scale < 2) {\n    //         this.ngxViewerImage.scale *= (1 + this.ngxViewerImage.config.zoomFactor);\n    //     } else {\n    //         this.ngxViewerImage.scale = 2;\n    //     }\n    //     this.updateStyle();\n    // }\n\n    // zoomOut(): void {\n    //     if (this.ngxViewerImage.scale > this.ngxViewerImage.config.zoomFactor) {\n    //         this.ngxViewerImage.scale /= (1 + this.ngxViewerImage.config.zoomFactor);\n    //     }\n    //     this.updateStyle();\n    // }\n\n    // private updateStyle(): void {\n    //     this.ngxViewerImage.style.transform = `translate(${this.ngxViewerImage.translateX}px,\n    //         ${this.ngxViewerImage.translateY}px) rotate(${this.ngxViewerImage.rotation}deg) scale(${this.ngxViewerImage.scale})`;\n\n    //     this.cd.detectChanges();\n    // }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ReactiveFormsModule } from '@angular/forms';\n\nimport { MatCommonModule } from '@angular/material/core';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatIconModule } from '@angular/material/icon';\n\nimport { PepNgxLibModule } from '@pepperi-addons/ngx-lib';\nimport { PepFieldTitleModule } from '@pepperi-addons/ngx-lib/field-title';\nimport {\n    PepIconModule,\n    PepIconRegistry,\n    pepIconSystemEdit,\n    pepIconSystemClose,\n    pepIconArrowRightAlt,\n    pepIconArrowLeftAlt,\n} from '@pepperi-addons/ngx-lib/icon';\nimport { PepDialogModule } from '@pepperi-addons/ngx-lib/dialog';\n\nimport { GalleryModule } from 'ng-gallery';\nimport { ImageViewerModule } from '@hallysonh/ngx-imageviewer';\n\nimport { PepImagesFilmstripComponent } from './images-filmstrip.component';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        ReactiveFormsModule,\n        // Material modules,\n        MatCommonModule,\n        MatFormFieldModule,\n        MatDialogModule,\n        MatIconModule,\n        // External modules\n        GalleryModule,\n        ImageViewerModule,\n        // ImageViewerModule.forRoot({\n        //     btnClass: 'default', // The CSS class(es) that will apply to the buttons\n        //     zoomFactor: 0.1, // The amount that the scale will be increased by\n        //     containerBackgroundColor: 'transparent', // The color to use for the background. This can provided in hex, or rgb(a).\n        //     wheelZoom: true, // If true, the mouse wheel can be used to zoom in\n        //     allowFullscreen: false, // If true, the fullscreen button will be shown, allowing the user to entr fullscreen mode\n        //     btnIcons: {\n        //         // The icon classes that will apply to the buttons. By default, font-awesome is used.\n        //         zoomIn: 'fa fa-plus',\n        //         zoomOut: 'fa fa-minus',\n        //         rotateClockwise: 'fa fa-repeat',\n        //         rotateCounterClockwise: 'fa fa-undo',\n        //         next: 'fa fa-arrow-right',\n        //         prev: 'fa fa-arrow-left',\n        //         fullscreen: 'fa fa-arrows-alt'\n        //     }\n        // }),\n        // ngx-lib modules\n        PepNgxLibModule,\n        PepIconModule,\n        PepFieldTitleModule,\n        PepDialogModule,\n    ],\n    exports: [PepImagesFilmstripComponent],\n    declarations: [PepImagesFilmstripComponent],\n})\nexport class PepImagesFilmstripModule {\n    constructor(private pepIconRegistry: PepIconRegistry) {\n        this.pepIconRegistry.registerIcons([\n            pepIconSystemEdit,\n            pepIconSystemClose,\n            pepIconArrowRightAlt,\n            pepIconArrowLeftAlt,\n        ]);\n    }\n}\n","/*\n * Public API Surface of ngx-lib/images-filmstrip\n */\nexport * from './images-filmstrip.module';\nexport * from './images-filmstrip.component';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}